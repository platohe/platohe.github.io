(this.webpackJsonpawesomeidea=this.webpackJsonpawesomeidea||[]).push([[0],{274:function(e,t,n){},490:function(e,t,n){},52:function(e,t,n){},528:function(e,t){},530:function(e,t){},542:function(e,t){},544:function(e,t){},571:function(e,t){},573:function(e,t){},574:function(e,t){},579:function(e,t){},581:function(e,t){},587:function(e,t){},589:function(e,t){},608:function(e,t){},620:function(e,t){},623:function(e,t){},768:function(e,t,n){},782:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),i=n.n(r),o=n(22),c=n.n(o),s=n(394);n(489),n(490),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(11),l=n(12),d=n(17),h=n(15),p=n(14),f=(n(274),n(56)),v=n(7),g=n.n(v),m=n(97),b=n(13),j=n(49);function k(e,t){var n=new Date;console.log("".concat(e,"-").concat(n.getHours(),":").concat(n.getMinutes(),":").concat(n.getSeconds(),":").concat(n.getMilliseconds()," ").concat(t))}function y(e,t){void 0===t||t&&k("dbg",e)}function O(e){0}function x(e){k("info",e)}var w,C=n(398),E="idealab",S="keyval";function I(){return T.apply(this,arguments)}function T(){return(T=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=2;break}return e.abrupt("return",Promise.resolve(w));case 2:return y("db: opening db"),e.abrupt("return",Object(C.a)(E,1,{upgrade:function(e){e.createObjectStore(S)}}).then((function(e){return w=e})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return D.apply(this,arguments)}function D(){return(D=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I().then((function(e){return y("db: loaded ".concat(t)),e.get(S,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return P.apply(this,arguments)}function P(){return(P=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I().then((function(e){return y("db: saved ".concat(t)),e.put(S,n,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return R.apply(this,arguments)}function R(){return(R=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I().then((function(e){return y("db: deleted ".concat(t)),e.delete(S,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return L.apply(this,arguments)}function L(){return(L=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I().then((function(e){return y("db: get all keys"),e.getAllKeys(S)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=function(){return"extension"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_EMAILJS_ACCESS_TOKEN:"767696e1c9e5f17c6176f5afd97619cb",REACT_APP_EMAILJS_SERVICE_ID:"awesome",REACT_APP_EMAILJS_TEMPLATE_ID:"template_zwftzps",REACT_APP_EMAILJS_USER_ID:"user_uplKuSONfJpHb5r2AnXOw",REACT_APP_GITHUB_TOKEN:"5a193fbedb7d6e13708346235f8ba5a0ca496319",REACT_APP_GOOGLE_API_KEY:"AIzaSyC3CQs9LPdJN7GX4RRZ9toHytgMtRBfDdI",REACT_APP_GOOGLE_CLIENT_ID:"586821861057-7b66mi1pr3cr7rf14c4livnvhbsnu2b9.apps.googleusercontent.com",REACT_APP_GOOGLE_CLIENT_SECRET:"_o26TCpjPOCBFXWd4FBj2EWL",REACT_APP_SENDGRID_API_KEY:"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",REACT_APP_SENDGRID_FROM:"plato.he.2000@gmail.com"}).REACT_APP_BUILD_TARGET},U="indexedDB";function G(e,t){var n,a=[],r=Object(j.a)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;t&&!i.startsWith(t)||a.push(i)}}catch(o){r.e(o)}finally{r.f()}return a}function B(e,t){return e in window?G(Object.keys(window[e]),t):[]}function K(e,t,n){if(t&&e in window){var a=window[e].getItem(t);if(a)return y("storage: loaded ".concat(t)),JSON.parse(a)}return n}function H(e,t,n){t&&n?e in window&&(y("storage: saved ".concat(t)),window[e].setItem(t,JSON.stringify(n))):y("storage:setItem: invalid key or value")}function q(e,t){t?e in window&&(y("storage: removed ".concat(t)),window[e].removeItem(t)):y("storage:removeItem: invalid key")}function z(e){if("indexedDB"===e){if("file:"===window.location.protocol)return"localStorage";if(!(e in window))return"localStorage"}return e}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;return M()?new Promise((function(n){window.chrome.storage.local.get([e],(function(a){var r=a[e];r&&(y('storage: retrieved "'.concat(e,'" from extension')),n(JSON.parse(r))),n(t)}))})):"indexedDB"===(n=z(n))?A(e).then((function(e){return e?JSON.parse(e):t})):Promise.resolve(K(n,e,t))}function J(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;if(M())return new Promise((function(n){window.chrome.storage.local.set(Object(m.a)({},e,JSON.stringify(t)),(function(){y('storage: saved "'.concat(e,'" to extension'))}))}));"indexedDB"===(n=z(n))?_(e,JSON.stringify(t)):H(n,e,t)}function V(e){if(!e)throw new Error("Precondition failed")}var Y="pref#",Q={APP_BUILD:"1.0.220124",EXECUTE_STRATEGY:"web",LAYOUT_STRATEGY:"responsive",WORKSPACE_STRATEGY:"memo,bookmark,vault",ENABLE_SYNC:!1,ENABLE_TAG_GRAPH:!1,ENABLE_WORKSPACE_MENUITEMS:!1,ENABLE_MULTIPLE_EXPAND_COLLAPSE:!1,LANGUAGE:"en",OS_TYPE:0,DEVICE_TYPE:1,GA_TRACKING_CODE:X("REACT_APP_GA_TRACKING_CODE"),EMAILJS_USER_ID:X("REACT_APP_EMAILJS_USER_ID"),EMAILJS_ACCESS_TOKEN:X("REACT_APP_EMAILJS_ACCESS_TOKEN"),EMAILJS_SERVICE_ID:X("REACT_APP_EMAILJS_SERVICE_ID"),EMAILJS_TEMPLATE_ID:X("REACT_APP_EMAILJS_TEMPLATE_ID"),SENDGRID_FROM:X("REACT_APP_SENDGRID_FROM"),SENDGRID_API_KEY:X("REACT_APP_SENDGRID_API_KEY"),GOOGLE_API_KEY:X("REACT_APP_GOOGLE_API_KEY"),GOOGLE_CLIENT_ID:X("REACT_APP_GOOGLE_CLIENT_ID"),GOOGLE_CLIENT_SECRET:X("REACT_APP_GOOGLE_CLIENT_SECRET")};function X(e){return Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_EMAILJS_ACCESS_TOKEN:"767696e1c9e5f17c6176f5afd97619cb",REACT_APP_EMAILJS_SERVICE_ID:"awesome",REACT_APP_EMAILJS_TEMPLATE_ID:"template_zwftzps",REACT_APP_EMAILJS_USER_ID:"user_uplKuSONfJpHb5r2AnXOw",REACT_APP_GITHUB_TOKEN:"5a193fbedb7d6e13708346235f8ba5a0ca496319",REACT_APP_GOOGLE_API_KEY:"AIzaSyC3CQs9LPdJN7GX4RRZ9toHytgMtRBfDdI",REACT_APP_GOOGLE_CLIENT_ID:"586821861057-7b66mi1pr3cr7rf14c4livnvhbsnu2b9.apps.googleusercontent.com",REACT_APP_GOOGLE_CLIENT_SECRET:"_o26TCpjPOCBFXWd4FBj2EWL",REACT_APP_SENDGRID_API_KEY:"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",REACT_APP_SENDGRID_FROM:"plato.he.2000@gmail.com"})[e]}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Array.isArray(e))e.forEach((function(e){return Z(e)}));else for(var t=Object.keys(Q),n=0,a=Object.entries(e);n<a.length;n++){var r=Object(f.a)(a[n],2),i=r[0],o=r[1];t.includes(i)&&(Q[i]=o)}}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";V(e);var n=Q[e];return void 0!==n?n:t}function ee(e,t){V(e),V(t),Q[e]=t,J("".concat(Y).concat(e),t)}function te(){return 3===Q.OS_TYPE}!function(){("browser-extension"===Q.EXECUTE_STRATEGY||M())&&(Q.EXECUTE_STRATEGY="browser-extension",Q.LAYOUT_STRATEGY="mini",Q.WORKSPACE_STRATEGY="bookmark"),Z(window._env_);var e=[];(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"indexedDB";return"indexedDB"===(t=z(t))?N().then((function(t){return G(t,e)})):Promise.resolve(B(t,e))})(Y).then((function(t){return e=t,Promise.all(e.map((function(e){return F(e)})))})).then((function(t){for(var n=0;n<e.length;n++){var a=e[n].substr(Y.length);Q[a]=t[n]}}))}();var ne=Q,ae=n(10),re=n(397);function ie(e){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www\.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w\-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[.!/\\\w]*))?)/.test(e)}var oe=[];function ce(e,t){V(e),V(t),y("observer: added ".concat(e)),oe.unshift({name:e,notify:t})}function se(e){V(e);var t=oe.findIndex((function(t){return t.name===e}));t>-1&&(y("observer: removed ".concat(e)),oe.splice(t,1))}function ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;setTimeout((function(){for(var n=0;n<oe.length&&!oe[n].notify(e,t);n++);}),n)}function le(e){V(e),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())?window.open("mailto://".concat(e),"_blank"):/^[(]{0,1}[0-9]{3}[)]{0,1}[-\s\.]{0,1}[0-9]{3}[-\s\.]{0,1}[0-9]{4}$/.test(e)?window.open("tel:".concat(e),"_blank"):window.open(e,"_blank")}function de(e){var t=e.url;return t?fetch(t,{method:e.method||"GET",headers:e.headers,body:e.body}).then((function(e){return e.blob()})).then((function(e){return function(e){return new Promise((function(t){var n=new FileReader;n.addEventListener("load",(function(){return t(n.result)}),!1),n.readAsDataURL(e)}))}(e)})).then((function(t){return Promise.resolve({req:e,resp:t})})).catch((function(t){return Promise.reject({req:e,resp:"",error:{message:t.message,stack:t.stack}})})):Promise.reject({req:e,resp:"",error:{message:"invalid request"}})}function he(e,t){if(window.Android||window.webkit){var n,a;if(null===(n=window.Android)||void 0===n?void 0:n.eventHandler){var r=JSON.stringify(t?Object(ae.a)({evt:e},t):{evt:e});return void window.Android.eventHandler(r)}if(null===(a=window.webkit)||void 0===a?void 0:a.messageHandlers){var i=JSON.stringify(t?Object(ae.a)({evt:e},t):{evt:e});return void window.webkit.messageHandlers.eventHandler.postMessage(i)}}!function(e,t){switch("notify@log"!==e&&y("service: ".concat(e)),e){case"notify@log":console.log(t.msg||"");break;case"req@toast":re.a.open({message:t.title||"",description:t.msg||""});break;case"req@send-email":le(t.email||t.link);break;case"req@open-url":le(t.url||t.link);break;case"req@get-pref":F("pref#".concat(t.name)).then((function(e){ue("resp@get-pref",{result:e})}));break;case"req@save-pref":J("pref#".concat(t.name),t.value);break;case"req@fetch-url":de(t).then((function(e){return ue("resp@fetch-url",e)})).catch((function(e){return ue("resp@fetch-url",e)}));break;case"req@kill-app":case"req@make-call":default:y("service: ".concat(e," not supported"))}}(e,t)}window._runtime_={eventHandler:function(e){if(e){var t={};try{if(!(t=JSON.parse(e)).evt)return void y("service: discarded a suspicious event ".concat(e))}catch(n){return void y("service: discarded an invalid event ".concat(e,", ").concat(n))}y("service: ".concat(t.evt)),ue(t.evt,t)}else y("service: received an empty response!")}};var pe={};function fe(e){var t,n;n=e,V(t="state#network"),pe[t]=n}var ve={Dismiss:"Ignorer",OK:"OK",Done:"Termin\xe9",Apply:"Appliquer","Try Again":"R\xe9essayer",Reset:"R\xe9initialiser",Send:"Envoyer",Cancel:"Annuler",Clear:"Effacer","Please tap BACK again to exit":"S'il vous pla\xeet appuyez sur RETOUR pour quitter","Sorry, we are unable to complete your request. Please try again later.":"D\xe9sol\xe9, nous ne sommes pas en mesure de compl\xe9ter votre demande. Veuillez r\xe9essayer plus tard.","Unable to connect to Wi-Fi or Mobile Network. Please check your connection settings.":"Connexion au r\xe9seau Wi-Fi ou mobile impossible. Veuillez v\xe9rifier vos param\xe8tres de connexion."};function ge(e){return function(e,t){if(t){if("en"===t)return e;if("fr"===t)return ve[e]}return e}(e,ne.LANGUAGE)||e}var me=n(80),be=(window.console,{log:function(e,t){return x("".concat(e," ").concat(t||""))},info:function(e,t){return x("".concat(e," ").concat(t||""))},warn:function(e,t){k("warn","".concat(e," ").concat(t||""))},error:function(e,t){k("err","".concat(e," ").concat(t||""))}});function je(e){return!!ne.GA_TRACKING_CODE&&((void 0===window.GA_INITIALIZED||e)&&((te()||2===Q.OS_TYPE)&&(window.console=be),me.a.initialize(ne.GA_TRACKING_CODE,{debug:!0}),window.GA_INITIALIZED=!0,me.a.ga("set","appName","LeoPages"),me.a.ga("set","appVersion",ne.APP_BUILD),me.a.ga("set","checkProtocolTask",null),me.a.ga("set","checkStorageTask",null),me.a.ga("set","historyImportTask",null),y("ga: ".concat(e?"force":""," initialized with tracking code ").concat(ne.GA_TRACKING_CODE))),!0)}function ke(e){je(e)&&!window.GA_LANDING_PAGE_TRIGGERED&&window.GA_INITIALIZED&&(y("ga: tracking code: ".concat(ne.GA_TRACKING_CODE)),y("ga: initialized: ".concat(window.GA_INITIALIZED)),ye("//Landing Page"),window.GA_LANDING_PAGE_TRIGGERED=!0)}function ye(e){e&&(je(!1)?(me.a.set({page:e}),me.a.pageview(e)):y("ga: ".concat(e)))}var Oe=n(18),xe=(n(37),n(68)),we=n(785),Ce=n(812),Ee=n(363);function Se(){return(Se=Object(b.a)(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.Ipfs.create();case 2:return n=e.sent,e.next=5,n.add(t);case 5:return a=e.sent,n.stop(),e.abrupt("return",a.cid.toString());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){return new Promise((function(t,n){var a=new Blob([e]),r=new FileReader;r.onload=function(e){t(e.target.result)},r.readAsText(a)}))}function Te(){return(Te=Object(b.a)(g.a.mark((function e(t){var n,a,r,i,o,c,s,u,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.Ipfs.create();case 2:n=e.sent,t.startsWith("/")||(t="/ipfs/"+t),a=[],r=!0,i=!1,e.prev=7,c=Object(Ee.a)(n.files.read(t));case 9:return e.next=11,c.next();case 11:return s=e.sent,r=s.done,e.next=15,s.value;case 15:if(u=e.sent,r){e.next=26;break}return l=u,e.t0=a,e.next=21,Ie(l);case 21:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 23:r=!0,e.next=9;break;case 26:e.next=32;break;case 28:e.prev=28,e.t2=e.catch(7),i=!0,o=e.t2;case 32:if(e.prev=32,e.prev=33,r||null==c.return){e.next=37;break}return e.next=37,c.return();case 37:if(e.prev=37,!i){e.next=40;break}throw o;case 40:return e.finish(37);case 41:return e.finish(32);case 42:return n.stop(),e.abrupt("return",a.join(""));case 44:case"end":return e.stop()}}),e,null,[[7,28,32,42],[33,,37,41]])})))).apply(this,arguments)}function Ae(){return(Ae=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof t){e.next=2;break}return e.abrupt("return",Promise.reject("readTextFileObj: invalid arg"));case 2:return e.abrupt("return",new Promise((function(e){var n=new FileReader;n.readAsText(t),n.onload=function(){e(n.result)}})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De=n(364),_e=n.n(De);function Pe(e,t){if(e&&e.length>t){var n=(t-3)/2;return e.substr(0,n)+"..."+e.substr(e.length-n)}return e}function We(e,t){return t?_e()(e,t):e}function Re(){var e=Date.now()/1e3;return e=~~e}var Ne=n(233),Le=n.n(Ne);function Me(){return Le.a.generate()}var Ue=n(138),Ge=n.n(Ue);function Be(e){var t=Ge.a.MD5(e);return t.toString(Ge.a.enc.utf8)}function Ke(e,t){return Ge.a.AES.encrypt(e,t).toString()}function He(e,t){var n=Ge.a.AES.decrypt(e,t);return n.toString(Ge.a.enc.Utf8)}function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t);var n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);t.select(),document.execCommand("copy"),document.body.removeChild(t),n&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n))}n(52);var ze=n(234),Fe=n.n(ze),Je=n(109),Ve=n(790),Ye=n(813),Qe=n(820),Xe=n(811),Ze=n(801);function $e(e,t){return 0!==(e&t)}var et=n(795),tt=n(796),nt=function(e){var t=Object(r.useState)(e.expanded),n=Object(f.a)(t,2),i=n[0],o=n[1],c=e.title,s=e.expandable,u=i?et.a:tt.a,l=e.icon;return Object(a.jsxs)("div",{style:Object(ae.a)({},e.style||{}),children:[Object(a.jsxs)("div",{style:{display:"flex",alignItems:"baseline",padding:"4px 0",borderBottom:"1px solid lightgray",background:"honeydew",color:"black"},onClick:function(){s&&o(!i)},children:[l&&Object(a.jsx)(l,{style:{margin:"0 0 0 4px"}}),Object(a.jsx)("span",{style:{margin:"0 0 0 8px",fontWeight:"500"},children:c||""}),Object(a.jsx)("span",{style:{flex:"auto"}}),s&&Object(a.jsx)(u,{style:{margin:"0 8px 0 0"}})]}),i&&Object(ae.a)({},e.children)]})},at=function(e){return Object(a.jsx)("div",{style:{height:"".concat(e.height)}})},rt=128,it={"#all":rt,"#notag":64,"#noicon":32,"#nocolor":16,"#pinned":1,"#deleted":2};function ot(e){var t;return e=null===(t=e)||void 0===t?void 0:t.toLowerCase(),it[e]||0}function ct(e){var t=0;return e.forEach((function(e){t|=ot(e)})),t}function st(e){for(var t=[],n=0,a=Object.entries(it);n<a.length;n++){var r=Object(f.a)(a[n],2),i=r[0];$e(e,r[1])&&t.push(i)}return t}function ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new Map,a=1<<t;return e.forEach((function(e){e.default?e.hash=0:(e.hash=a,a<<=1),n.set(e.name,e)})),n}function lt(e,t){if(!t||!t.length)return 0;var n=ot("#"===t[0]?t:"#".concat(t));if(!n){var a,r,i,o,c="#"===t[0]?t.substr(1):t;n=null===(a=e.hasher(16))||void 0===a||null===(r=a.get(c))||void 0===r?void 0:r.hash,n|=null===(i=e.hasher(8))||void 0===i||null===(o=i.get(c))||void 0===o?void 0:o.hash}return n}var dt=function(e,t){for(var n=0,a=0;a<e.length;a++){var r=e[a];if(r===t){n=1;break}(r.startsWith(t)||r.endsWith(t))&&(n=.5)}return n?.5+5*n/e.length:0};function ht(e,t,n){var a=n.category,r=n.theme,i=t.must,o=t.not,c=t.or,s=t.hash,u=n.tags,l=0;if(s){if($e(s,64)&&!u.length&&l++,$e(s,1)&&$e(n.hash,1)&&l++,$e(s,rt)&&l++,void 0!==a){var d,h=null===(d=e.hasher(16).get(a))||void 0===d?void 0:d.hash;(0!==(s&h)||!h&&$e(s,32))&&l++}if(void 0!==r){var p,f=null===(p=e.hasher(8).get(r))||void 0===p?void 0:p.hash;(0!==(s&f)||!f&&$e(s,16))&&l++}}var v,g=e.getProp(n,"@search");if(g){var m=[];g=g.map((function(e){return e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/[.,/#!$%^&*;:{}=\-_`~()]/g;return e.replace(t," ")}(e.toLowerCase()):e})).forEach((function(e){return m.push.apply(m,Object(Oe.a)(e.split(" ")))})),g=m.map((function(e){return e.trim()})).filter((function(e){return e.length>1}))}else g=[];u=",".concat(u.join(","),",");for(var b=0;b<i.length;b++){var j=i[b];if(u.includes(",".concat(j,",")))l+=3;else if(u.includes(",".concat(j)))l+=1;else{if(0===(v=dt(g,j)))return 0;l+=v}}for(var k=0;k<o.length;k++){var y=o[k];if(u.includes(",".concat(y,",")))return 0;if(1===(v=dt(g,y)))return 0}for(var O=0;O<c.length;O++){var x=c[O];u.includes(",".concat(x,","))?l+=3:u.includes(",".concat(x))?l+=1:l+=dt(g,x)}return l}function pt(e,t){return(e=e.trim())===(t=t.trim())||!(e.length>t.length?e.substr(t.length).trim():t.substr(e.length).trim()).length}function ft(e){return $e(e.hash||0,1)}var vt=n(235),gt=n.n(vt),mt=gt()((function(e){ue("app#cmd:quick-search",e)}),150),bt=gt()((function(e){ue("app#cmd:search",e)}),600);function jt(e,t){switch(t){case 0:mt(e);break;case 1:bt(e);break;case 2:ue("app#cmd:search",e)}}var kt=n(797),yt=n(798),Ot=n(799),xt=n(800),wt=n(365),Ct=[{icon:kt.a,tag:"#pinned",description:"#pinned"},{icon:yt.a,tag:"#notag",description:"#notag"},{icon:Ot.a,tag:"#noicon",description:"#noicon"},{icon:xt.a,tag:"#nocolor",description:"#nocolor"},{icon:Ze.a,tag:"#all",description:"#all"}];function Et(e,t){"popularity"===t?null===e||void 0===e||e.sort((function(e,t){return t.count-e.count})):"alphabetic"===t&&(null===e||void 0===e||e.sort((function(e,t){return e.value.localeCompare(t.value)})))}var St=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).updateData(e),a}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n=!1,a=this.options;if(a||(n=!0),!n){var r=e.options;a.type===r.type&&a.showCount===r.showCount&&a.showScale===r.showScale&&a.showAlphabetic===r.showAlphabetic||(n=!0)}if(n||this.props.descriptor!==e.descriptor&&(n=!0),!n){var i,o,c,s,u=this.props.data,l=e.data;u.tags.length===l.tags.length&&u.noTagCount===l.noTagCount&&u.noIconCount===l.noIconCount&&u.noThemeCount===l.noTagCount&&(null===(i=u.icons)||void 0===i?void 0:i.length)===(null===(o=l.icons)||void 0===o?void 0:o.length)&&(null===(c=u.themes)||void 0===c?void 0:c.length)===(null===(s=l.themes)||void 0===s?void 0:s.length)||(n=!0)}return n&&this.updateData(e),n}},{key:"updateData",value:function(e){this.options=e.options,this.data=this.generateCloudData(e.descriptor,e.data);var t=this.options.showAlphabetic?"alphabetic":"popularity",n=this.data,a=n.hashTags,r=n.iconTags,i=n.themeTags,o=n.tagTags;Et(a,t),Et(r,t),Et(i,t),Et(o,t)}},{key:"generateCloudData",value:function(e,t){var n=t.tags,a=t.noTagCount,r=t.icons,i=t.noIconCount,o=t.themes,c=t.noThemeCount,s=[];a>0&&s.push({value:"#notag",count:a}),i>0&&s.push({value:"#noicon",count:i}),c>0&&s.push({value:"#nocolor",count:c});var u=[],l=e.hasher(16);r.forEach((function(e){var t,n=e.name,a=e.count;n&&u.push({value:n,count:a,icon:null===(t=l.get(n))||void 0===t?void 0:t.icon,isHashTag:!0})}));var d=[];l=e.hasher(8),o.forEach((function(e){var t=e.name,n=e.count;if(t){var a=l.get(t);d.push({value:t,count:n,background:null===a||void 0===a?void 0:a.bkColor,color:(null===a||void 0===a?void 0:a.foreColor)||"black",isHashTag:!0})}}));var h=n.map((function(e){return{value:e.name,count:e.count}}));return{hashTags:s,iconTags:u,themeTags:d,tagTags:h}}},{key:"renderClickableIcon",value:function(e,t,n,r){return Object(a.jsxs)("div",{className:"clickable-no-underline",style:{marginRight:"16px",display:"flex",alignItems:"baseline"},onClick:r,children:[Object(a.jsx)(t,{className:"icon",style:{marginRight:"8px"}}),n]},e)}},{key:"renderHashTags",value:function(){var e=this;return Object(a.jsx)("div",{style:{display:"flex"},children:Ct.map((function(t){return e.renderClickableIcon(t.tag,t.icon,t.description,(function(){return ue("item#cmd:hashtag-selected",t.tag)}))}))})}},{key:"renderTag",value:function(e,t,n){var r=this.props.selectedTag,i=this.options,o=i.showCount,c=i.showScale,s=e.value,u=e.count,l=s;l=Pe(l,35).toLowerCase(),o&&(l="".concat(l,"(").concat(u,")"));var d={margin:"3px",padding:"3px",display:"inline-block"};-1!==l.indexOf(" ")&&(d.borderBottom="1px dotted black"),s===r&&(n="green",d.textDecoration="underline"),d.background=e.background,d.color=e.color;var h=l,p=e.icon;return p&&(h=Object(a.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(a.jsx)(p,{style:{marginRight:"4px"}}),l]})),c?Object(a.jsx)("span",{style:Object(ae.a)({fontSize:"".concat(t/2,"em"),color:n},d),className:"clickable-no-underline",children:h},s):Object(a.jsx)("span",{style:Object(ae.a)({fontSize:"1.2em",color:n},d),className:"clickable-no-underline",children:h},s)}},{key:"renderTagCloud",value:function(e){var t=this;return Object(a.jsx)(wt.TagCloud,{minSize:3,maxSize:10,shuffle:!1,tags:e,disableRandomColor:!0,renderer:function(e,n,a){return t.renderTag(e,n,a)},onClick:function(e){return ue("item#cmd:tag-selected","".concat(e.isHashTag?"#":"").concat(e.value))}})}},{key:"render",value:function(){var e=this.data,t=e.hashTags,n=e.iconTags,r=e.themeTags,i=e.tagTags;return Object(a.jsxs)(a.Fragment,{children:[this.options.showHashtag&&Object(a.jsx)("div",{className:"item-tagcloud-toolbar",children:this.renderHashTags()}),this.renderTagCloud([].concat(Object(Oe.a)(t),Object(Oe.a)(n),Object(Oe.a)(r),Object(Oe.a)(i)))]})}}]),n}(i.a.Component),It=n(50),Tt=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).dragging=!1,a.state={now:Date.now()},a.colorRamp=It.i(It.j),a.onTick=a.onTick.bind(Object(d.a)(a)),a.onResize=a.onResize.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.updateForceLayout(),window.addEventListener("resize",this.onResize)}},{key:"componentDidUpdate",value:function(){this.updateForceLayout()}},{key:"componentWillUnmount",value:function(){var e;window.removeEventListener("resize",this.onResize),null===(e=this.simulation)||void 0===e||e.stop()}},{key:"onResize",value:function(){this.clientWidth=void 0,this.clientHeight=void 0,this.tickCount=0,this.setState({now:Date.now()})}},{key:"initForceLayout",value:function(e,t){var n=this,a={};this.nodes=[],e.forEach((function(e){var t=Object(ae.a)({},e);a[e.name]=t,n.nodes.push(t)})),this.edges=[],t.forEach((function(e){var t=e.source,r=e.target,i=e.count;n.edges.push({source:a[t],target:a[r],weight:i})})),this.nodes.forEach((function(e){e.degreeCentrality=t.filter((function(t){return t.source===e.name||t.target===e.name})).length})),this.tickCount=0,this.clientWidth=void 0,this.clientHeight=void 0,y("graph: initialized ".concat(e.length," nodes, ").concat(t.length," edges"))}},{key:"createForceLayout",value:function(){var e=this,t=this.nodes,n=this.edges,a=this.svg,r=a.clientWidth,i=a.clientHeight;y("graph: create layout (".concat(r,", ").concat(i,")")),It.k(this.svg).style("width","".concat(r,"px")).style("height","".concat(i,"px")),this.simulation=It.f().force("charge",It.e().strength(-10)).force("center",It.b(r/2,i/2)).force("link",It.d().links(n).distance(80)).force("collision",It.c().radius((function(e){return 8}))).nodes(t).on("tick",this.onTick),It.k(this.svg).selectAll("line.link").data(n,(function(e){return"".concat(e.source.name,"-").concat(e.target.name)})).exit().remove();var o=It.h().domain([1,It.g(n,(function(e){return e.weight}))]).range([1,8]);It.k(this.svg).selectAll("line.link").data(n,(function(e){return"".concat(e.source.name,"-").concat(e.target.name)})).enter().append("line").attr("class","link").style("opacity",.5).style("stroke","#93C464").style("stroke-width",(function(e){return o(e.weight)})),It.k(this.svg).selectAll("g.node").data(t,(function(e){return e.name})).exit().remove();var c,s=It.h().domain([0,It.g(t,(function(e){return e.count}))]).range([4,16]),u=It.k(this.svg).selectAll("g.node").data(t,(function(e){return e.name})).enter().append("g").attr("class","node");u.append("circle").attr("r",(function(e){return s(e.count)})).style("fill",(function(t){return e.colorRamp(t.count)})).call((c=this,It.a().on("start",(function(e){c.dragging=!0,e.active||c.simulation.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(e){e.active||c.simulation.alphaTarget(0),c.dragging=!1,c.tickCount=0,e.subject.fx=null,e.subject.fy=null})))),u.append("text").style("text-anchor","middle").attr("y",15).text((function(e){return e.name}))}},{key:"updateForceLayout",value:function(){var e=!1,t=this.props.data,n=t.tags,a=t.links;this.propsNodes!==n&&(this.initForceLayout(n,a),this.propsNodes=n,e=!0);var r=this.svg,i=r.clientWidth,o=r.clientHeight;this.clientWidth===i&&this.clientHeight===o||(this.clientWidth=i,this.clientHeight=o,e=!0),(e||this.dragging)&&this.createForceLayout()}},{key:"onTick",value:function(){this.tickCount++,!this.dragging&&this.tickCount>250||(It.l("line.link").attr("x1",(function(e){return e.source.x})).attr("x2",(function(e){return e.target.x})).attr("y1",(function(e){return e.source.y})).attr("y2",(function(e){return e.target.y})),It.l("g.node").attr("transform",(function(e){return"translate(".concat(e.x,",").concat(e.y,")")})))}},{key:"render",value:function(){var e=this;return Object(a.jsx)("svg",{ref:function(t){return e.svg=t},style:{width:"100%",height:"100%"}})}}]),n}(i.a.Component),At=n(789),Dt=n(792),_t=[{name:"",bkColor:"#fff",foreColor:"black",default:!0},{name:"blue",bkColor:"#89a6db"},{name:"green",bkColor:"#9ecf89"},{name:"orange",bkColor:"#e9ae77"},{name:"purple",bkColor:"#a094d4"},{name:"red",bkColor:"#d69e9c"},{name:"yellow",bkColor:"#f8ef88"},{name:"black",bkColor:"#4e4e4e",foreColor:"white"}],Pt=ut(_t,8);function Wt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e&&Pt.has(e)?Pt.get(e):_t[0]}var Rt=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getMenuItem",value:function(e){var t=this,n=e.name,r=e.bkColor,i=e.foreColor;return Object(a.jsx)(At.a.Item,{style:{background:r,color:i||"black"},children:Object(a.jsx)("span",{style:{marginLeft:"8px"},onClick:function(e){var a,r;null===(a=(r=t.props).eventHandler)||void 0===a||a.call(r,"color#changed",{name:n})},children:n||"white"})},"menu#".concat(n))}},{key:"getDropdownMenu",value:function(){var e=this;return Object(a.jsx)(At.a,{children:_t.map((function(t){return e.getMenuItem(t)}))})}},{key:"render",value:function(){var e=Wt(this.props.theme),t=e.name,n=e.bkColor,r=e.foreColor,i=this.props,o=i.mode,c=i.style,s=c?Object(ae.a)({},c):{};"detail"===o&&((s={display:"flex",alignItems:"baseline"}).color=r||"black",s.background=n);var u=t||"white";return Object(a.jsx)(Dt.a,{overlay:this.getDropdownMenu(),placement:"bottomLeft",trigger:["click"],className:"icon",children:Object(a.jsxs)("div",{style:Object(ae.a)({width:"detail"===o?"100%":void 0},s),children:[Object(a.jsx)(xt.a,{class:"icon clickable"}),"detail"===o&&Object(a.jsx)("span",{style:{flex:"auto",marginLeft:"8px"},children:u})]})})}}]),n}(i.a.Component),Nt=n(784),Lt=n(802),Mt=n(803),Ut=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={password:"",ipfsCid:"",fileList:[],file:void 0},ce("importDlg",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){se("importDlg")}},{key:"onEvent",value:function(e,t){return"dialogue#cancel"===e?(ue("dlg#import#cancelled"),!0):"dialogue#ok"===e||void 0}},{key:"getDescription",value:function(){return this.props.description?this.props.description:Object(a.jsx)("p",{className:"ant-upload-text",children:"You can click or drag the file to this area to import"})}},{key:"render",value:function(){var e=this,t={onRemove:function(t){e.setState((function(e){var n=e.fileList.indexOf(t),a=e.fileList.slice();return a.splice(n,1),{fileList:a}}))},beforeUpload:function(t){return e.setState((function(e){return{fileList:[].concat(Object(Oe.a)(e.fileList),[t])}})),ue("dlg#import#OK",Object(ae.a)(Object(ae.a)({type:"file"},e.state),{},{file:t})),!1},fileList:this.state.fileList};return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{margin:"4px 8px 8px 0"},children:"Imported content is protected by password"}),Object(a.jsx)(Ve.a,{type:"password",style:{flex:"auto"},placeholder:"Enter password (optional)",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}},"input#password"),Object(a.jsx)("div",{style:{margin:"16px 8px 8px 0"},children:"Import from a local file"}),Object(a.jsx)("div",{children:Object(a.jsxs)(Nt.a.Dragger,Object(ae.a)(Object(ae.a)({},t),{},{children:[Object(a.jsx)("p",{className:"ant-upload-drag-icon",children:Object(a.jsx)(Lt.a,{})}),this.getDescription()]}))}),Object(a.jsx)("div",{style:{margin:"16px 8px 8px 0"},children:"Download from cloud"}),Object(a.jsxs)("div",{style:{display:"flex"},children:[Object(a.jsx)(Ve.a,{style:{flex:"auto"},placeholder:"IPFS cid",value:this.state.ipfsCid,onChange:function(t){e.setState({ipfsCid:t.target.value})}},"input#ipfs-cid"),Object(a.jsx)(xe.a,{style:{margin:"0 0 0 16px"},type:"primary",icon:Object(a.jsx)(Mt.a,{}),onClick:function(){return ue("dlg#import#OK",Object(ae.a)({type:"ipfs"},e.state))},children:"IPFS"})]})]})}}]),n}(i.a.Component),Gt=n(804),Bt=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={email:"",passssword:""},ce("exportDlg",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){se("exportDlg")}},{key:"onEvent",value:function(e,t){return"dialogue#cancel"===e?(ue("dlg#export#cancelled"),!0):"dialogue#ok"===e?(ue("dlg#export#OK",{type:"file"}),!0):void 0}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{margin:"16px 8px 8px 0"},children:"Protect exported content by password"}),Object(a.jsx)(Ve.a,{type:"password",style:{flex:"auto"},placeholder:"Enter password (optional)",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}},"input#password"),Object(a.jsx)("div",{style:{margin:"16px 8px 8px 0"},children:"Download"}),Object(a.jsx)(xe.a,{type:"primary",icon:Object(a.jsx)(Mt.a,{}),onClick:function(){return ue("dlg#export#OK",Object(ae.a)({type:"file"},e.state))},children:"Download to a Local File"}),Object(a.jsx)("div",{style:{margin:"16px 8px 8px 0"},children:"Upload"}),Object(a.jsx)(xe.a,{type:"primary",icon:Object(a.jsx)(Gt.a,{}),style:{margin:"0 16px 0 0"},onClick:function(){return ue("dlg#export#OK",Object(ae.a)({type:"ipfs"},e.state))},children:"Upload to IPFS"})]})}}]),n}(i.a.Component),Kt=n(805),Ht=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={githubrepo:e.githubrepo||"",githubtoken:e.githubtoken||""},ce("syncDlg",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){se("syncDlg")}},{key:"onEvent",value:function(e,t){return"dialogue#cancel"===e?(ue("dlg#sync#cancelled"),!0):"dialogue#ok"===e||void 0}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{margin:"16px 8px 8px 0"},children:"Sync with Github repository"}),Object(a.jsx)("div",{children:Object(a.jsx)(Ve.a,{type:"url",placeholder:"Repository URL",value:this.state.githubrepo,onChange:function(t){return e.setState({githubrepo:t.target.value})}},"input#url")}),Object(a.jsx)("div",{style:{margin:"8px 0"},children:Object(a.jsx)(Ve.a.Password,{placeholder:"Personal Access Token",value:this.state.githubtoken,onChange:function(t){return e.setState({githubtoken:t.target.value})}},"input#password")}),Object(a.jsx)(xe.a,{type:"primary",icon:Object(a.jsx)(Kt.a,{}),onClick:function(){return ue("dlg#sync#OK",{type:"github",url:e.state.githubrepo,token:e.state.githubtoken})},children:"Sync"})]})}}]),n}(i.a.Component);function qt(){return Me()}function zt(e){return e.id}function Ft(e){for(var t={},n=0,a=Object.entries(e);n<a.length;n++){var r=Object(f.a)(a[n],2),i=r[0],o=r[1];Array.isArray(o)?t[i]=Object(Oe.a)(o):t[i]=o}return t}var Jt=function(){function e(t,n){Object(u.a)(this,e),this.name=t||"idea",this.description=n||this.name,this.features=0}return Object(l.a)(e,[{key:"categoryEnabled",value:function(){return 0!==(1&this.features)}},{key:"themeEnabled",value:function(){return 0!==(2&this.features)}},{key:"getProp",value:function(e,t){if("@search"===t){var n;if(!e._tags)e._tags=(null===(n=e.tags)||void 0===n?void 0:n.join(","))||"";return[e.title,e._tags]}return"@description"===t?e.title:e[t]}},{key:"hasher",value:function(e){if(8===e&&this.themeEnabled())return Pt}},{key:"creator",value:function(){return{id:Me(),category:this.categoryEnabled()?"":void 0,theme:this.themeEnabled()?"":void 0}}},{key:"drawer",value:function(e,t){switch(e){case"import":return Object(a.jsx)(Ut,{});case"export":return Object(a.jsx)(Bt,{});case"sync":return Object(a.jsx)(Ht,Object(ae.a)({},t));default:return""}}},{key:"render",value:function(e,t,n){throw new Error(":render unimplemented")}},{key:"editor",value:function(e){throw new Error(":editor unimplemented")}},{key:"importText",value:function(){var e=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error(":importText unimplemented");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"exportText",value:function(){var e=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error(":exportText unimplemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Vt(e,t){var n=Object(Oe.a)(new Set([].concat(Object(Oe.a)(e.tags),Object(Oe.a)(t.tags)))),a=Object(ae.a)({},e);a.tags=n;var r=a,i=t;for(var o in i)"tags"!==o&&(a[o]?r[o]!==i[o]&&(r.last_modified&&i.last_modified?Number(i.last_modified)>Number(r.last_modified)?a[o]=i[o]:a[o]=r[o]:r.last_modified?a[o]=r[o]:(i.last_modified,a[o]=i[o])):a[o]=i[o]);return a}function Yt(e,t){for(var n=[],a=new Map,r=0,i=[].concat(Object(Oe.a)(e),Object(Oe.a)(t));r<i.length;r++){var o=i[r],c=zt(o);if(a.has(c)){var s=a.get(c);n[s]=Vt(n[s],o)}else n.push(o),a.set(c,n.length-1)}e.splice(0,e.length);for(var u=0,l=n;u<l.length;u++){var d=l[u];e.push(d)}return e}function Qt(e){if(e){var t=0,n=0,a=0,r=new Map,i=new Map,o=new Map,c=new Map;e.forEach((function(e){var s=e.tags,u=s.length;if(u)for(var l=0;l<u;l++){var d=s[l];r.has(d)?r.set(d,r.get(d)+1):r.set(d,1);for(var h=0;h<u;h++)if(h!==l){var p=s[h],f="".concat(d,",").concat(p);i.has(f)?i.set(f,i.get(f)+1):i.set(f,1)}}else t++;var v=e.category;void 0!==v&&(v?o.has(v)?o.set(v,o.get(v)+1):o.set(v,1):n++);var g=e.theme;void 0!==g&&(g?c.has(g)?c.set(g,c.get(g)+1):c.set(g,1):a++)}));var s=[];r.forEach((function(e,t){return s.push({name:t,count:e})}));var u=[];i.forEach((function(e,t){var n=t.split(",");u.push({source:n[0],target:n[1],count:e})}));var l=[];o.forEach((function(e,t){return l.push({name:t,count:e})}));var d=[];return c.forEach((function(e,t){return d.push({name:t,count:e})})),{tags:s,links:u,noTagCount:t,icons:l,noIconCount:n,themes:d,noThemeCount:a}}}var Xt=n(806),Zt=n(807);function $t(e,t){var n=e.tags,r=e.id||e.url;return Object(a.jsxs)("div",{className:"item-tags",children:[Object(a.jsx)(Xt.a,{style:{marginRight:"8px"}}),Object(a.jsx)("div",{style:{flex:"auto",display:"flex",flexWrap:"wrap"},children:n.length>0&&n.map((function(e){return e=e.toLowerCase(),function(e,t,n){return Object(a.jsx)("span",{style:{color:n,padding:"0 4px"},className:"clickable-no-underline",onClick:function(e){e.preventDefault(),e.stopPropagation(),ue("item#cmd:tag-selected",t)},children:Pe(t,35)},"item#".concat(e,"#").concat(t))}(r,e,e===t?"green":"#1890ff")}))})]})}function en(e){return $e(e.hash||0,1)}var tn=n(808),nn=n(809),an=n(810),rn=n(376),on=n.n(rn),cn={};function sn(e,t){return un.apply(this,arguments)}function un(){return(un=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){cn={name:t,resolve:e,reject:a},ue(t,n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ln(e){return dn.apply(this,arguments)}function dn(){return(dn=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#getText",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hn(e){return pn.apply(this,arguments)}function pn(){return(pn=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#confirm",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fn(){return(fn=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#getWorkspace"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vn(){return(vn=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#import"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gn(){return(gn=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#export"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mn(){return(mn=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#sync",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bn(){return(bn=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#editItem",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jn(){return(jn=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#editItem",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kn(){return(kn=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#addTags"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yn(){return(yn=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sn("dlg#deleteTags",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}ce("dlg",(function(e,t){var n;if(e.startsWith("dlg#")&&(e.endsWith("#OK")||e.endsWith("#cancelled"))&&e.startsWith(null===(n=cn)||void 0===n?void 0:n.name)){var a=cn,r=a.resolve,i=a.reject;cn={},e.endsWith("#OK")?r(t):i(t)}}));var On=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"generateMenuItem",value:function(e,t){return Object(a.jsx)(At.a.Item,{icon:Object(a.jsx)(t,{style:{fontSize:"20px"},className:"icon"}),onClick:function(t){e.confirm?hn(e.confirm).then((function(t){return ue("item#cmd:action",e)})):ue("item#cmd:action",e)},children:e.name},"menu#".concat(e.action))}},{key:"getDropdownMenu",value:function(e,t){var n=zt(t),r=en(t),i=e.getProp(t,"@description")||t.title;return Object(a.jsxs)(At.a,{children:[this.generateMenuItem({action:"toggle-pin",name:"Pin/Unpin",id:[n]},r?Zt.a:kt.a),this.generateMenuItem({action:"delete",name:"Delete",ids:[n],confirm:{title:"Delete",text:'Are you sure to delete "'.concat(i,'"')}},tn.a),this.generateMenuItem({action:"edit",name:"Edit",id:n},nn.a)]})}},{key:"renderItemDate",value:function(e){var t=e.add_date,n=e.last_modified;if(t||n){var r=new Date;return r.setTime(Number(1e3*(n||t))),Object(a.jsx)("div",{children:"".concat(on()(r).fromNow())})}return""}},{key:"render",value:function(){var e=this.props,t=e.descriptor,n=e.item;return Object(a.jsxs)("div",{className:"item-actionbar",children:[this.renderItemDate(n),Object(a.jsx)("div",{style:{flex:"auto"}}),Object(a.jsx)(Dt.a,{overlay:this.getDropdownMenu(t,n),placement:"bottomRight",trigger:["click"],children:Object(a.jsx)("span",{className:"clickable icon",style:{marginLeft:"4px"},children:Object(a.jsx)(an.a,{})})})]})}}]),n}(r.Component),xn=new Set;function wn(e){return xn.has(zt(e))}function Cn(e){var t=zt(e);xn.has(t)?xn.delete(t):(ne.ENABLE_MULTIPLE_EXPAND_COLLAPSE||En(),xn.add(t))}function En(){xn.clear()}var Sn=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderItemsSection",value:function(e,t,n,r,i){var o=this;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(nt,{title:r,icon:i,expandable:!0,expanded:!0,children:Object(a.jsx)("div",{children:t.map((function(t,a){return o.renderItem(e,t,n,function(e){return{background:e%2?"whitesmoke":"transparent"}}(a))}))})}),Object(a.jsx)(at,{height:"8px"})]})}},{key:"renderSwipeableItem",value:function(e,t,n){var r=this,i={display:"flex",overflowX:"scroll",overflowY:"hidden",margin:"4px 0px"},o=wn(t)?"detail":"simple";return"detail"===o&&(i.borderBottom="1px solid rgba(80, 88, 95, 0.2)"),Object(a.jsxs)("div",{style:i,onClick:function(){Cn(t),r.forceUpdate()},children:[Object(a.jsx)("div",{style:{flex:"none",width:"100%"},children:e.render(t,o,n)}),Object(a.jsx)(On,{descriptor:e,item:t})]},zt(t))}},{key:"renderItem",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=wn(t)?"detail":"simple";return Object(a.jsxs)("div",{style:i,onClick:function(e){var n=e.target;n.href||"svg"===n.tagName||(Cn(t),r.forceUpdate())},children:["detail"===o&&Object(a.jsx)(On,{descriptor:e,item:t}),e.render(t,o,n)]},zt(t))}},{key:"render",value:function(){var e=this.props,t=e.descriptor,n=e.items,r=e.selectedTag;if(!n.length)return"";var i=n.filter((function(e){return en(e)})),o=i.length?n.filter((function(e){return!en(e)})):n;if(r&&n.length>1){var c=o.filter((function(e){return e.tags.includes(r)})),s=o.filter((function(e){return!1===e.tags.includes(r)}));return Object(a.jsxs)("div",{children:[i.length>0&&this.renderItemsSection(t,i,r,"Pinned (".concat(i.length,")"),kt.a),c.length>0&&this.renderItemsSection(t,c,r,'Tag: "'.concat(Pe(r,35),'" (').concat(c.length,")"),Xt.a),s.length>0&&this.renderItemsSection(t,s,r,"".concat(We(i.length||c.length?"Other Tags":"Results",s.length)," (").concat(s.length,")"),Xe.a)]})}return Object(a.jsxs)("div",{children:[i.length>0&&this.renderItemsSection(t,i,r,"Pinned (".concat(i.length,")"),"pushpin"),o.length>0&&this.renderItemsSection(t,o,r,"".concat(We(i.length?"Others":"Results",o.length)," (").concat(o.length,")"),"search")]})}}]),n}(i.a.Component),In=n(791),Tn=n(814),An=n(815),Dn=n(816),_n=n(817),Pn=n(818),Wn=n(819),Rn=n(377),Nn=n.n(Rn),Ln=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"generateIconMenuItem",value:function(e,t,n){return Object(a.jsx)(At.a.Item,{icon:Object(a.jsx)(t,{style:{fontSize:"20px"},className:"icon"}),onClick:function(t){return ue(e)},children:n},"menu#".concat(e))}},{key:"generateCheckboxMenuItem",value:function(e,t,n){return Object(a.jsx)(At.a.Item,{children:Object(a.jsx)(In.a,{checked:n,onClick:function(t){return ue(e)},children:t})},"menu#".concat(e))}},{key:"getWorkspaceDropdownMenuItems",value:function(){var e=Pe(this.props.workspace.getName(),35);return[this.generateIconMenuItem("cmd#add-workspace",Ce.a,"Add a workspace"),this.generateIconMenuItem("cmd#confirm-and-edit-workspace",nn.a,'Rename "'.concat(e,'"')),this.generateIconMenuItem("cmd#confirm-and-delete-workspace",Ye.a,'Remove "'.concat(e,'"'))]}},{key:"getItemsDropdownMenuItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{items:[],metaData:{}},n=t.items,r=t.metaData,i=r.tags,o=r.noTagCount,c=r.noIconCount,s=r.noThemeCount,u=[];if(n.length&&(u.push(this.generateIconMenuItem("cmd#bulk-add-tags",Xt.a,"Add tags")),i.length&&u.push(this.generateIconMenuItem("cmd#bulk-delete-tags",Ye.a,"Remove tags")),u.push(this.generateIconMenuItem("cmd#confirm-and-delete-items",tn.a,"Delete items"))),u.push(this.generateIconMenuItem("cmd#add-item",Ce.a,"Add an item")),n.length&&(o||c||s)&&(u.push(Object(a.jsx)(At.a.Divider,{},"menu#separator3")),o>0&&u.push(this.generateIconMenuItem("cmd#show-untagged-items",yt.a,"Show untagged items")),c>0&&u.push(this.generateIconMenuItem("cmd#show-uniconized-items",Ot.a,"Show uniconized items")),s>0&&u.push(this.generateIconMenuItem("cmd#show-uncolorized-items",xt.a,"Show uncolorized items"))),null===i||void 0===i?void 0:i.length){var l=e.options,d=l.showAlphabetic,h=l.showCount,p=l.showScale;u.push(Object(a.jsx)(At.a.Divider,{},"menu#separator#tagcloud")),u.push(Object(a.jsxs)(Nn.a,{icon:Object(a.jsx)(Xt.a,{className:"icon",style:{fontSize:"20px"}}),title:"Tag Cloud Settings",children:[this.generateCheckboxMenuItem("cmd#toggle-tag-sort","Show tags in alphabetic order",d),this.generateCheckboxMenuItem("cmd#toggle-tag-count","Show tag counts",h),this.generateCheckboxMenuItem("cmd#toggle-tag-scale","Show tag scales",p)]},"tag-cloud-settings"))}return u}},{key:"getActionDropdownMenuItems",value:function(){var e=[this.generateIconMenuItem("cmd#import",Tn.a,"Import"),this.generateIconMenuItem("cmd#export",An.a,"Export")];return ne.ENABLE_SYNC&&e.push(this.generateIconMenuItem("cmd#sync",Dn.a,"Sync")),e}},{key:"getDropdownMenu",value:function(e,t){var n,r=[];return ne.ENABLE_WORKSPACE_MENUITEMS&&(n=this.getWorkspaceDropdownMenuItems()).length&&(r=[].concat(Object(Oe.a)(r),Object(Oe.a)(n))).push(Object(a.jsx)(At.a.Divider,{},"menu#separator#workspace")),(n=this.getItemsDropdownMenuItems(e,t)).length&&(r=[].concat(Object(Oe.a)(r),Object(Oe.a)(n))).push(Object(a.jsx)(At.a.Divider,{},"menu#separator#items")),(n=this.getActionDropdownMenuItems()).length&&(r=[].concat(Object(Oe.a)(r),Object(Oe.a)(n))),Object(a.jsx)(At.a,{children:r})}},{key:"renderRunningStateMessage",value:function(){var e=this.props,t=e.query,n=e.isSearchCompleted,r=e.isQuickSearch,i=e.visibleData,o=Pe(t,35);if(t&&!n)return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{children:'Searching "'.concat(o,'"')}),Object(a.jsx)(_n.a,{style:{marginLeft:"4px"}})]});var c,s=i.items,u=i.total,l=i.isAllData,d=i.metaData.tags;if(t)return s.length?r?Object(a.jsx)("span",{children:'Still searching "'.concat(o,'"')}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{children:"".concat(s.length," ").concat(We("match",s.length<=1?2:1),' "').concat(o,'"')}),Object(a.jsx)(Pn.a,{twoToneColor:"greenyellow",style:{marginLeft:"4px"}})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{children:o.length>2?'Nothing matches "'.concat(o,'"'):'"'.concat(o,'" contains too few characters')}),Object(a.jsx)(Wn.a,{style:{marginLeft:"4px"},twoToneColor:"red"})]});if(0===u)c="Oops there is nothing yet";else{var h=l?u:s.length;c="Total ".concat(h," ").concat(We(this.props.name,h)),d.length&&(c+=", ".concat(d.length," ").concat(We("tag",d.length)))}return Object(a.jsx)("span",{children:c})}},{key:"render",value:function(){var e=this.props,t=e.workspace,n=e.visibleData;return Object(a.jsxs)("div",{className:"item-result-header",children:[this.renderRunningStateMessage(),Object(a.jsx)("div",{style:{flex:"auto"}}),Object(a.jsx)(Dt.a,{overlay:this.getDropdownMenu(t,n),placement:"bottomRight",trigger:["click"],children:Object(a.jsx)("span",{className:"clickable icon",style:{marginLeft:"4px"},children:Object(a.jsx)(an.a,{})})})]})}}]),n}(r.Component),Mn="workspace",Un=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),a=t.call(this,e),y("".concat(Mn,": created")),a.lastRequestedQuery="",a.lastCompletedQuery="",a.workspace=e.workspace,a.onEvent=a.onEvent.bind(Object(d.a)(a)),a.onScroll=a.onScroll.bind(Object(d.a)(a)),a.onRequestSearch=a.onRequestSearch.bind(Object(d.a)(a)),a.onCompleteSearch=a.onCompleteSearch.bind(Object(d.a)(a)),a.onGroupSearchResult=a.onGroupSearchResult.bind(Object(d.a)(a)),ce(Mn,a.onEvent.bind(Object(d.a)(a))),ye("//".concat(Mn," Page")),a}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){se(Mn)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.lastRequestedQuery="",this.lastCompletedQuery=""}},{key:"getWorkspace",value:function(){return this.props.workspace}},{key:"getWorkspaceState",value:function(){return this.getWorkspace().getWorkingState()}},{key:"setWorkspaceState",value:function(e){this.getWorkspace().setWorkingState(e);var t=Date.now();this.setState({lastUpdateTimestamp:t}),O("update state: ".concat(JSON.stringify(e))),O("setState: ".concat(t))}},{key:"getDescriptor",value:function(){return this.getWorkspace().descriptor}},{key:"getDataSource",value:function(){return this.getWorkspace().dataSource}},{key:"enableTagGraph",value:function(){return ne.ENABLE_TAG_GRAPH}},{key:"onEvent",value:function(e,t){var n=this.getWorkspace();switch(e){case"item#cmd:tag-selected":case"item#cmd:hashtag-selected":var a=t;n.getVisibleData().isAllData?this.onCompleteSearch(t,!1):(this.setWorkspaceState({selectedTag:a}),this.onGroupSearchResult(a)),this.forceUpdate();break;case"cmd#show-all-items":this.onCompleteSearch("#all",!1);break;case"cmd#show-untagged-items":this.onCompleteSearch("#notag",!1);break;case"cmd#show-uniconized-items":this.onCompleteSearch("#noicon",!1);break;case"cmd#show-uncolorized-items":this.onCompleteSearch("#nocolor",!1);break;case"item#menu#pinned":this.onCompleteSearch("#pinned",!1);break;case"app#cmd:search":this.onCompleteSearch(t,!1);break;case"app#cmd:quick-search":this.onCompleteSearch(t,!0);break;case"item#updated-hashtag":var r,i=this.getDataSource();i.pinnedItems=null===(r=i.items)||void 0===r?void 0:r.filter((function(e){return $e(e.hash,1)})),this.forceUpdate();break;default:null===n||void 0===n||n.onEvent(e,t)}}},{key:"onScroll",value:function(){var e;null===(e=document.activeElement)||void 0===e||e.blur()}},{key:"onRequestSearch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.lastRequestedQuery;if(!n){var a=this.getDataSource();a.searchedItems=void 0,a.searchedTags=void 0}this.lastRequestedQuery=e,pt(n,e)?(y('items: discarded an already requested search "'.concat(e,'"')),this.setWorkspaceState({query:e,isSearchCompleted:!0,isQuickSearch:!1})):(this.setWorkspaceState({query:e,isSearchCompleted:!1}),t?(jt(e,0),jt(e,1)):jt(e,2),y("".concat(this.getWorkspace().name,': searching "').concat(e,'"')))}},{key:"onCompleteSearch",value:function(e,t){var n=this.getDataSource(),a=this.getWorkspace(),r=function(e,t){var n,a,r=[],i=[],o=[],c=0;return t.toLowerCase().split(" ").forEach((function(t){if((t=t.trim()).length)switch(t[0]){case"+":1===t.length?n="+":(a=t.substr(1)).length>=2&&r.push(a);break;case"-":1===t.length?n="-":(a=t.substr(1)).length>=2&&i.push(a);break;case"#":1===t.length?n="#":(n=void 0,c|=lt(e,t));break;default:t.length>=1&&("+"===n?t.length>=2&&r.push(t):"-"===n?t.length>=2&&i.push(t):"#"===n?c|=lt(e,t):t.length>=2&&o.push(t)),n=void 0}})),$e(c,rt)&&(o.length=0,c&=-66),1===o.length&&(r.unshift(o[0]),o.length=0),{must:r,not:i,or:o,hash:c}}(this.getDescriptor(),e),i=r.must,o=r.not,c=r.or;if($e(r.hash,rt)&&!i.length&&!o.length&&!c.length)return n.searchedItems=void 0,n.searchedTags=void 0,this.lastCompletedQuery=e,a.invalidateVisibleData(),this.setWorkspaceState({query:e,selectedTag:"",isSearchCompleted:!0,isQuickSearch:t}),void En();if(!t){var s=n.searchedItems;if(e===this.lastCompletedQuery&&s&&s.length<5)return y('item: skipped a full search, "'.concat(e,'"')),void this.setWorkspaceState({query:e,selectedTag:"",isSearchCompleted:!0,isQuickSearch:t})}for(var u=[],l=n.items,d=this.getDescriptor(),h=0;h<l.length;h++){var p=ht(d,r,l[h]);if(p>0&&(u.push({index:h,score:p}),t>0&&u.length>=5))break}var f=[];u.forEach((function(e){var t=l[e.index];t.score=e.score,f.push(t)})),f.sort((function(e,t){return e.score-t.score})),function(e,t){t.sort((function(e,t){if(e.score===t.score){var n=ft(e),a=ft(t);if(n&&!a)return-1;if(!n&&a)return 1}return e.score===t.score?Number(t.add_date||0)-Number(e.add_date||0):t.score-e.score}))}(0,f),n.searchedItems=f,this.getDataSource().syncMetaData("searched"),this.lastCompletedQuery=e,y("".concat(this.getWorkspace().name,": ").concat(t?"quick":"full"," search results, ").concat(f.length," ").concat(We("match",f.length<=1?2:1),' "').concat(e,'"')),En(),this.setWorkspaceState({query:e,selectedTag:"",isSearchCompleted:!0,isQuickSearch:t}),a.invalidateVisibleData()}},{key:"onGroupSearchResult",value:function(e){var t=this.getDataSource(),n=t.searchedItems;n&&(n.sort((function(t,n){return t.tags.includes(e)?-1:n.tags.includes(e)?1:0})),t.searchedMetaData=Qt(n))}},{key:"renderSearchBar",value:function(){var e=this,t=this.getWorkspaceState().query,n=t.length?Object(a.jsx)(Ye.a,{className:"clickable",onClick:function(){return e.onCompleteSearch("",!1)}}):Object(a.jsx)(Je.a,{title:"Search by words; a word starts with '+' must exist, a word starts with '-' must not; example: 'apple android +phone -fruit' means a matched result contains 'apple' or 'android', and must contain 'phone', must not contain 'fruit'",children:Object(a.jsx)(Qe.a,{className:"clickable"})});return Object(a.jsx)("div",{className:"item-toolbar",children:Object(a.jsx)(Ve.a,{type:"search",placeholder:"Search everything!",prefix:Object(a.jsx)(Xe.a,{style:{color:"rgba(0,0,0,.25)"}}),suffix:n,value:t,onChange:function(t){return e.onRequestSearch(t.target.value,!0)}},"input#search")})}},{key:"renderTagCloud",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.isAllData,i=e.metaData,o=i.tags,c=i.icons,s=i.themes,u=i.noTagCount,l=i.noIconCount,d=i.noThemeCount;if(!(o.length||u||s.length||d||c.length||l))return"";var h="".concat(r?"All":"Related"," "),p=o.length;p&&(h+="".concat(We("Tag",p)," (").concat(p,") ")),((null===c||void 0===c?void 0:c.length)||(null===s||void 0===s?void 0:s.length))&&(p=c.length+s.length,h+="".concat(We("Category",p)," (").concat(p,")"));var f=this.getWorkspace(),v=this.getWorkspaceState(),g=v.selectedTag,m=f.options,b=m.type||"cloud",j={descriptor:this.getDescriptor(),data:i,selectedTag:r?"":g,options:m};return Object(a.jsx)(nt,Object(ae.a)(Object(ae.a)({title:h,icon:Ze.a,expandable:!0},t),{},{children:Object(a.jsx)("div",Object(ae.a)(Object(ae.a)({},n),{},{children:Object(a.jsx)("div",{className:"item-tagcloud",children:Object(a.jsxs)("div",{style:{width:"100%",height:"calc(100% - 30px"},children:["cloud"===b&&Object(a.jsx)(St,Object(ae.a)({},j)),this.enableTagGraph()&&"graph"===b&&Object(a.jsx)(Tt,Object(ae.a)({},j))]})})}))}),"section#tags")}},{key:"renderItems",value:function(e){if(!(null===e||void 0===e?void 0:e.length))return"";var t=this.getWorkspace(),n=this.getWorkspaceState(),r=n.selectedTag,i=n.isSearchCompleted,o=n.isQuickSearch;return Object(a.jsx)(Sn,{descriptor:this.getDescriptor(),isSearchCompleted:i,isQuickSearch:o,items:e,selectedTag:r},"".concat(t.getId(),"#items"))}},{key:"renderCompactLayout",value:function(e,t){var n=e.query,r=e.isSearchCompleted,i=e.isQuickSearch,o=this.getDescriptor().name,c=t.items,s=t.isAllData;return Object(a.jsxs)("div",{style:{height:"inherit",margin:"8px 8px"},children:[this.renderSearchBar(),Object(a.jsx)(Ln,Object(ae.a)({name:o,query:n,isSearchCompleted:r,isQuickSearch:i,visibleData:t},this.props)),Object(a.jsxs)("div",{className:"scrollable item-result-container",onScroll:this.onScroll,children:[this.renderTagCloud(t,{expanded:s}),Object(a.jsx)(at,{height:"8px"}),this.renderItems(c)]})]})}},{key:"renderFullLayout",value:function(e,t){var n=e.query,r=e.isSearchCompleted,i=e.isQuickSearch,o=this.getDescriptor().name,c=t.items,s=t.isAllData;return Object(a.jsxs)("div",{style:{display:"flex",margin:"8px 8px",height:"inherit"},children:[Object(a.jsxs)("div",{style:{width:"60%",height:"100%",margin:"0 8px 0 0"},children:[this.renderSearchBar(),Object(a.jsx)(Ln,Object(ae.a)({name:o,query:n,isSearchCompleted:r,isQuickSearch:i,visibleData:t},this.props)),Object(a.jsx)("div",{className:"scrollable item-result-container",onScroll:this.onScroll,children:this.renderItems(c)})]}),Object(a.jsx)("div",{style:{width:"40%",height:"100%",margin:"0 0 0 8px"},children:this.renderTagCloud(t,{expanded:s,style:{height:"inherit"}},{style:{height:"calc(100% - 80px)"},className:"scrollable"})})]})}},{key:"render",value:function(){var e=this.getWorkspaceState(),t=e.query,n=e.isSearchCompleted,r=e.isQuickSearch,i=e.loaded,o=this.getWorkspace().getVisibleData();if(!i)return Object(a.jsx)("div",{style:{margin:"8px 8px"},children:"Loading..."});var c=this.props.workspace;if(c!==this.workspace&&(this.workspace=c,c.query))return this.onRequestSearch(c.query,!0),Object(a.jsx)("div",{style:{margin:"8px 8px"},children:"Working on it..."});O("render ".concat(o.items.length,' items for "').concat(t,'", quick: ').concat(r,", completed: ").concat(n));var s="";return s="mini"===ne.LAYOUT_STRATEGY?this.renderCompactLayout(e,o):"full"===ne.LAYOUT_STRATEGY?this.renderFullLayout(e,o):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Fe.a,{maxWidth:767,children:this.renderCompactLayout(e,o)}),Object(a.jsx)(Fe.a,{minWidth:768,children:this.renderFullLayout(e,o)})]}),Object(a.jsx)("div",{className:"no-select",style:{height:"inherit"},children:s})}}]),n}(i.a.Component);function Gn(e){return!e.descriptor||ne.WORKSPACE_STRATEGY.includes(e.descriptor.name)}function Bn(){return ne.WORKSPACE_STRATEGY.split(",")}var Kn=n(79),Hn=n(63),qn=n(821);function zn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{className:"item-favicon"};if(!e)return"";try{var n=new URL(e).hostname;return Object(a.jsx)("img",Object(ae.a)({src:"https://s2.googleusercontent.com/s2/favicons?domain=".concat(n),alt:""},t))}catch(o){var r,i;return y("".concat(JSON.stringify((null===(r=o.err)||void 0===r?void 0:r.message)||(null===(i=o.err)||void 0===i?void 0:i.stack)))),""}}var Fn=n(378),Jn=n.n(Fn);function Vn(e,t){var n=e.attr("href"),a=null===n||void 0===n?void 0:n.toLowerCase(),r=e.text();if((null===a||void 0===a?void 0:a.startsWith("http://"))||(null===a||void 0===a?void 0:a.startsWith("https://")))return{url:n,title:r,tags:Object(Oe.a)(t),add_date:Number(e.attr("add_date"))};y("discarded bookmark ".concat(r," (").concat(n,")"))}function Yn(e){var t;switch(e=null===(t=e)||void 0===t?void 0:t.trim().toLowerCase()){case"bookmarks bar":case"bookmarks":case"favorites":case"favorites bar":case"new folder":return;default:return e}}function Qn(e){for(;e&&"dl"!==e.name;)e=e.next;return e}function Xn(e){for(var t,n,a=[],r=[],i=[],o=0,c=0,s=Jn.a.load(e),u=s("dt"),l=0;l<u.length;l++){var d=u[l],h=s(d).find("> h3");if(null===h||void 0===h?void 0:h.length){var p=Yn(s(h[0]).text());if(!p)continue;var f=Qn(h[0]);if(!f)continue;for(var v=r.length-1;v>=0;v--)if(t=f,n=r[v],t&&n&&t.parent.parent===n.parent.parent){r.length=v,i.length=v;break}r.push(f),i.push(p)}else{var g=s(d).find("> a").first();if(null===g||void 0===g?void 0:g.length){var m=Vn(g,i);m?(a.push(m),o++):c++}}}return a.forEach((function(e){e.tags=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"===typeof e?e=e.split(","):Array.isArray(e)||(y("invalid tags: ".concat(JSON.stringify(e))),e=""),e=e.map((function(e){return e.trim().toLowerCase()})),Object(Oe.a)(new Set(e))}(e.tags)})),y("bookmark: parsed ".concat(o,", discarded ").concat(c)),a}function Zn(e){var t=[];try{var n=JSON.parse(e);t=Array.isArray(n)?n:n.bookmarks||n.items}catch(r){t=Xn(e)}var a=Qt(t);return Promise.resolve({items:t,tags:null===a||void 0===a?void 0:a.tags})}function $n(){for(var e=new Map,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];n.forEach((function(t){var n,a=Object(j.a)(t);try{for(a.s();!(n=a.n()).done;){var r,i=n.value,o=null===(r=i.url)||void 0===r?void 0:r.trim().toLowerCase();if(o){try{o=decodeURIComponent(o)}catch(c){y("bookmark: detected invalid URL ".concat(o))}e.has(o)?i.id=e.get(o):e.set(o,i.id)}}}catch(s){a.e(s)}finally{a.f()}}))}function ea(e,t){return ta.apply(this,arguments)}function ta(){return(ta=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Zn(n).then((function(e){var n=e.items||e.bookmarks||[];return n.forEach((function(e){var t=e.hash;delete e.hash,t&&Array.isArray(t)&&(e.hash=ct(t))})),(n=n.filter((function(e){return!!ie(e.url)||(y("bookmark: discarded ".concat(e.url)),!1)}))).forEach((function(e){e.id||(e.id=qt())})),$n(t.items,n),t.items=Yt(t.items,n),t.metaData=Qt(t.items),t})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function na(e){var t=[];return e.items.forEach((function(e){t.push({url:e.url,title:e.title,tags:e.tags,add_date:e.add_date,last_modified:e.last_modified,hash:e.hash?st(e.hash):void 0,path:e.path})})),JSON.stringify({items:t})}function aa(e){return ra.apply(this,arguments)}function ra(){return(ra=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(na(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ia=n(793),oa=n(794),ca=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={isEditing:!1,tagValue:""},a.tags=e.tags,a.validateTags(),a.onDeleteTag=a.onDeleteTag.bind(Object(d.a)(a)),a.onStartEditTag=a.onStartEditTag.bind(Object(d.a)(a)),a.onChangeTag=a.onChangeTag.bind(Object(d.a)(a)),a.onEndEditTag=a.onEndEditTag.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.tags=e.tags,this.validateTags()}},{key:"validateTags",value:function(){var e=this.tags,t=Object(Oe.a)(new Set(e.map((function(e){return(e=e.trim().toLowerCase()).startsWith("#")&&(e=e.substr(1)),e}))));e.splice(0,e.length),t.forEach((function(t){t.length&&e.push(t)}))}},{key:"onDeleteTag",value:function(e){e=e.trim().toLowerCase();var t=this.tags.findIndex((function(t){return t===e}));-1!==t&&(this.tags.splice(t,1),this.forceUpdate())}},{key:"onStartEditTag",value:function(){var e=this;this.setState({isEditing:!0},(function(){return e.tagInput.focus()}))}},{key:"onChangeTag",value:function(e){this.setState({tagValue:e.target.value})}},{key:"onEndEditTag",value:function(){this.tags.push(this.state.tagValue.trim().toLowerCase()),this.validateTags(),this.setState({isEditing:!1,tagValue:""})}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,r=t.buttonTitle,i=this.state,o=i.isEditing,c=i.tagValue;return Object(a.jsxs)("div",{style:{lineHeight:2},children:[n&&Object(a.jsx)("span",{style:{marginRight:"8px"},children:n}),this.tags.map((function(t,n){var r=t.length>20,i=Object(a.jsx)(oa.a,{color:"green",closable:!0,onClose:function(){return e.onDeleteTag(t)},children:r?"".concat(t.slice(0,20),"..."):t},t);return r?Object(a.jsx)(Je.a,{title:t,children:i},t):i})),o&&Object(a.jsx)(Ve.a,{ref:function(t){return e.tagInput=t},type:"text",size:"small",style:{width:78},value:c,onChange:this.onChangeTag,onBlur:this.onEndEditTag,onPressEnter:this.onEndEditTag},"input#tag-editor"),!o&&Object(a.jsxs)(oa.a,{onClick:this.onStartEditTag,style:{background:"#fff",borderStyle:"dashed"},children:[Object(a.jsx)(Ce.a,{})," ",r||"New Tag"]})]})}}]),n}(r.Component),sa=Ve.a.TextArea,ua=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).item=Ft(e.item),a.item.url=decodeURIComponent(a.item.url||""),a.state={errorMessage:""},a.onPropsChanged=a.onPropsChanged.bind(Object(d.a)(a)),a.onUrlChanged=a.onUrlChanged.bind(Object(d.a)(a)),a.onTitleChanged=a.onTitleChanged.bind(Object(d.a)(a)),ce("bookmarkEditor",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.item&&(this.item=Ft(e.item),this.item.url=decodeURIComponent(this.item.url||""),this.setState({errorMessage:""}))}},{key:"componentWillUnmount",value:function(){se("bookmarkEditor")}},{key:"onPropsChanged",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var a=Object(f.a)(n[t],2),r=a[0],i=a[1];this.item[r]=i}this.setState({errorMessage:""})}},{key:"onUrlChanged",value:function(e){this.onPropsChanged({url:e.target.value.trim()})}},{key:"onTitleChanged",value:function(e){this.onPropsChanged({title:e.target.value})}},{key:"onEvent",value:function(e,t){if("dialogue#cancel"===e)return ue("dlg#editItem#cancelled"),!0;if("dialogue#ok"===e){var n=this.item,a=n.url,r="";return n.title.trim().length||(r+="Title cannot be empty"),a.trim().length?ie(a)||(r+="".concat(r.length?", ":"","Invalid URL")):r+="".concat(r.length?", ":"","URL cannot be empty"),r?(this.setState({errorMessage:r}),!1):(ue("dlg#editItem#OK",this.item),!0)}}},{key:"render",value:function(){var e=this.state.errorMessage,t=this.item,n=t.tags,r=t.url,i=t.title;return Object(a.jsxs)("div",{children:[e&&Object(a.jsx)(ia.a,{message:e,banner:!0,closable:!0}),Object(a.jsx)("div",{className:"itemedit-title",children:"Tags"}),Object(a.jsx)(ca,{tags:n}),Object(a.jsx)(Ve.a,{type:"url",style:{margin:"16px 0 0 0"},value:r,placeholder:"URL",onChange:this.onUrlChanged},"input#url"),Object(a.jsx)(sa,{style:{margin:"16px 0 0 0"},value:i,onChange:this.onTitleChanged,placeholder:"Title",autoSize:{minRows:5,maxRows:10}})]})}}]),n}(i.a.Component),la=Object(a.jsx)(Ut,{description:Object(a.jsxs)("p",{className:"ant-upload-text",children:["You can export your browser's bookmarks to a HTML file",Object(a.jsx)("a",{href:"https://support.emerson.edu/hc/en-us/articles/115002413966-Exporting-and-Importing-Browser-Bookmarks",target:"_blank",rel:"noopener noreferrer",children:"(learn how here!)"}),", and then click or drag the file to this area to import"]})}),da=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this,"bookmark","Bookmarks, links, favorite web sites")).icon=Object(a.jsx)(qn.a,{}),e}return Object(l.a)(n,[{key:"creator",value:function(){return Object(ae.a)(Object(ae.a)({},Object(Kn.a)(Object(Hn.a)(n.prototype),"creator",this).call(this)),{},{title:"",url:"",tags:[]})}},{key:"render",value:function(e,t,n){return function(e,t,n){var r=e.url,i=e.title,o=r;if("detail"===t){var c,s="".concat(i||"(untitled)"," - (").concat(r,")");return Object(a.jsxs)("div",{className:"item item-card border",children:[Object(a.jsxs)("div",{children:[zn(r),Object(a.jsx)("span",{children:s})]}),Object(a.jsx)("div",{children:(null===(c=e.tags)||void 0===c?void 0:c.length)>0&&$t(e,n)})]},"item#".concat(o))}return Object(a.jsxs)("div",{className:"item",children:[zn(r),Object(a.jsx)("a",{className:"item-link",href:r,target:"_blank",rel:"noopener noreferrer",children:i||"(untitled)"})]},"item#".concat(o))}(e,t,n)}},{key:"editor",value:function(e){return Object(a.jsx)(ua,Object(ae.a)({},e))}},{key:"drawer",value:function(e,t){return"import"===e?la:Object(Kn.a)(Object(Hn.a)(n.prototype),"drawer",this).call(this,e,t)}},{key:"notifier",value:function(e,t){if("item#will-update"===e){var n,a=t.dataSource,r=t.item,i=r.id,o=null===(n=r.url)||void 0===n?void 0:n.trim().toLowerCase();if(o){var c=a.items.filter((function(e){var t;return e.id!==i&&(null===(t=e.url)||void 0===t?void 0:t.trim().toLowerCase())===o})).map((function(e){return e.id}));a.deleteItems(c)}}}},{key:"importText",value:function(){var e=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ea(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"exportText",value:function(){var e=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",aa(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Jt),ha=n(824),pa=n(822),fa=n(823),va=n(786),ga=(va.a.Title,va.a.Paragraph);va.a.Text,va.a.Link;var ma=function(e,t){var n=e.split("\n");return Object(a.jsx)(a.Fragment,{children:n.map((function(e){return Object(a.jsx)(ga,{style:{marginBottom:"2px",color:t},children:e})}))})};function ba(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=t.items||t.vaults||[];a.forEach((function(e){var t=e.hash;delete e.hash,t&&Array.isArray(t)&&(e.hash=ct(t)),n&&(e.name=He(e.name,n),e.secret=He(e.secret,n))})),e.items=Yt(e.items,a),e.metaData=Qt(e.items)}function ja(e,t){return ka.apply(this,arguments)}function ka(){return(ka=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r=JSON.parse(n);r.key?ln({type:"password",title:"Need a password to decrypt",placeholder:"Enter password here!",text:""}).then((function(n){var i=n.text;if(Be(i)===r.key.passwordHash){var o=He(r.key.encryptedKey,i);Be(o)===r.key.keyHash?(ba(t,r,o),e(t)):a("invalid key")}else a("invalid password")})):(ba(t,r),e(t))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ya(e,t){var n=t?Me()+Me()+Me()+Me():"",a=[];e.items.forEach((function(e){var t=e.id,r=e.theme,i=e.title,o=e.tags,c=e.add_date,s=e.last_modified,u=e.name,l=e.secret,d=e.url,h=e.notes;a.push({id:t,theme:r,title:i,tags:o,add_date:c,last_modified:s,hash:e.hash?st(e.hash):void 0,name:n?Ke(u,n):u,secret:n?Ke(l,n):l,url:d,notes:h})}));var r={items:a};return n&&(r.key={passwordHash:Be(t),keyHash:Be(n),encryptedKey:Ke(n,t,"AES")}),JSON.stringify(r)}function Oa(e){return xa.apply(this,arguments)}function xa(){return(xa=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ln({type:"password",title:"Need a password to encrypt",placeholder:"Enter password here!",text:""}).then((function(e){return ya(t,e.text)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wa=Ve.a.TextArea,Ca=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).item=Ft(e.item),a.state={errorMessage:""},a.onPropsChanged=a.onPropsChanged.bind(Object(d.a)(a)),ce("vaultEditor",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.item;t&&(this.item=Ft(t),this.setState({errorMessage:""}))}},{key:"componentWillUnmount",value:function(){se("vaultEditor")}},{key:"onEvent",value:function(e,t){if("dialogue#cancel"===e)return ue("dlg#editItem#cancelled"),!0;if("dialogue#ok"===e){var n=this.item,a=n.title,r=n.url,i="";return a.trim().length||(i+="Title cannot be empty"),r&&!ie(r)&&(i+="".concat(i.length?", ":"","Invalid URL")),i?(this.setState({errorMessage:i}),!1):(ue("dlg#editItem#OK",this.item),!0)}}},{key:"onPropsChanged",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var a=Object(f.a)(n[t],2),r=a[0],i=a[1];this.item[r]=i}this.setState({errorMessage:""})}},{key:"render",value:function(){var e=this,t=this.item,n=t.tags,r=t.theme,i=t.title,o=t.name,c=t.secret,s=t.url,u=t.notes,l=this.state.errorMessage;return Object(a.jsxs)("div",{children:[l&&Object(a.jsx)(ia.a,{message:l,banner:!0,closable:!0}),Object(a.jsx)("div",{style:{margin:"8px 0"},children:Object(a.jsx)(Rt,{mode:"detail",theme:r,eventHandler:function(t,n){e.onPropsChanged({theme:n.name})}})}),Object(a.jsx)("div",{className:"itemedit-title",children:"Tags"}),Object(a.jsx)(ca,{tags:n}),Object(a.jsx)(Ve.a,{style:{margin:"16px 0 0 0"},value:i,placeholder:"Title",onChange:function(t){return e.onPropsChanged({title:t.target.value})}},"input#title"),Object(a.jsx)(Ve.a,{style:{margin:"16px 0 0 0"},value:o,placeholder:"Name",onChange:function(t){return e.onPropsChanged({name:t.target.value})}},"input#name"),Object(a.jsx)(Ve.a.Password,{style:{margin:"16px 0 0 0"},value:c,placeholder:"Password/credential",onChange:function(t){return e.onPropsChanged({secret:t.target.value})}},"input#password"),Object(a.jsx)(Ve.a,{type:"url",style:{margin:"16px 0 0 0"},value:s,placeholder:"URL",onChange:function(t){return e.onPropsChanged({url:t.target.value})}},"input#url"),Object(a.jsx)(wa,{style:{margin:"16px 0 0 0"},value:u,onChange:function(t){return e.onPropsChanged({notes:t.target.value})},placeholder:"Enter notes here",autoSize:{minRows:5,maxRows:10}})]})}}]),n}(i.a.Component),Ea=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this,"vault","Passwords, secrets, credentials")).features=6,e.icon=Object(a.jsx)(ha.a,{}),e}return Object(l.a)(n,[{key:"creator",value:function(){return Object(ae.a)(Object(ae.a)({},Object(Kn.a)(Object(Hn.a)(n.prototype),"creator",this).call(this)),{},{tags:[],title:"",name:"",secret:"",url:"",notes:""})}},{key:"getProp",value:function(e,t){if("@search"===t){var a;if(!e._tags)e._tags=(null===(a=e.tags)||void 0===a?void 0:a.join(","))||"";return[e.title||"",e._tags,e.notes||""]}return Object(Kn.a)(Object(Hn.a)(n.prototype),"getProp",this).call(this,e,t)}},{key:"render",value:function(e,t,n){return function(e,t,n){var r=e.id,i=e.theme,o=e.title,c=e.url,s=e.name,u=e.secret,l=e.notes,d=Wt(i),h=d.foreColor||"#666",p={};if(d.name||(p.borderBottom="1px solid lightgray"),"detail"===t){var f,v={margin:"4px 0"};return Object(a.jsxs)("div",{className:"item item-card border",style:Object(ae.a)({background:d.bkColor,color:h},p),children:[Object(a.jsxs)("div",{children:[zn(c),Object(a.jsx)("span",{children:o||"(untitled)"})]}),(null===s||void 0===s?void 0:s.length)>0&&Object(a.jsx)("div",{style:v,children:s}),(null===u||void 0===u?void 0:u.length)>0&&Object(a.jsxs)("div",{style:v,children:[Object(a.jsx)("span",{className:"item-highlight",children:u}),u&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{className:"clickable",style:{margin:"0 0 0 8px"},onClick:function(e){e.preventDefault(),e.stopPropagation()},children:Object(a.jsx)(pa.a,{})}),Object(a.jsx)("span",{className:"clickable",style:{margin:"0 0 0 8px"},onClick:function(e){e.preventDefault(),e.stopPropagation(),qe(u),re.a.open({message:"Secret",description:'Copied "'.concat(u,'" to clipboard')})},children:Object(a.jsx)(fa.a,{})})]})]}),(null===c||void 0===c?void 0:c.length)>0&&Object(a.jsx)("div",{style:v,children:Object(a.jsx)("a",{className:"item-title clickable",href:c,target:"_blank",rel:"noopener noreferrer",children:c})}),ma(l||"",h),(null===(f=e.tags)||void 0===f?void 0:f.length)>0&&$t(e,n)]},"item#".concat(r))}return Object(a.jsx)("div",{className:"item item-card",style:Object(ae.a)({background:d.bkColor,color:h},p),children:Object(a.jsxs)("div",{children:[zn(c),Object(a.jsx)("span",{children:o||"(untitled)"})]})},"item#".concat(r))}(e,t,n)}},{key:"editor",value:function(e){return Object(a.jsx)(Ca,Object(ae.a)({},e))}},{key:"importText",value:function(){var e=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ja(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"exportText",value:function(){var e=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oa(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Jt),Sa=n(838),Ia=n(385),Ta=(n(768),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={expanded:!1,truncated:!1},e.handleTruncate=e.handleTruncate.bind(Object(d.a)(e)),e.toggleLines=e.toggleLines.bind(Object(d.a)(e)),e}return Object(l.a)(n,[{key:"handleTruncate",value:function(e){this.state.truncated!==e&&this.setState({truncated:e})}},{key:"toggleLines",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({expanded:!this.state.expanded})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.more,r=e.less,i=e.lines,o=this.state,c=o.expanded,s=o.truncated;return Object(a.jsxs)("div",{children:[Object(a.jsx)(Ia.a,{lines:!c&&i,ellipsis:Object(a.jsxs)("span",{onClick:this.toggleLines,children:["... ",Object(a.jsx)("span",{className:"clickable",children:n})]}),onTruncate:this.handleTruncate,children:t}),!s&&c&&Object(a.jsx)("span",{onClick:this.toggleLines,className:"clickable",style:{margin:"0 0 0 8px"},children:r})]})}}]),n}(r.Component));Ta.defaultProps={lines:3,more:"Read more",less:"Show less"};var Aa=Ta,Da=n(825),_a=n(826),Pa=n(827),Wa=n(828),Ra=n(829),Na=n(830),La=n(831),Ma=n(832),Ua=n(833),Ga=n(834),Ba=n(835),Ka=n(836),Ha=n(837),qa=[{name:"",icon:Ot.a,description:"uniconized",default:!0},{name:"bug",icon:Da.a,description:"bug, issue, problem, trouble"},{name:"todo",icon:_a.a,description:"todo list"},{name:"idea",icon:Pa.a,description:"idea, innovation"},{name:"alert",icon:Wa.a,description:"hack, warning, alert"},{name:"schedule",icon:Ra.a,description:"schedule, plan, vacation"},{name:"log",icon:Na.a,description:"journal, diary, log, backlog"},{name:"life",icon:La.a,description:"life style, leisure"},{name:"wishlist",icon:Ma.a,description:"wish list"},{name:"trophy",icon:Ua.a,description:"trophy, award, prize"},{name:"id",icon:Ga.a,description:"contact, id card"},{name:"favorite",icon:Ba.a,description:"favorite"},{name:"link",icon:Ka.a,description:"link, web page, shortcut"},{name:"read",icon:Ha.a,description:"read, article, book"}],za=ut(qa,16);function Fa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e&&za.has(e)?za.get(e):qa[0]}var Ja=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getMenuItem",value:function(e){var t=this,n=e.name,r=e.description,i=e.icon;return Object(a.jsxs)(At.a.Item,{style:{display:"flex",alignItems:"baseline"},onClick:function(e){var a,r;null===(a=(r=t.props).eventHandler)||void 0===a||a.call(r,"icon#changed",{name:n})},children:[Object(a.jsx)(i,{className:"icon",style:{fontSize:"20px"}}),Object(a.jsx)("span",{style:{marginLeft:"8px"},children:r})]},"menu#".concat(n))}},{key:"getDropdownMenu",value:function(){var e=this;return Object(a.jsx)(At.a,{children:qa.map((function(t){return e.getMenuItem(t)}))})}},{key:"render",value:function(){var e=Fa(this.props.category)||qa[0],t=this.props.mode,n={};"detail"===t&&(n={display:"flex",alignItems:"baseline",width:"100%"}),this.props.style&&(n=Object(ae.a)(Object(ae.a)({},n),this.props.style));var r=e.icon;return Object(a.jsx)(Dt.a,{overlay:this.getDropdownMenu(),placement:"bottomRight",trigger:["click"],className:"icon",children:Object(a.jsxs)("div",{style:n,children:[Object(a.jsx)(r,{className:"icon clickable"}),"detail"===t&&Object(a.jsx)("span",{style:{marginLeft:"8px"},children:e.description})]})})}}]),n}(i.a.Component);var Va=Ve.a.TextArea,Ya=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).item=Ft(e.item),a.state={errorMessage:""},a.onPropsChanged=a.onPropsChanged.bind(Object(d.a)(a)),ce("memoEditor",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.item;t&&(this.item=Ft(t),this.setState({errorMessage:""}))}},{key:"componentWillUnmount",value:function(){se("memoEditor")}},{key:"onPropsChanged",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var a=Object(f.a)(n[t],2),r=a[0],i=a[1];this.item[r]=i}this.setState({errorMessage:""})}},{key:"onEvent",value:function(e,t){if("dialogue#cancel"===e)return ue("dlg#editItem#cancelled"),!0;if("dialogue#ok"===e){var n=this.item,a="";return n.title.trim().length||(a+="Title cannot be empty"),a?(this.setState({errorMessage:a}),!1):(ue("dlg#editItem#OK",n),!0)}}},{key:"render",value:function(){var e=this,t=this.item,n=t.tags,r=t.category,i=t.theme,o=t.title,c=t.content,s=this.state.errorMessage;return Object(a.jsxs)("div",{children:[s&&Object(a.jsx)(ia.a,{message:s,banner:!0,closable:!0}),Object(a.jsxs)("div",{style:{margin:"8px 0",display:"flex"},children:[Object(a.jsx)(Ja,{mode:"detail",category:r,eventHandler:function(t,n){e.onPropsChanged({category:n.name})}}),Object(a.jsx)(Rt,{mode:"detail",theme:i,style:{margin:"0 16px"},eventHandler:function(t,n){e.onPropsChanged({theme:n.name})}})]}),Object(a.jsx)("div",{className:"itemedit-title",children:"Tags"}),Object(a.jsx)(ca,{tags:n}),Object(a.jsx)(Ve.a,{style:{margin:"16px 0 0 0"},value:o,placeholder:"Title",onChange:function(t){return e.onPropsChanged({title:t.target.value})}},"input#title"),Object(a.jsx)(Va,{style:{margin:"16px 0 0 0"},value:c,onChange:function(t){return e.onPropsChanged({content:t.target.value})},placeholder:"Enter text here",autoSize:{minRows:5,maxRows:10}})]})}}]),n}(i.a.Component);function Qa(e,t){var n=t.items||t.memos||[];n.forEach((function(e){var t=e.hash;delete e.hash,t&&Array.isArray(t)&&(e.hash=ct(t))})),e.items=Yt(e.items,n),e.metaData=Qt(e.items)}function Xa(e,t){return Za.apply(this,arguments)}function Za(){return(Za=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a=JSON.parse(n);Qa(t,a),e(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $a(e){return Promise.resolve(function(e){var t=[];return e.items.forEach((function(e){t.push({id:e.id,category:e.category,title:e.title,tags:e.tags,add_date:e.add_date,last_modified:e.last_modified,hash:e.hash?st(e.hash):void 0,theme:e.theme,content:e.content})})),JSON.stringify({items:t})}(e))}var er=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this,"memo","Notes, minutes, journals, memoirs")).features=3,e.icon=Object(a.jsx)(Sa.a,{}),e}return Object(l.a)(n,[{key:"creator",value:function(){return Object(ae.a)(Object(ae.a)({},Object(Kn.a)(Object(Hn.a)(n.prototype),"creator",this).call(this)),{},{title:"",content:"",tags:[]})}},{key:"getProp",value:function(e,t){if("@search"===t){var a;if(!e._tags)e._tags=(null===(a=e.tags)||void 0===a?void 0:a.join(","))||"";return[e.title||"",e._tags,e.content||""]}return Object(Kn.a)(Object(Hn.a)(n.prototype),"getProp",this).call(this,e,t)}},{key:"hasher",value:function(e){return 16===e?za:Object(Kn.a)(Object(Hn.a)(n.prototype),"hasher",this).call(this,e)}},{key:"render",value:function(e,t,n){return function(e,t,n){var r=e.id,i=e.category,o=e.theme,c=e.title,s=e.content,u=Fa(i),l=Wt(o),d=l.foreColor||"#666",h={};l.name||(h.borderBottom="1px solid lightgray");var p,f=u.icon;return"detail"===t?Object(a.jsxs)("div",{className:"item item-card border",style:Object(ae.a)({background:l.bkColor,color:d},h),children:[Object(a.jsxs)("div",{children:[u.name&&Object(a.jsx)(f,{style:{margin:"0 8px 0 0"}}),Object(a.jsx)("span",{children:c||"(untitled)"})]}),Object(a.jsx)("div",{className:"item-content",style:{color:d},children:ma(s||"",d)}),(null===(p=e.tags)||void 0===p?void 0:p.length)>0&&$t(e,n)]},"item#".concat(r)):Object(a.jsxs)("div",{className:"item item-card",style:Object(ae.a)({background:l.bkColor,color:d},h),children:[Object(a.jsxs)("div",{children:[u.name&&Object(a.jsx)(f,{style:{margin:"0 8px 0 0"}}),Object(a.jsx)("span",{children:c||"(untitled)"})]}),Object(a.jsx)("div",{className:"item-content",style:{color:d},children:Object(a.jsx)(Aa,{lines:2,more:"Show more",children:s||""})})]},"item#".concat(r))}(e,t,n)}},{key:"editor",value:function(e){return Object(a.jsx)(Ya,Object(ae.a)({},e))}},{key:"importText",value:function(){var e=Object(b.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xa(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"exportText",value:function(){var e=Object(b.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$a(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Jt),tr=[];function nr(e){for(var t=0;t<tr.length;t++){var n=tr[t];if(e.startsWith(n.name))return n}}function ar(e){for(var t=0;t<tr.length;t++){var n=tr[t];if(e.startsWith(n.name+"."))return!0}return!1}function rr(e,t,n){if(e&&t){var a=zt(t),r=e.findIndex((function(e){return zt(e)===a}));if(-1!==r)return e[r]=t,1;if(n)return e.unshift(t),2}return 0}function ir(e,t){if(e){var n=e.findIndex((function(e){return zt(e)===t}));-1!==n&&e.splice(n,1)}}tr.push(new da),tr.push(new er),tr.push(new Ea);var or=function(){function e(){Object(u.a)(this,e),this.reset()}return Object(l.a)(e,[{key:"reset",value:function(){this.items=[],this.metaData={tags:[],icons:[],themes:[],noTagCount:0,noIconCount:0,noThemeCount:0},this.pinnedItems=[],this.searchedItems=void 0,this.searchedMetaData=void 0,this.dirty=!1}},{key:"load",value:function(e){this.reset(),e&&(this.items=e,this.pinnedItems=this.items.filter((function(e){return en(e)})),this.syncMetaData("all"))}},{key:"updateItem",value:function(e,t){var n=Re();e.add_date||(e.add_date=n),e.last_modified=n;var a=this.items,r=this.searchedItems,i=this.pinnedItems;rr(a,e,t),rr(i,e,!1),rr(r,e,t),this.syncMetaData("all")}},{key:"deleteItems",value:function(e){var t=this.items,n=this.searchedItems,a=this.pinnedItems;e.forEach((function(e){ir(t,e),ir(n,e),ir(a,e)})),this.syncMetaData("all")}},{key:"syncMetaData",value:function(e){"all"===e&&(this.metaData=Qt(this.items)),this.searchedItems&&(this.searchedMetaData=Qt(this.searchedItems))}}]),e}();function cr(e){return{id:e.id,name:e.name,options:e.options}}var sr=function(){function e(t){var n=t.id,a=t.type,r=t.name,i=t.options;Object(u.a)(this,e),this.id=a?"".concat(a,".").concat(n):n,this.name=r,this.descriptor=nr(this.id),this.dataSource=new or,this.options=i||{type:"cloud",showHashtag:!1,showCount:!1,showScale:!1,showAlphabetic:!1},this.loaded=!1,this.query="",this.isSearchCompleted=!0,this.isQuickSearch=!1,this.selectedTag="",this.currentItem={},this.invalidateVisibleData()}return Object(l.a)(e,[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getMetaData",value:function(){return cr(this)}},{key:"setWorkingState",value:function(e){var t=this;Object.entries(e).forEach((function(e){var n=Object(f.a)(e,2),a=n[0],r=n[1];"query"===a&&t.query!==r&&t.invalidateVisibleData(),t[a]=r}))}},{key:"getWorkingState",value:function(){var e=this.name,t=this.loaded,n=this.query,a=this.isSearchCompleted,r=this.isQuickSearch,i=this.selectedTag;return{name:e,loaded:t,query:n,isSearchCompleted:a,isQuickSearch:r,selectedTag:null===i||void 0===i?void 0:i.trim().toLowerCase()}}},{key:"getDescriptor",value:function(){return this.descriptor}},{key:"getDataSource",value:function(){return this.dataSource}},{key:"isEmpty",value:function(){return 0===this.getDataSource().items.length}},{key:"loadData",value:function(e){this.getDataSource().load(e),this.loaded=!0}},{key:"invalidateVisibleData",value:function(){this.visibleData=void 0}},{key:"getVisibleData",value:function(){var e=this.query,t=this.visibleKey,n=this.visibleData;return t===e&&n?n:(this.visibleData=function(e){var t=e.query,n=e.lastItem,a=e.dataSource,r=a.items,i=a.metaData,o=a.pinnedItems,c=a.searchedItems,s=a.searchedMetaData,u=r.length;return"#all"===t?{total:u,items:r,metaData:i,isAllData:!0}:"#notag"===t||"#noicon"===t||"#nocolor"===t?{total:u,items:c||[],metaData:{tags:i.tags,noTagCount:i.noTagCount,icons:(null===s||void 0===s?void 0:s.icons)||[],noIconCount:(null===s||void 0===s?void 0:s.noIconCount)||0,themes:(null===s||void 0===s?void 0:s.themes)||[],noThemeCount:(null===s||void 0===s?void 0:s.noThemeCount)||0},isAllData:!0}:t?(null===c||void 0===c?void 0:c.length)>0?{total:u,items:c,metaData:s,isAllData:!1}:{total:u,items:[],metaData:i,isAllData:!0}:r.length<100?{total:u,items:r,metaData:i,isAllData:!0}:o.length?{total:u,items:n?[].concat(Object(Oe.a)(o),[n]):o,metaData:i,isAllData:!0}:{total:u,items:n?[n]:[],metaData:i,isAllData:!0}}(this),this.visibleKey=e,this.visibleData)}},{key:"getVisibleItemIds",value:function(){return this.getVisibleData().items.map((function(e){return zt(e)}))}},{key:"actionWillPerform",value:function(e,t){var n,a;switch(e){case"item#will-update":case"item#will-update-tag":var r=t.item,i=t.items;i&&i.forEach((function(e){return e._tags=void 0})),r&&(r._tags=void 0)}null===(n=(a=this.getDescriptor()).notifier)||void 0===n||n.call(a,e,t)}},{key:"actionDidPerform",value:function(e,t){this.getDataSource().syncMetaData("all"),this.invalidateVisibleData(),ue(e,t)}},{key:"onBulkDeleteItems",value:function(e){var t=this.getDataSource();this.actionWillPerform("item#will-delete",{dataSource:t,ids:e}),t.deleteItems(e),this.lastItem&&e.includes(this.lastItem.id)&&(this.lastItem=void 0),this.invalidateVisibleData(),t.searchedItems&&t.searchedItems.length||(this.query=""),this.actionDidPerform("item#deleted")}},{key:"onBulkToggleItemHashTag",value:function(e,t){var n=this.getDataSource();this.actionWillPerform("item#will-update-hashtag",{dataSource:n,ids:e,tags:t,action:"toggle"});var a=n.items;e.forEach((function(e){var n,r,i=a.findIndex((function(t){return zt(t)===e}));if(-1!==i){var o=a[i];o.hash=$e(n=o.hash,r=t)?function(e,t){return(e||0)&~t}(n,r):function(e,t){return(e||0)|t}(n,r)}})),this.actionDidPerform("item#updated-hashtag")}},{key:"onBulkAddTags",value:function(){var e=this;(function(){return kn.apply(this,arguments)})().then((function(t){var n=t,a=e.getVisibleData().items;e.actionWillPerform("item#will-update-tag",{dataSource:e.getDataSource(),items:a,tags:n,action:"add"}),a.forEach((function(e){var t=e.tags;n.forEach((function(e){t.includes(e)||t.push(e)}))})),e.actionDidPerform("item#updated-tag")})).catch((function(e){}))}},{key:"onBulkDeleteTags",value:function(){var e,t,n=this;(function(e){return yn.apply(this,arguments)})(null===(e=this.getVisibleData())||void 0===e||null===(t=e.metaData)||void 0===t?void 0:t.tags).then((function(e){var t=e,a=n.getVisibleData().items;n.actionWillPerform("item#will-update-tag",{dataSource:n.getDataSource(),items:a,tags:t,action:"delete"}),a.forEach((function(e){var n=e.tags;t.forEach((function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))})),n.actionDidPerform("item#updated-tag")})).catch((function(e){}))}},{key:"onBulkChangeItemProp",value:function(e,t,n){var a=this.getDataSource();this.actionWillPerform("item#will-update-prop",{dataSource:a,ids:e,propName:t,propValue:n});var r=a.items;e.forEach((function(e){var a=r.findIndex((function(t){return zt(t)===e}));-1!==a&&(r[a][t]=n)})),this.actionDidPerform("item#updated-prop")}},{key:"onUpdateItem",value:function(e){this.onItemUpdated(e,!0),ue("item#added",e)}},{key:"onItemUpdated",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getDataSource();this.actionWillPerform("item#will-update",{dataSource:n,item:e}),n.updateItem(e,t),this.lastItem=e,this.invalidateVisibleData()}},{key:"onAddItem",value:function(){var e=this;this.currentItem=this.getDescriptor().creator(),function(e){return bn.apply(this,arguments)}({title:"Create",item:this.currentItem}).then((function(t){return e.onUpdateItem(t)})).catch((function(e){}))}},{key:"onEditItem",value:function(e){var t=this,n=this.getDataSource().items,a=n.findIndex((function(t){return zt(t)===e}));if(-1!==a){var r=n[a];this.currentItem=Object(ae.a)({},r),function(e){return jn.apply(this,arguments)}({title:"Edit",item:this.currentItem}).then((function(e){return t.onUpdateItem(e)})).catch((function(e){}))}}},{key:"onEvent",value:function(e,t){switch(e){case"cmd#bulk-add-tags":this.onBulkAddTags();break;case"cmd#bulk-delete-tags":this.onBulkDeleteTags();break;case"cmd#bulk-delete-items":this.onBulkDeleteItems(this.getVisibleItemIds());break;case"cmd#bulk-toggle-pinned-items":this.onBulkToggleItemHashTag(this.getVisibleItemIds(),1);break;case"item#cmd:action":var n=t.action,a=t.id,r=t.ids;"edit"===n?this.onEditItem(a):"delete"===n?this.onBulkDeleteItems(r):"toggle-pin"===n?this.onBulkToggleItemHashTag(a,1):"change-prop"===n?this.onBulkChangeItemProp(r,t.propName,t.propValue):y("item: discarded unknown action ".concat(n));break;case"cmd#add-item":this.onAddItem();break;case"item#updated":this.onItemUpdated(t)}}}]),e}(),ur=new(function(){function e(){Object(u.a)(this,e),this.workspaces=[{id:"1",name:"Loading..."}],this.activeWorkspaceIndex=0}return Object(l.a)(e,[{key:"getAllWorkspaces",value:function(){return this.workspaces}},{key:"createWorkspaces",value:function(e){var t=this;this.workspaces=e.map((function(e){var n=new sr(e);return t._resetWorkspace(n),n}))}},{key:"_resetWorkspace",value:function(e){var t,n;e||(e=this.getActiveWorkspace()),null===(t=e)||void 0===t||null===(n=t.dataSource)||void 0===n||n.reset()}},{key:"getActiveWorkspace",value:function(){var e=this.workspaces;(this.activeWorkspaceIndex<0||this.activeWorkspaceIndex>=e.length)&&(this.activeWorkspaceIndex=0);var t=this.workspaces[this.activeWorkspaceIndex];if(!Gn(t))for(var n=0;n<e.length;n++)if(Gn(e[n])){this.activeWorkspaceIndex=n,t=e[n];break}return t}},{key:"_getWorkspaceIndex",value:function(e){return this.workspaces.findIndex((function(t){return t.getId()===e}))}},{key:"getWorkspace",value:function(e){var t=this._getWorkspaceIndex(e);return-1!==t?this.workspaces[t]:void 0}},{key:"setActiveWorkspace",value:function(e){var t=this._getWorkspaceIndex(e);if(-1!==t&&t!==this.activeWorkspaceIndex)return this.activeWorkspaceIndex=t,!0}},{key:"renameActiveWorkspace",value:function(e){var t=this.getActiveWorkspace();t.name=e,ue("workspace#updated",t)}},{key:"_addWorkspace",value:function(e,t){var n=new sr({id:"".concat(t,".").concat(Me()),name:e});return this._resetWorkspace(n),this.workspaces.push(n),n}},{key:"addWorkspace",value:function(e,t){var n=this._addWorkspace(e,t);return ue("workspace#added",n),n}},{key:"removeWorkspace",value:function(e){var t=this.workspaces,n=this._getWorkspaceIndex(e);if(-1!==n){var a=t[n];return t.splice(n,1),a.getDataSource().reset(),ue("workspace#deleted",a),this.autoSelectWorkspace()}}},{key:"bulkRemoveWorkspaces",value:function(e){var t=this,n=this.workspaces;return e.forEach((function(e){var a=t._getWorkspaceIndex(e);if(-1!==a){var r=n[a];n.splice(a,1),r.getDataSource().reset()}})),this.autoSelectWorkspace()}},{key:"ensureAvailableWorkspace",value:function(){if(!this.workspaces.filter((function(e){return Gn(e)})).length){var e=Bn()[0];return y("adding a default workspace ".concat(e)),this._addWorkspace(e,e)}return-1}},{key:"autoSelectWorkspace",value:function(){var e=this.ensureAvailableWorkspace();if(-1===e){e=this.activeWorkspaceIndex;var t=this.workspaces;e=t[e<t.length?e:t-1]}return e}}]),e}()),lr=n(187);function dr(e,t){e.endsWith(".git")&&(e=e.substr(0,e.length-4));var n=e.lastIndexOf("/"),a=e.lastIndexOf("/",n-1),r=e.substr(a+1,n-a-1);return t="".concat(r,":").concat(t),{owner:r,repo:e.substr(n+1),path:e.substr(a+1),token:"Basic ".concat(lr.a.encode(t))}}function hr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=e.owner,r=e.token;if(!a||!r)return Promise.reject("github: bad request");var i=t.startsWith("/")?"":"/";return fetch("https://api.github.com".concat(i).concat(t),Object(ae.a)({method:"GET",headers:{Accept:"application/vnd.github.v3+json",Authorization:r,Host:"api.github.com","User-Agent":a}},n)).then((function(e){return e.json()}))}function pr(e,t){return fr.apply(this,arguments)}function fr(){return(fr=Object(b.a)(g.a.mark((function e(t,n){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=dr(t,n),e.abrupt("return",hr(a,"/repos/".concat(a.path,"/contents")).then((function(e){return e.map((function(e){return{name:e.name,path:e.path,sha:e.sha}}))})).catch((function(e){y(e)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vr(e,t,n){return gr.apply(this,arguments)}function gr(){return(gr=Object(b.a)(g.a.mark((function e(t,n,a){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===a||void 0===a?void 0:a.path){e.next=2;break}return e.abrupt("return",Promise.reject("github: path not specified"));case 2:return r=dr(t,n),e.abrupt("return",hr(r,"/repos/".concat(r.path,"/contents/").concat(a.path)).then((function(e){return y("github: downloaded ".concat(a.path)),lr.a.decode(e.content)})).catch((function(e){return y(e),[]})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mr(e,t,n,a){return br.apply(this,arguments)}function br(){return(br=Object(b.a)(g.a.mark((function e(t,n,a,r){var i,o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",Promise.reject("github: path not specified"));case 2:return i=dr(t,n),"string"===typeof a?o=a:(o=a.path,c=a.sha),"string"!==typeof r&&(r=JSON.stringify(r)),r=lr.a.encode(r),e.abrupt("return",hr(i,"/repos/".concat(i.path,"/contents/").concat(o),{method:"PUT",body:JSON.stringify({message:"".concat(c?"updated":"added"," "),content:r,sha:c})}).then((function(e){var t=e.content;return y("github: ".concat(c?"updated":"created"," ").concat(o)),{path:o,sha:t.sha}})).catch((function(e){y(e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jr(e,t,n){return kr.apply(this,arguments)}function kr(){return(kr=Object(b.a)(g.a.mark((function e(t,n,a){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===a||void 0===a?void 0:a.path){e.next=2;break}return e.abrupt("return",Promise.reject("github: path not specified"));case 2:return r=dr(t,n),e.abrupt("return",hr(r,"/repos/".concat(r.path,"/contents/").concat(a.path),{method:"DELETE",body:JSON.stringify({message:"delete",sha:a.sha})}).then((function(e){return y("github: deleted ".concat(a.path)),!0})).catch((function(e){return y(e),!1})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yr(e,t){var n=$("lastSyncTime")||0,a={localAdded:0,localDeleted:0,localUpdated:0,remoteAdded:0,remoteDeleted:0,remoteUpdated:0};return e.forEach((function(e){return e.sync=""})),t.forEach((function(t){t.sync="";var r=function(e,t,n){var a={localAdded:0,localDeleted:0,localUpdated:0,remoteAdded:0,remoteDeleted:0,remoteUpdated:0},r=n.items;if(!(null===r||void 0===r?void 0:r.length))return n.sync="discarded",a;var i=function(e){var t=e.lastUpdated;if(!t){var n=e.items;t=0,n.forEach((function(e){var n=e.last_modified;t?n>t&&(t=n):t=n}))}return t}(n),o=t.find((function(e){return e.getId()===n.id}));if(!o){if(i<e)return y("sync: discarded ".concat(n.id," - already deleted locally")),n.sync="discarded",a.remoteDeleted=r.length,a;var c=new sr(cr(n));return c.loadData(r),t.push(c),y("sync: added ".concat(n.id)),c.sync="added",a.localAdded=r.length,a}var s=o.getDataSource().items;r.forEach((function(t){var n=s.findIndex((function(e){return e.id===t.id}));if(-1===n){if(t.last_modified<e)return void a.remoteDelete++;s.push(t),a.localAdded++}else{var r=s[n];r.last_modified<t.last_modified?(s[n]=Ft(t),a.localUpdated++):r.last_modified>t.last_modified&&a.remoteUpdated++}}));for(var u=function(t){var n=s[t];-1===r.findIndex((function(e){return e.id===n.id}))&&(n.last_modified<e?(s.splice(t,1),a.localDeleted++):(n.last_modified=Re(),a.localUpdated++,a.remoteAdded++))},l=s.length-1;l>=0;l--)u(l);var d=a.localAdded,h=a.localDeleted,p=a.localUpdated,f=a.remoteAdded,v=a.remoteDeleted,g=a.remoteUpdated;return(d||h||p)&&(o.sync="updated"),(f||v||g)&&(n.sync="updated"),a}(n,e,t);Object.keys(a).forEach((function(e){return a[e]+=r[e]}))})),e.forEach((function(e){"updated"===e.sync&&e.getDataSource().syncMetaData("all")})),ee("lastSyncTime",Re()),a}function Or(){return(Or=Object(b.a)(g.a.mark((function e(t,n,a){var r,i,o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],i=[],c={created:[],deleted:[],updated:[]},e.abrupt("return",pr(n,a).then((function(e){return r=e.filter((function(e){return ar(e.name)})),Promise.all(r.map((function(e){return vr(n,a,e)})))})).then((function(e){return e.forEach((function(e){try{var t=JSON.parse(e);i.push(t)}catch(n){return y("sync/github: caught an exception"),Promise.reject(n)}})),yr(t,i)})).then((function(e){o=e;var n=new Map;r.forEach((function(e){n.set(e.path,e)})),i.forEach((function(e){var t=e.id,a=e.sync;if("discarded"===a||"updated"===a){var r=n.get(t);r.decision="discarded"===a?"delete":"update",n.set(t,r)}})),t.forEach((function(e){var t=e.getId(),a=e.sync;if(n.has(t)){var r=n.get(t);a&&"added"!==a&&(r.decision="update",n.set(t,r))}else e.isEmpty()||n.set(t,{path:t,decision:"create"})})),n.forEach((function(e){"delete"===e.decision?c.deleted.push(e):"update"===e.decision?c.updated.push(e):"create"===e.decision&&c.created.push(e)}))})).then((function(e){return Promise.all(c.deleted.map((function(e){return jr(n,a,e)})))})).then((function(e){return Promise.all([].concat(Object(Oe.a)(c.updated),Object(Oe.a)(c.created)).map((function(e){var r=e.path,i=t.find((function(e){return e.getId()===r})),o=Object(ae.a)(Object(ae.a)({},cr(i)),{},{lastUpdated:Re(),items:i.getDataSource().items});return mr(n,a,e.sha?e:r,o)})))})).then((function(e){return o})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xr=n(788),wr=n(386),Cr=n.n(wr),Er=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={visible:!0,disabled:!0,bounds:{left:0,top:0,bottom:0,right:0}},a.draggleRef=i.a.createRef(),a.onButtonClicked=a.onButtonClicked.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"onButtonClicked",value:function(e){if(!ue(e))return!0;this.setState({visible:!1})}},{key:"onStart",value:function(e,t){var n,a,r,i,o=null===(n=window)||void 0===n||null===(a=n.document)||void 0===a?void 0:a.documentElement,c=o.clientWidth,s=o.clientHeight,u=null===(r=this.draggleRef)||void 0===r||null===(i=r.current)||void 0===i?void 0:i.getBoundingClientRect();this.setState({bounds:{left:-(null===u||void 0===u?void 0:u.left)+(null===t||void 0===t?void 0:t.x),right:c-((null===u||void 0===u?void 0:u.right)-(null===t||void 0===t?void 0:t.x)),top:-(null===u||void 0===u?void 0:u.top)+(null===t||void 0===t?void 0:t.y),bottom:s-((null===u||void 0===u?void 0:u.bottom)-(null===t||void 0===t?void 0:t.y))}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.bounds,r=t.disabled,i=t.visible,o=this.props,c=o.title,s=o.children,u=o.cancelButtonProps,l=void 0===u?{}:u,d=o.okButtonProps,h=void 0===d?{}:d;return Object(a.jsx)(xr.a,{title:Object(a.jsx)("div",{style:{width:"100%",cursor:"move"},onMouseOver:function(){r&&e.setState({disabled:!1})},onMouseOut:function(){e.setState({disabled:!0})},onFocus:function(){},onBlur:function(){},children:c}),visible:i,closable:!1,bodyStyle:{padding:"4px 24px 16px 24px"},okButtonProps:h,cancelButtonProps:l,onOk:function(){return e.onButtonClicked("dialogue#ok")},onCancel:function(){return e.onButtonClicked("dialogue#cancel")},modalRender:function(t){return Object(a.jsx)(Cr.a,{disabled:r,bounds:n,onStart:function(t,n){return e.onStart(t,n)},children:Object(a.jsx)("div",{ref:e.draggleRef,children:t})})},children:s})}}]),n}(i.a.Component),Sr=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.context,t=e.title,n=e.text;return Object(a.jsx)(xr.a,{title:t,visible:!0,closable:!1,onOk:function(e){return ue("dlg#confirm#OK")},onCancel:function(e){return ue("dlg#confirm#cancelled")},children:n})}}]),n}(i.a.Component),Ir=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleOk=function(e){var t=a.state.text;t?ue("dlg#getText#OK",{text:t}):ue("dlg#getText#cancelled")},a.handleCancel=function(e){ue("dlg#getText#cancelled")},a.handleChange=function(e){a.setState({text:e.target.value})},a.handleKeyDown=function(e){13===e.keyCode&&ue("dlg#getText#OK",{text:a.state.value})},a.state={text:a.props.context.text||""},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.context,t=e.type,n=e.title,r=e.text,i=e.placeholder;return Object(a.jsxs)(xr.a,{title:n,visible:!0,closable:!1,onOk:this.handleOk,onCancel:this.handleCancel,children:["password"===t&&Object(a.jsx)(Ve.a.Password,{defaultValue:r,placeholder:i||"Enter password here!",autoFocus:!0,onChange:this.handleChange,onKeyDown:this.handleKeyDown},"input#password"),"password"!==t&&Object(a.jsx)(Ve.a,{defaultValue:r,placeholder:i||"Enter value here!",autoFocus:!0,onChange:this.handleChange,onKeyDown:this.handleKeyDown},"input#text")]})}}]),n}(i.a.Component),Tr=n(787),Ar=Tr.a.Option,Dr=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(u.a)(this,n),a=t.call(this,e);var r="*"===e.types?["memo"]:e.types.split(",");return a.state={allTypes:r,selectedType:r[0]},a}return Object(l.a)(n,[{key:"renderWorkspaceTypes",value:function(){var e=this,t=this.state.allTypes;return 1===t.length?"":Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{style:{margin:"16px 0 0 0"},children:"Workspace Type"}),Object(a.jsx)(Tr.a,{defaultValue:"memo",placeholder:"Select workspace type",onChange:function(t){return e.setState({selectedType:t})},children:t.map((function(e){return Object(a.jsx)(Ar,{value:e,children:nr(e).description})}))})]})}},{key:"render",value:function(){var e=this;return Object(a.jsxs)(xr.a,{title:"Create a workspace",visible:!0,closable:!1,onOk:function(){var t=e.state,n=t.name,a=t.selectedType;n&&ue("dlg#getWorkspace#OK",{name:n,type:a})},onCancel:function(){return ue("dlg#getWorkspace#cancelled")},children:[Object(a.jsx)("div",{children:"Workspace Name"}),Object(a.jsx)(Ve.a,{defaultValue:this.state.name,placeholder:"Enter workspace name here!",autoFocus:!0,onChange:function(t){return e.setState({name:t.target.value})}},"input#name"),this.renderWorkspaceTypes()]})}}]),n}(i.a.Component),_r=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).tags=[],ce("addTags",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){se("addTags")}},{key:"onEvent",value:function(e,t){return"dialogue#cancel"===e?(ue("dlg#addTags#cancelled"),!0):"dialogue#ok"===e?(ue("dlg#addTags#OK",this.tags),!0):void 0}},{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{marginBottom:"16px"},children:"Enter tags to add"}),Object(a.jsx)(ca,{tags:this.tags,buttonTitle:"Add Tag"})]})}}]),n}(i.a.Component),Pr=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).tags=e.tags,a.state={selectedTags:[]},ce("deleteTags",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){se("deleteTags")}},{key:"onEvent",value:function(e,t){return"dialogue#cancel"===e?(ue("dlg#deleteTags#cancelled"),!0):"dialogue#ok"===e?(ue("dlg#deleteTags#OK",this.state.selectedTags),!0):void 0}},{key:"onTagSelected",value:function(e){var t=this.state.selectedTags;-1!==t.indexOf(e)?this.setState({selectedTags:t.filter((function(t){return t!==e}))}):this.setState({selectedTags:[].concat(Object(Oe.a)(t),[e])})}},{key:"render",value:function(){var e=this,t=this.tags,n=this.state.selectedTags;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{marginBottom:"16px"},children:"Select tags to remove"}),Object(a.jsx)("div",{style:{lineHeight:2},children:t.map((function(t){var r=t.name;return Object(a.jsx)(oa.a,{color:n.indexOf(r)>-1?"red":"",onClick:function(){return e.onTagSelected(r)},children:r},r)}))})]})}}]),n}(i.a.Component),Wr="awesome",Rr=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).id="".concat(Wr,".").concat(Me()),y("".concat(n.id,": created")),n.state={dummy:!1,mode:"default",evtObj:void 0},n.items=[],n.tags=[],n.workspaceManager=ur,n.onCloseDrawer=n.onCloseDrawer.bind(Object(d.a)(n)),n.onEvent=n.onEvent.bind(Object(d.a)(n)),n.onChangeWorkspace=n.onChangeWorkspace.bind(Object(d.a)(n)),n.onEditWorkspace=n.onEditWorkspace.bind(Object(d.a)(n)),n.onClickWorkspace=n.onClickWorkspace.bind(Object(d.a)(n)),n.onImport=n.onImport.bind(Object(d.a)(n)),n.onExport=n.onExport.bind(Object(d.a)(n)),ce("".concat(Wr,"-").concat(n.id),n.onEvent.bind(Object(d.a)(n))),ye("//".concat(Wr," Page")),n}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this;F("".concat(Wr,"#spaces")).then((function(t){return e.loadWorkspaceMetaData(t)})).catch((function(t){y("workspace: nothing loaded, now create an empty workspace"),e.loadWorkspaceMetaData([])}))}},{key:"componentWillUnmount",value:function(){se("".concat(Wr,"-").concat(this.id))}},{key:"getWorkspace",value:function(){return this.workspaceManager.getActiveWorkspace()}},{key:"getAllWorkspaces",value:function(){return this.workspaceManager.getAllWorkspaces()}},{key:"getDescriptor",value:function(){return this.getWorkspace().descriptor}},{key:"getDataSource",value:function(){return this.getWorkspace().dataSource}},{key:"getPersistItemName",value:function(e){var t=e.indexOf(".");return-1!==t&&(e=e.substr(t+1)),"".concat(Wr,"#data#").concat(e)}},{key:"invalidateUI",value:function(){this.forceUpdate()}},{key:"onLoadedWorkspaceData",value:function(e,t){e.loadData(null===t||void 0===t?void 0:t.items),y("".concat(this.id,": loaded ").concat(e.getId())),ue("workspace#ready"),this.invalidateUI()}},{key:"loadWorkspaceData",value:function(e){var t=this;if(!e.getWorkingState().loaded)return e.setWorkingState({loaded:!1}),F(this.getPersistItemName(e.getId())).then((function(n){return t.onLoadedWorkspaceData(e,n)})).catch((function(n){return t.onLoadedWorkspaceData(e,{items:[]})}));ue("workspace#ready")}},{key:"saveWorkspaceData",value:function(e){var t=null===e||void 0===e?void 0:e.getDataSource();if(t){var n=t.items;J(this.getPersistItemName(e.getId()),{items:n}),t.dirty=!1,y("".concat(this.id,": saved ").concat(e.getId()))}}},{key:"removeWorkspaceData",value:function(e){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U;if(M())return new Promise((function(t){window.chrome.storage.local.remove([e],(function(){y('storage: removed "'.concat(e,'" from extension')),t()}))}));"indexedDB"===(t=z(t))?W(e):q(t,e)}(this.getPersistItemName(e.getId())),y("".concat(this.id,": removed ").concat(e.getId()))}},{key:"bulkLoadWorkspaceData",value:function(){var e=this,t=this.getAllWorkspaces(),n=t.filter((function(e){return!e.getWorkingState().loaded}));return n.length?Promise.all(n.map((function(t){return F(e.getPersistItemName(t.getId()))}))).then((function(e){for(var a=0;a<n.length;a++){var r;n[a].loadData(null===(r=e[a])||void 0===r?void 0:r.items)}return t})):Promise.resolve(t)}},{key:"bulkSaveWorkspaceData",value:function(e){var t=this,n=this.getAllWorkspaces();null===e||void 0===e||e.forEach((function(e){t.saveWorkspaceData(n.find((function(t){return t.id===e})))}))}},{key:"bulkRemoveWorkspaceData",value:function(e){var t=this,n=this.getAllWorkspaces();null===e||void 0===e||e.forEach((function(e){t.removeWorkspace(n.find((function(t){return t.id===e})))}))}},{key:"loadWorkspaceMetaData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!1;(e=e.filter((function(e){return!(!e.id||!e.name)})))&&e.length||(t=!0,e=Bn().map((function(e){return{id:"".concat(e,".").concat(Me()),name:e}}))),this.workspaceManager.createWorkspaces(e),this.loadWorkspaceData(this.getWorkspace()),y("".concat(this.id,": ").concat(t?"created":"loaded"," ").concat(e.map((function(e){return e.id})).join(",")," workspace(s) metadata")),(-1!==this.workspaceManager.ensureAvailableWorkspace()||t)&&this.saveWorkspaceMetaData()}},{key:"saveWorkspaceMetaData",value:function(){var e=this.getAllWorkspaces(),t=e.map((function(e){return e.getMetaData()}));J("".concat(Wr,"#spaces"),t),y("".concat(this.id,": saved ").concat(e.map((function(e){return e.id})).join(",")," workspace(s) metadata"))}},{key:"removeWorkspace",value:function(e){var t=this.workspaceManager.removeWorkspace(e);t?(this.workspaceManager.setActiveWorkspace(t.getId()),ue("workspace#changed")):ue("req@toast",{title:"Workspace",message:"Unable to remove the workspace"})}},{key:"onCloseDrawer",value:function(){this.setState({mode:"default"})}},{key:"onChangeWorkspace",value:function(e){this.workspaceManager.setActiveWorkspace(e)&&(this.onCloseDrawer(),ue("workspace#changed"))}},{key:"onAddWorkspace",value:function(){var e=this;(function(){return fn.apply(this,arguments)})().then((function(t){var n=t.name,a=t.type,r=e.workspaceManager.addWorkspace(n,a);e.workspaceManager.setActiveWorkspace(null===r||void 0===r?void 0:r.id)&&ue("workspace#changed")})).catch((function(e){}))}},{key:"onConfirmAndRenameWorkspace",value:function(){var e=this;ln({title:"Rename workspace",placeholder:"Enter workspace name here!",text:this.getWorkspace().getName()}).then((function(t){e.workspaceManager.renameActiveWorkspace(t.text)}))}},{key:"onConfirmAndDeleteWorkspace",value:function(){hn({title:"Remove workspace",text:'Are you sure to delete workspace "'.concat(this.getWorkspace().getName(),'" , all data will be lost')}).then((function(e){ue("workspace#remove")})).catch((function(e){}))}},{key:"onClickWorkspace",value:function(e){this.getWorkspace().getId()===e&&this.onConfirmAndRenameWorkspace()}},{key:"onEditWorkspace",value:function(e,t){"add"===t?this.onAddWorkspace():"remove"===t&&this.onConfirmAndDeleteWorkspace()}},{key:"onConfirmAndDeleteItems",value:function(){var e=this.getWorkspace().getVisibleData().items;hn({title:"Remove items",text:"Are you sure to delete ".concat(e.length," items")}).then((function(e){return ue("cmd#bulk-delete-items")})).catch((function(e){}))}},{key:"importImpl",value:function(e,t){var n=this;if(e){var a=this.getWorkspace();return t&&(e=He(e,t)),a.getDescriptor().importText(a.getDataSource(),e).then((function(e){n.saveWorkspaceData(a),a.invalidateVisibleData(),n.invalidateUI()})).catch((function(e){var t,n;re.a.open({message:"Import",description:"".concat(JSON.stringify((null===(t=e.err)||void 0===t?void 0:t.message)||e.message||(null===(n=e.err)||void 0===n?void 0:n.stack)||e.stack||"Failed to import, possibly incorrect format file"))})}))}}},{key:"onImport",value:function(){var e=this;(function(){return vn.apply(this,arguments)})().then((function(t){var n=t.type,a=t.password,r=t.file,i=t.ipfsCid;"file"===n&&r?function(e){return Ae.apply(this,arguments)}(r).then((function(t){return e.importImpl(t,a)})):"ipfs"===n&&i&&function(e){return Te.apply(this,arguments)}(i).then((function(t){return e.importImpl(t,a)}))})).catch((function(e){}))}},{key:"onExport",value:function(){var e=this;(function(){return gn.apply(this,arguments)})().then((function(t){var a=t.type,r=t.password,i=(t.email,e.getWorkspace());i.getDescriptor().exportText(i.getDataSource()).then((function(t){if(r&&(t=Ke(t,r)),"file"===a){var i=n(775),o=new Blob([t],{type:"application/json;charset=utf-8"});i.saveAs(o,"".concat(e.getWorkspace().name,".json"))}else"ipfs"===a&&function(e){return Se.apply(this,arguments)}(t).then((function(e){qe(e),re.a.open({message:"Export",description:"Saved to IPFS: ".concat(e,", also copied the cid to clipboard")})}))}))})).catch((function(e){}))}},{key:"syncGithub",value:function(e,t){var n,r,i=this,o={added:[],deleted:[],updated:[]};this.bulkLoadWorkspaceData().then((function(e){return n=e})).then((function(a){return function(e,t,n){return Or.apply(this,arguments)}(n,e,t)})).then((function(e){r=e,n.forEach((function(e){var t=e.id,n=e.sync;"added"===n?o.added.push(t):"updated"===n&&o.updated.push(t)}))})).then((function(e){return i.bulkSaveWorkspaceData([].concat(Object(Oe.a)(o.updated),Object(Oe.a)(o.added)))})).then((function(e){o.added.length&&i.saveWorkspaceMetaData()})).then((function(t){var n=r,o=n.localAdded,c=n.localDeleted,s=n.localUpdated,u=n.remoteAdded,l=n.remoteDeleted,d=n.remoteUpdated;re.a.open({message:"Sync",description:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Synced ".concat(e)}),Object(a.jsx)("div",{children:"local: added ".concat(o,", deleted ").concat(c,", updated ").concat(s)}),Object(a.jsx)("div",{children:"remote: created ".concat(u,", deleted ").concat(l,", updated ").concat(d)})]})}),i.invalidateUI()})).catch((function(e){re.a.open({message:"Sync",description:Object(a.jsx)("div",{children:"Please try it later, caught an error ".concat(e)})})}))}},{key:"onSync",value:function(){var e=this;(function(e){return mn.apply(this,arguments)})({githubrepo:$("githubrepo"),githubtoken:$("githubtoken")}).then((function(t){var n=t.type,a=t.url,r=t.token;"github"===n&&a&&r&&(!function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n=Object.entries(e);t<n.length;t++){var a=Object(f.a)(n[t],2);ee(a[0],a[1])}}({githubrepo:a,githubtoken:r}),e.syncGithub(a,r))})).catch((function(e){}))}},{key:"onEvent",value:function(e,t){var n=this.getWorkspace();switch(y("".concat(this.id,"-").concat(n.id,": ").concat(e)),(e.endsWith("#cancelled")||e.endsWith("#OK"))&&this.onCloseDrawer(),e){case"dlg#confirm":case"dlg#getText":case"dlg#getWorkspace":case"dlg#import":case"dlg#export":case"dlg#sync":case"dlg#editItem":case"dlg#addTags":case"dlg#deleteTags":this.setState({mode:e,evtObj:t});break;case"cmd#import":this.onImport();break;case"cmd#export":this.onExport();break;case"cmd#sync":this.onSync();break;case"cmd#add-workspace":this.onAddWorkspace();break;case"cmd#confirm-and-edit-workspace":this.onConfirmAndRenameWorkspace();break;case"cmd#confirm-and-delete-workspace":this.onConfirmAndDeleteWorkspace();break;case"workspace#remove":this.removeWorkspace(null===n||void 0===n?void 0:n.id);break;case"workspace#changed":this.loadWorkspaceData(n);break;case"workspace#added":this.saveWorkspaceData(n);break;case"workspace#updated":break;case"workspace#deleted":this.removeWorkspaceData(t);break;case"cmd#confirm-and-delete-items":this.onConfirmAndDeleteItems();break;case"item#added":case"item#updated":case"item#deleted":case"item#updated-hashtag":case"item#updated-tag":case"item#updated-prop":this.saveWorkspaceData(n),this.invalidateUI();break;case"cmd#toggle-tag-sort":n.options.showAlphabetic=!n.options.showAlphabetic,this.saveWorkspaceMetaData(),this.invalidateUI();break;case"cmd#toggle-tag-count":n.options.showCount=!n.options.showCount,this.saveWorkspaceMetaData(),this.invalidateUI();break;case"cmd#toggle-tag-scale":n.options.showScale=!n.options.showScale,this.saveWorkspaceMetaData(),this.invalidateUI()}switch(e){case"workspace#added":case"workspace#updated":case"workspace#deleted":this.saveWorkspaceMetaData(),this.invalidateUI();break;case"workspace#ready":this.invalidateUI()}}},{key:"renderDrawers",value:function(){var e=this.getDescriptor(),t=this.state,n=t.mode,r=t.evtObj;switch(n){case"dlg#confirm":return Object(a.jsx)(Sr,{context:r});case"dlg#getText":return Object(a.jsx)(Ir,{context:r});case"dlg#getWorkspace":return Object(a.jsx)(Dr,{types:ne.WORKSPACE_STRATEGY});case"dlg#import":return Object(a.jsx)(Er,{title:"Import",okButtonProps:{style:{display:"none"}},children:e.drawer("import",r)});case"dlg#export":return Object(a.jsx)(Er,{title:"Export",okButtonProps:{style:{display:"none"}},children:e.drawer("export",r)});case"dlg#sync":return Object(a.jsx)(Er,{title:"Sync",okButtonProps:{style:{display:"none"}},children:e.drawer("sync",r)});case"dlg#editItem":return Object(a.jsx)(Er,{title:null===r||void 0===r?void 0:r.title,children:e.editor(r)});case"dlg#addTags":return Object(a.jsx)(Er,{title:"Add Tags",children:Object(a.jsx)(_r,{})});case"dlg#deleteTags":return Object(a.jsx)(Er,{title:"Remove Tags",children:Object(a.jsx)(Pr,{tags:r})})}return""}},{key:"renderFAB",value:function(){return Object(a.jsx)(xe.a,{type:"primary",shape:"circle",size:"large",style:{position:"fixed",bottom:"48px",right:"16px",outline:"none",border:"none",background:"greenyellow",color:"black"},onClick:function(){ue("cmd#add-item")},children:Object(a.jsx)(Ce.a,{style:{position:"relative",top:"-4px"}})})}},{key:"renderTabs",value:function(e){var t=this.getAllWorkspaces(),n=this.getWorkspace();return Object(a.jsx)(we.a,{activeKey:n.id,type:e,onChange:this.onChangeWorkspace,onEdit:this.onEditWorkspace,onTabClick:this.onClickWorkspace,style:{margin:"4px 8px -16px 8px"},children:t.filter((function(e){return Gn(e)})).map((function(e,t){var n;return Object(a.jsx)(we.a.TabPane,{tab:Object(a.jsxs)("span",{style:{display:"flex",alignItems:"baseline"},children:[(null===(n=e.descriptor)||void 0===n?void 0:n.icon)||"",Pe(e.name,35)]}),closable:!0},e.id)}))})}},{key:"render",value:function(){return void 0===this.getDescriptor()?Object(a.jsx)("div",{className:"no-select",children:this.renderTabs()}):Object(a.jsxs)("div",{className:"no-select",children:[this.renderTabs("editable-card"),Object(a.jsx)(Un,Object(ae.a)({workspace:this.getWorkspace()},this.props)),this.renderDrawers(),this.renderFAB()]})}}]),r}(i.a.Component),Nr=Rr,Lr=[{path:"/",component:Rr}];function Mr(e){var t,n,a=e,r=Object(j.a)(Lr);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.path===e){t=i.component;break}e.startsWith(i.path)&&a.length<i.path&&(a=i.path,t=i.component)}}catch(o){r.e(o)}finally{r.f()}return t||Nr}var Ur=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=Mr(this.props.route);return Object(a.jsx)(e,Object(ae.a)(Object(ae.a)({},this.props),{},{referred:Nr===Rr}))}}]),n}(i.a.Component),Gr=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),a=t.call(this,e),y("app: starting..."),a.state={},a.backButtonPressedTime=new Date,a.finishApp=!1,window.addEventListener("beforeunload",a.onBeforeUnload.bind(Object(d.a)(a))),ce("app",a.onEvent.bind(Object(d.a)(a))),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.onDeserialize(),function(){var e,t;return!!(null===(e=window.Android)||void 0===e?void 0:e.eventHandler)||!!(null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers)}()||ke()}},{key:"componentWillUnmount",value:function(){se("app")}},{key:"onSerialize",value:function(){y("app: serialize")}},{key:"onDeserialize",value:function(){y("app: deserialize")}},{key:"onBeforeUnload",value:function(){this.onSerialize()}},{key:"onEvent",value:function(e,t){if(e.startsWith("route:")){var n=e.substr(6);return window.history.replaceState&&window.history.replaceState("",window.location.title,n),void this.setState({route:n})}switch(e){case"notify@refresh":case"notify@nav-back":case"resp@get-pref":this.forceUpdate();break;case"resp@get-env":t&&(ne.DEVICE_TYPE=3,this.forceUpdate());break;case"notify@state":if(!t)break;if(t.network&&(fe("connected"===t.network),this.forceUpdate()),"loaded"===t.web&&(ne.DEVICE_TYPE=3,Z([t]),he("req@get-env"),he("req@get-pref"),ke()),"pressed"===t.backButton){if(te()){var a=new Date;if(a.getTime()-this.backButtonPressedTime.getTime()<2e3&&this.finishApp){he("req@kill-app");break}this.finishApp=!0,he("req@toast",{msg:ge("Please tap BACK again to exit")}),this.backButtonPressedTime=a}ue("notify@nav-back")}}}},{key:"render",value:function(){return Object(a.jsx)(Ur,{route:this.state.route||window.location.pathname,location:window.location})}}]),n}(i.a.Component);c.a.render(Object(a.jsx)(s.a,{children:Object(a.jsx)(Gr,{})}),document.getElementById("root"))}},[[782,1,2]]]);
//# sourceMappingURL=main.d29d5d11.chunk.js.map