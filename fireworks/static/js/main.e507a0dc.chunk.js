(this["webpackJsonpastonishing-fireworks"]=this["webpackJsonpastonishing-fireworks"]||[]).push([[0],{173:function(t,e,i){t.exports=i(301)},178:function(t,e,i){},301:function(t,e,i){"use strict";i.r(e);var a=i(0),n=i.n(a),r=i(7),o=i.n(r),s=(i(98),i(178),i(179),i(57)),h=[];function c(t,e){console.log('event: "'.concat(t,'" subscribed')),h.push({name:t,handler:e})}function l(t,e){var i=h.filter((function(i){return!(i.name===t&&i.handler===e)}));i.length!==h.length?(console.log('event: "'.concat(t,'" unsubscribed')),h=i):console.log('event: failed to unsubscribe "'.concat(t,'"'))}function u(t,e){var i,a=Object(s.a)(h);try{for(a.s();!(i=a.n()).done;){i.value.handler(t,e)}}catch(n){a.e(n)}finally{a.f()}}var f=i(2),d=i(3),p=i(22),g=i(68),v=i(67),m=i(303),y=i(307),k=i(308),w=i(309),b=i(312),x=i(313),M=i(314),C=i(315),S=i(316),I=i(143);function O(t){return t<9?"0".concat(t):t}function E(t){return t<99?t<9?"00".concat(t):"0".concat(t):t}var L=i(117),D=i.n(L),V=i(144);var j={effectIndex:0,options:{},optionOpended:!1,pieces:[]},T=!1;function P(){return(P=Object(V.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!T){t.next=2;break}return t.abrupt("return");case 2:T=!0;case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function F(){var t={optionOpended:j.optionOpended,effectIndex:j.effectIndex,options:j.options};""!==JSON.stringify(t)&&function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"localStorage";if(void 0!==e&&null!==e&&i in window){var a=JSON.stringify(e);console.log("storage<- ".concat(t,": ").concat(a.substr(0,64),"...")),window[i].setItem(t,a)}}("firework#pref",t)}function R(){var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"localStorage";if(e in window){var i=window[e].getItem(t);if(i)return console.log("storage->".concat(t,": ").concat(i.substr(0,64),"...")),JSON.parse(i)}}("firework#pref");j.optionOpended=!1,j.effectIndex=(null===t||void 0===t?void 0:t.effectIndex)||0,j.options=(null===t||void 0===t?void 0:t.options)||{}}var W=j,A=i(33),z=i(306),N=i(302),Y=i(310),X=i(304),B=i(311),q=i(85),G={toDeg:180/Math.PI,toRad:Math.PI/180,halfPI:Math.PI/2,twoPI:2*Math.PI,dist:function(t,e){return Math.sqrt(t*t+e*e)},pointDist:function(t,e,i,a){var n=i-t,r=a-e;return Math.sqrt(n*n+r*r)},angle:function(t,e){return G.halfPI+Math.atan2(e,t)},pointAngle:function(t,e,i,a){return G.halfPI+Math.atan2(a-e,i-t)},splitVector:function(t,e){return{x:Math.sin(e)*t,y:-Math.cos(e)*t}},random:function(t,e){return Math.random()*(e-t)+t},randomInt:function(t,e){return(Math.random()*(e-t)|0)+t},randomChoice:function(t){if(Array.isArray(t))return t[Math.random()*t.length|0]},clamp:function(t,e,i){return Math.min(Math.max(t,e),i)}},_=G;function U(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}var H=function(){function t(e){Object(f.a)(this,t),this.props=e}return Object(d.a)(t,[{key:"init",value:function(t){}},{key:"draw",value:function(t){var e=t.ctx,i=t.width,a=t.height;e.globalCompositeOperation="destination-out",e.fillStyle=this.props.fillStyle,e.fillRect(0,0,i,a)}}]),t}();var J,K,$,Q,Z=i(4),tt=[],et=[];var it=function(){function t(e){Object(f.a)(this,t),this.options=e,$=void 0,Q=void 0}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t}},{key:"add",value:function(t,e,i){this.options=Object(Z.a)(Object(Z.a)({},this.options),i);var a=this.context.width*this.context.dpr,n=this.context.height*this.context.dpr;void 0===t&&(t=_.randomInt(0,a)),void 0===e&&(e=_.randomInt(0,n)),function(t,e,i,a){t<<=0;for(var n=(e<<=0)-3;n<e+3;n++)for(var r=t-3;r<t+3;r++)tt[J+n*i+r]+=512}(t,e,a)}},{key:"draw",value:function(t,e){var i=this.context,a=i.ctx,n=i.dpr,r=~~(this.context.width*n),o=~~(this.context.height*n);if($!==e){Q=new ImageData(new Uint8ClampedArray(e.data),r,o),$=e,J=r,K=r*(o+3);for(var s=r*(o+2)*2,h=0;h<s;h++)et[h]=tt[h]=0}!function(t,e){var i=J;J=K,K=i,i=0;for(var a=t,n=e,r=tt,o=J,s=K,h=et,c=$.data,l=Q.data,u=0;u<n;u++)for(var f=0;f<a;f++){var d=r[o-a]+r[o+a]+r[o-1]+r[o+1]>>1;d-=r[s+i],d-=d>>5,r[s+i]=d,d=1024-d;var p=h[i];if(h[i]=d,p!==d){var g=f*d/1024<<0,v=u*d/1024<<0;g>=a&&(g=a-1),g<0&&(g=0),v>=n&&(v=n-1),v<0&&(v=0);var m=4*(g+v*a),y=4*i;c[y]=l[m],c[y+1]=l[m+1],c[y+2]=l[m+2]}++o,++i}o}(r,o),a.putImageData($,0,0)}}]),t}();for(var at=[],nt=-11;nt<=11;nt++){var rt=[];at.push(rt);for(var ot=-11;ot<=11;ot++){var st=Math.floor(2097152*Math.exp(-.2*(nt*nt+ot*ot)));rt.push(st)}}var ht=function(){function t(e){Object(f.a)(this,t),this.options=e,this.add({direction:"vertical"})}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t,this.offset=0}},{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.options=Object(Z.a)(Object(Z.a)(Object(Z.a)({},this.options),i),{},{x:t,y:e})}},{key:"draw",value:function(t,e){var i=this.context.ctx,a=e.width,n=e.height;this.offset=(this.offset+1)%a;var r=this.offset;i.putImageData(e,-r,0,r,0,a-r,n),i.putImageData(e,a-r,0,0,0,r,n)}}]),t}(),ct=0;var lt=function(){function t(e){Object(f.a)(this,t),this.options=e,ct=0}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t,this.add({direction:"vertical"})}},{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.x=t,this.y=e,this.options=Object(Z.a)(Object(Z.a)({},this.options),i)}},{key:"draw",value:function(t,e){!function(t,e,i){var a=t.ctx,n=e.width,r=e.height,o=i.direction,s=void 0===o?"vertical":o,h=i.waveHeight,c=void 0===h?6:h,l=i.frequency,u=void 0===l?100:l,f=i.waveOffset,d=void 0===f?6:f;if("horizontal"===s){ct+=ct<=0?n:-20;for(var p=0;p<r;p++){var g=c*Math.sin((p+ct)/u)+d;a.putImageData(e,g,0,0,p,n,1)}}else{ct+=ct<=0?r:-20;for(var v=0;v<n;v++){var m=c*Math.sin((v+ct)/u)+d;a.putImageData(e,0,m,v,0,1,r)}}}(this.context,e,this.options)}}]),t}(),ut=0;var ft=function(){function t(e){Object(f.a)(this,t),this.options=e,this.add({direction:"vertical"}),ut=0}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t}},{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.options=Object(Z.a)(Object(Z.a)(Object(Z.a)({},this.options),i),{},{x:t,y:e})}},{key:"draw",value:function(t,e){!function(t,e,i){var a=t.ctx,n=e.width,r=e.height,o=i.direction,s=void 0===o?"vertical":o,h=i.waveHeight,c=void 0===h?8:h,l=i.frequency,u=void 0===l?100:l,f=i.waveOffset,d=void 0===f?8:f,p=i.distribution,g=void 0===p?.125:p;if("horizontal"===s){ut+=ut<=0?n:-20;for(var v=i.y,m=v,y=v;m>0||y<r;m--,y++){var k=v-m,w=c*Math.sin((k+ut)/u)+d;if((w=~~(w*=1-k/(r*g)))<0&&(w=0),0===w){m>=0&&a.putImageData(e,0,0,0,0,n,m+1),y<r&&a.putImageData(e,0,0,0,y,n,r-y);break}m>=0&&a.putImageData(e,w,0,0,m,n,1),y!==m&&y<r&&a.putImageData(e,w,0,0,y,n,1)}}else{var b=i.x;ut+=ut<=0?r:-20;for(var x=b,M=b;x>0||M<n;x--,M++){var C=b-x,S=c*Math.sin((C+ut)/u)+d;if((S=~~(S*=1-C/(n*g)))<0&&(S=0),0===S){x>=0&&a.putImageData(e,0,0,0,0,x+1,r),M<n&&a.putImageData(e,0,0,M,0,n-M,r);break}x>=0&&a.putImageData(e,0,S,x,0,1,r),M!==x&&M<n&&a.putImageData(e,0,S,M,0,1,r)}}}(this.context,e,this.options)}}]),t}();var dt=function(){function t(e){Object(f.a)(this,t),this.options=e}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t,this.offset=0,this.tick=Date.now()}},{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.options=Object(Z.a)(Object(Z.a)(Object(Z.a)({},this.options),i),{},{x:t,y:e})}},{key:"draw",value:function(t,e){var i=Date.now();i-this.tick>50&&(this.offset=(this.offset+1)%16,this.tick=i);var a=this.context.ctx,n=e.width,r=e.height,o=this.offset-8;a.putImageData(e,-o,0,o,0,n-o,r),a.putImageData(e,n-o,0,0,0,o,r)}}]),t}();Math.PI;var pt=i(86),gt=i.n(pt);new gt.a(0,50),new Map;new gt.a(0,50),new Map;var vt=function(){function t(e){Object(f.a)(this,t),this.options=e,this.add({direction:"vertical"})}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t,this.offset=0,this.leftVisible=!1}},{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.options=Object(Z.a)(Object(Z.a)(Object(Z.a)({},this.options),i),{},{x:t,y:e})}},{key:"draw",value:function(t,e){var i=this.context.ctx,a=e.width,n=e.height;this.offset=(this.offset+1)%a;var r=this.offset;0===r&&(this.leftVisible=!this.leftVisible),i.putImageData(e,0,0),i.save(),i.globalCompositeOperation="xor",i.lineWidth=2,i.strokeStyle="white",i.beginPath(),i.moveTo(r,0),i.lineTo(r,n),i.stroke(),i.restore(),this.leftVisible?this.invisibleArea={left:0,top:0,width:r,height:n}:this.invisibleArea={left:r,top:0,width:a-r,height:n}}},{key:"getInvisibleArea",value:function(){return this.invisibleArea}}]),t}(),mt=function(){function t(e,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(f.a)(this,t),this.x=_.randomInt(0,e),this.y=_.randomInt(0,i),this.padding=a,this.width=e,this.height=i,this.xDirection=1,this.yDirection=1}return Object(d.a)(t,[{key:"update",value:function(t,e){var i=this.padding,a=i.padding,n=i.width,r=i.height;t<a&&(t=a),t>n-a&&(t=n-a),e<a&&(e=a),e>r-a&&(e=r-a),this.x=t,this.y=e}},{key:"move",value:function(){var t=this.padding,e=this.x,i=this.y,a=this.width,n=this.height;Math.random()>.1?(e>=a-t?this.xDirection=-1:e<=t&&(this.xDirection=1),this.update((e+4*this.xDirection)%a,i)):(i>=n-t?this.yDirection=-1:i<=t&&(this.yDirection=1),this.update(e,(i+4*this.yDirection)%n))}}]),t}(),yt=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t;var e=t.width,i=t.height;this.pos||(this.pos=new mt(e,i,30))}},{key:"add",value:function(t,e,i){this.pos}},{key:"draw",value:function(t,e){var i=this.context,a=i.ctx,n=i.width,r=i.height;this.pos||(this.pos=new mt(n,r,30));var o=this.pos,s=o.x,h=o.y;a.putImageData(e,0,0),a.globalCompositeOperation="destination-out",a.beginPath(),a.fillStyle="#fff",a.lineWidth=1,a.rect(0,0,n,r),a.arc(s,h,100,0,2*Math.PI,!1),a.fill("evenodd"),this.pos.move()}}]),t}();var kt=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,[{key:"init",value:function(t){this.context=t,this.options={size:200,zoom:1,brighten:0,invert:!1,grayscale:!1,threshold:!1}}},{key:"add",value:function(t,e,i){this.pos}},{key:"draw",value:function(t,e){var i=this.context.ctx,a=e.width,n=e.height,r=e.data,o=e.originalData,s=this.options;this.pos||(this.pos=new mt(a,n,s.size));var h=this.pos,c=h.x,l=h.y;!function(t,e,i,a,n,r,o){for(var s=o.size,h=o.zoom,c=o.invert,l=o.grayscale,u=o.threshold,f=Math.hypot(.5*s,.5*s)/h,d=0;d<s;d++)for(var p=0;p<s;p++){var g=p-.5*s,v=d-.5*s,m=Math.hypot(v,g);if(!(m>s/2)){var y=Math.atan2(v,g),k=m*m/f,w=4*(Math.round(.5*s+k*Math.cos(y))+n+(Math.round(.5*s+k*Math.sin(y))+r)*e),b=[t[w],t[w+1],t[w+2],t[w+3]];if(c&&(b[0]=255-b[0],b[1]=255-b[1],b[2]=255-b[2]),l){var x=.2126*b[0]+.7152*b[1]+.0722*b[2];b[0]=b[1]=b[2]=Math.round(x)}if(u){var M=.2126*b[0]+.7152*b[1]+.0722*b[2]>=127?255:0;b[0]=b[1]=b[2]=Math.round(M)}var C=4*(p+n+(d+r)*e);a[C]=b[0],a[C+1]=b[1],a[C+2]=b[2],a[C+3]=b[3]}}}(o,a,0,r,c,l,this.options),this.lastPosition={x:c,y:l},this.pos.move(),i.putImageData(e,0,0),this.lastPosition&&function(t,e,i,a,n,r,o,s){for(var h=r;h<r+s;h++)if(!(h<0)){if(h>i-1)break;for(var c=n;c<n+o;c++)if(!(c<0)){if(c>e-1)break;var l=4*(h*e+c);a[l]=t[l],a[l+1]=t[l+1],a[l+2]=t[l+2],a[l+3]=t[l+3]}}}(o,a,n,r,this.lastPosition.x,this.lastPosition.y,s.size,s.size)}}]),t}();Math.PI;var wt=[{name:"Random",src:""},{name:"Black Sky",src:"",sky:new H({fillStyle:"rgba(0, 0, 0, 0.15)"})}],bt=[{name:"Scan",effect:new vt},{name:"Move",effect:new ht},{name:"Shake",effect:new dt},{name:"Disturb",effect:new ft},{name:"Wave",effect:new lt},{name:"Monocular",effect:new yt},{name:"Fisheye",effect:new kt},{name:"Ripple",effect:new it}];function xt(){return{backgroundImages:wt,backgroundEffects:bt}}function Mt(t){var e=t.name;if(-1!==wt.findIndex((function(t){return t.name===e})))return!1;var i={name:e,src:e,img:new Image,data:{}},a=new FileReader;return a.onload=function(){var t=a.result;i.img.src=t,i.imgLoaded=!0},a.readAsDataURL(t),wt.push(i),!0}function Ct(t){if(t.src&&!t.img){var e=new Image;t.img=e,e.src=t.src,t.imgLoaded||(e.onload=function(){t.imgLoaded=!0})}}var St=function(){function t(e,i){Object(f.a)(this,t),this.context=e,this.options=i||{};var a=Date.now();this.skyTick=a,this.effectTick=a,this.disturbTick=a,this.initBackgroundImages(e),this.initBackgroundEffects(e),this.updateOptions(this.options)}return Object(d.a)(t,[{key:"initBackgroundImages",value:function(t){wt.forEach((function(e){e.sky&&e.sky.init(t),e.data||(e.data={},Ct(e))})),fetch("image/backgroundImages.json").then((function(t){return t.json()})).then((function(t){t.forEach((function(t){-1===wt.findIndex((function(e){return e.name===t.name}))&&(t.data={},Ct(t),wt.push(t))}))}))}},{key:"initBackgroundEffects",value:function(t){bt.forEach((function(e){e.effect&&e.effect.init(t)}))}},{key:"updateOptions",value:function(t){var e=t.imageIndex,i=t.effectNames;this.imageIndex=e,this.currentImageIndex=0!==e?e:void 0,this.availableBackgroundEffects=i.map((function(t){return bt.find((function(e){return e.name===t}))})).filter((function(t){return void 0!==t})),this.currentBackgroundEffect=this.availableBackgroundEffects.length?this.availableBackgroundEffects[_.randomInt(0,this.availableBackgroundEffects.length)]:void 0}},{key:"getImage",value:function(){var t=this.imageIndex;if(0===t){var e=Date.now();if(!this.currentImageIndex||e-this.imageTick>1e4){this.imageTick=e;var i=_.randomInt(1,wt.length);i!==this.currentImageIndex&&(this.currentImageIndex=i,console.log("background: use ".concat(wt[i].name)))}return wt[this.currentImageIndex]}return t>=0&&t<wt.length?wt[this.imageIndex]:wt[2]}},{key:"getEffect",value:function(){if(!q.isMobileOnly){var t=this.availableBackgroundEffects;if(t.length>1){var e=Date.now();if(e-this.effectTick>1e4){this.effectTick=e,this.disturbTick=e;var i=_.randomInt(0,t.length);this.currentBackgroundEffect=t[i],this.currentBackgroundEffect.effect.init(this.context),console.log("effect: use ".concat(this.currentBackgroundEffect.name))}}return this.currentBackgroundEffect}}},{key:"draw",value:function(){var t=this.context,e=t.ctx,i=t.width,a=t.height,n=this.getImage();if(n){var r=n.sky,o=n.img;if(r)r.draw(this.context);else if(o){e.fillStyle="rgba(0, 0, 0, 0.15)",e.clearRect(0,0,i,a),function(t,e){var i=t.img,a=t.imgLoaded,n=t.data;if(a&&i.width&&i.height){var r=e.ctx,o=e.dpr,s=e.width,h=e.height,c=~~(s*o),l=~~(h*o);if(n.w===c&&n.h===l)return;var u=Math.min(i.width/s,i.height/h),f=s*u,d=h*u,p=(i.width-f)/2,g=(i.height-d)/2;r.clearRect(0,0,s,h),r.drawImage(i,p,g,f,d,0,0,s,h);for(var v=r.getImageData(0,0,c,l),m=v.data,y=[],k=0;k<=m.length;k++)y[k]=m[k];v.w=c,v.h=l,v.originalData=y,t.data=v,console.log("background: updated image data ".concat(t.name))}}(n,this.context);var s=n.data;if(s.data){var h=this.getEffect();if(h){var c=h.effect;h.name;c.draw(o,s);var l=Date.now();l-this.disturbTick>500&&(c.add(_.randomInt(0,i),_.randomInt(0,a),i,a),this.disturbTick=l)}else e.putImageData(s,0,0)}}e.globalCompositeOperation="lighter"}}},{key:"getInvisibleArea",value:function(){var t,e;return null===(t=this.getEffect())||void 0===t||null===(e=t.getInvisibleArea)||void 0===e?void 0:e.call(t)}}]),t}(),It=i(58),Ot={lift:{volume:1,playbackRateMin:.85,playbackRateMax:.95,fileNames:["lift1.mp3","lift2.mp3","lift3.mp3"]},burst:{volume:1,playbackRateMin:.8,playbackRateMax:.9,fileNames:["burst1.mp3","burst2.mp3"]},burstSmall:{volume:.25,playbackRateMin:.8,playbackRateMax:1,fileNames:["burst-sm-1.mp3","burst-sm-2.mp3"]},crackle:{volume:.2,playbackRateMin:1,playbackRateMax:1,fileNames:["crackle1.mp3"]},crackleSmall:{volume:.3,playbackRateMin:1,playbackRateMax:1,fileNames:["crackle-sm-1.mp3"]}},Et=new(function(){function t(){var e=this;Object(f.a)(this,t),this.ctx=new(window.AudioContext||window.webkitAudioContext),this.pauseAll(),this._lastSmallBurstTime=0;var i=[];Object.keys(Ot).forEach((function(t){var a=Ot[t],n=a.fileNames,r=[];n.forEach((function(t){var a="./sound/".concat(t),n=fetch(a).then((function(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e})).then((function(t){return t.arrayBuffer()})).then((function(t){return new Promise((function(i){e.ctx.decodeAudioData(t,i)}))}));r.push(n),i.push(n)})),Promise.all(r).then((function(t){a.buffers=t}))})),Promise.all(i)}return Object(d.a)(t,[{key:"pauseAll",value:function(){this.ctx.suspend(),console.log("sound: paused")}},{key:"resumeAll",value:function(){var t=this;this.playSound("lift",0),setTimeout((function(){t.ctx.resume(),console.log("sound: resumed")}),250)}},{key:"playSound",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e=_.clamp(e,0,1),"burstSmall"===t){var i=Date.now();if(i-this._lastSmallBurstTime<20)return;this._lastSmallBurstTime=i}var a=Ot[t];if(!a)throw new Error('Sound of type "'.concat(t,"\" doesn't exist."));var n=a.volume,r=_.random(a.playbackRateMin,a.playbackRateMax),o=n*e,s=r*(2-e),h=this.ctx.createGain();h.gain.value=o;var c=_.randomChoice(a.buffers),l=this.ctx.createBufferSource();l.playbackRate.value=s,l.buffer=c,l.connect(h),h.connect(this.ctx.destination),l.start(0)}}]),t}()),Lt=function t(e,i){var a=i.x,n=i.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.randomInt(0,360),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_.randomInt(50,60);Object(f.a)(this,t);var s=_.random(0,2*Math.PI),h=15*Math.cos(_.random(0,2*Math.PI));this.rocket=e,this.p={x:a,y:n},this.velocity={x:e?_.random(-3,3):Math.cos(s)*h,y:e?_.random(-10,-4):Math.sin(s)*h},this.shrink=e?.999:_.random(0,.05)+.93,this.gravity=e?.01:.2,this.resistance=e?1:.92,this.size=3,this.hue=r,this.brightness=o,this.positions=[];for(var c=0;c<this.size;c++)this.positions.push({x:a,y:n})},Dt=function(){function t(e){Object(f.a)(this,t),this.id="f6df9bb2",this.effect=e,this.count=2,this.particles=[]}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"f6df9bb2",name:"Splendid"}}},{key:"postInit",value:function(){this.count=this.getConfigValue("count",5)}},{key:"draw",value:function(){var t=this,e=this.count,i=this.particles,a=this.effect,n=a.width,r=a.height;i.forEach((function(e,i){return t.drawParticle(i)})),i.filter((function(t){return t.rocket})).length<e&&i.push(new Lt(!0,{x:_.randomInt(0,n),y:r}))}},{key:"drawParticle",value:function(t){var e=this.particles,i=this.effect,a=i.ctx,n=i.width,r=i.height,o=e[t],s=o.rocket,h=o.velocity,c=o.p,l=o.positions,u=o.size,f=o.shrink,d=o.gravity,p=o.resistance,g=o.hue,v=o.brightness,m=o.positions.pop();if(a.beginPath(),a.moveTo(m.x,m.y),a.lineTo(c.x,c.y),a.lineWidth=u,a.strokeStyle="hsla(".concat(g,",100%,").concat(v,"%,1)"),a.stroke(),l.unshift({x:c.x,y:c.y}),o.velocity.x*=p,o.velocity.y*=p,o.velocity.y+=d,c.x+=h.x,c.y+=h.y,o.size*=f,o.size<=1||c.x>n||c.x<0||c.y>r||c.y<0)e.splice(t,1);else if(s&&c.y<=.5*r&&_.random(0,1)<=.08){for(var y=_.randomInt(0,10)+100,k=0;k<y;k+=1)e.push(new Lt(!1,c,g,v));Et.playSound("burst"),e.splice(t,1)}}},{key:"getConfigName",value:function(t){return this.effect.getConfigName(this.id,t)}},{key:"getConfigValue",value:function(t,e){return this.effect.getConfigValue(this.id,t,e)}},{key:"changeConfig",value:function(t,e){return this.effect.changeConfig(this.getConfigName(t),e)}},{key:"option",value:function(){var t=this;return[this.effect.renderSliderOption({name:this.getConfigName("count"),title:"Number of Particles",minLabel:"sparse",maxLabel:"dense",min:1,max:20,step:1,defaultValue:2}),n.a.createElement(It.a,{type:"primary",onClick:function(e){t.changeConfig("count",2)}},"Restore Default")]}},{key:"configChanged",value:function(){this.count=this.getConfigValue("count",2)}}]),t}(),Vt=function(){function t(e,i,a,n,r,o,s){Object(f.a)(this,t),this.x=e,this.y=i,this.vx=a,this.vy=n,this.ax=r,this.ay=o,this.life=150,this.path=[],this.colour=s,this.r=2}return Object(d.a)(t,[{key:"update",value:function(){this.life--,this.path.length>=15&&this.path.shift(),this.path.push([this.x,this.y]),this.vy+=this.ay,this.vx+=this.ax,this.x+=this.vx,this.y+=this.vy}},{key:"draw",value:function(t){var e=~~(100*this.life/150)/100;t.fillStyle="rgba("+this.colour+.4*e+")",this.life>142.5&&(t.fillStyle="#fff"),t.lineWidth=1,t.beginPath(),t.moveTo(this.x-this.r,this.y),t.lineTo(this.path[0][0],this.path[0][1]),t.lineTo(this.x+this.r,this.y),t.closePath(),t.fill(),t.fillStyle="rgba("+this.colour+e+")",this.life>142.5&&(t.fillStyle="#fff"),t.beginPath(),t.arc(~~this.x,~~this.y,this.r,0,2*Math.PI),t.fill(),t.closePath()}}]),t}(),jt=function(){function t(e,i){Object(f.a)(this,t),this.x=e*(.8*Math.random()+.1),this.y=i*(.8*Math.random()+.1),this.strength=5.5*Math.random()+1.5,this.colour=~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+",",this.life=0,this.particles=[];for(var a=7+~~(23*Math.random()),n=a;n--;){var r=.001,o=n*Math.PI*2/a;o<Math.PI&&(r*=-1);var s=this.strength*Math.sin(o),h=this.strength*Math.cos(o);this.particles.push(new Vt(this.x,this.y,s,h,r,.05,this.colour))}Et.playSound("burst")}return Object(d.a)(t,[{key:"update",value:function(t){if(this.life++,!(this.life<0))for(var e=this.particles.length;e--;)this.particles[e].update(),this.particles[e].draw(t)}}]),t}(),Tt=function(){function t(e){Object(f.a)(this,t),this.effect=e;var i=e.width,a=e.height;this.fw1=new jt(i,a),this.fw2=new jt(i,a),this.fw2.life=-75}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"a0886f1a",name:"Radiancy"}}},{key:"draw",value:function(){var t=this.effect,e=t.ctx,i=t.width,a=t.height;this.fw1.update(e),this.fw2.update(e),75===this.fw1.life&&(this.fw2=new jt(i,a)),75===this.fw2.life&&(this.fw1=new jt(i,a))}}]),t}(),Pt=-10,Ft=20,Rt=25,Wt=15,At=1;function zt(t){t=t||0,this.r=Nt(t),this.g=Nt(t),this.b=Nt(t),this.style=function(t,e,i){return"rgba("+t+","+e+","+i+", 0.8)"}(this.r,this.g,this.b)}function Nt(t){return Math.floor(255*Math.random()+t)}var Yt=function(){function t(e,i){Object(f.a)(this,t),this.radius=10,this.previousRadius=10,this.explodingDuration=100,this.hasExploded=!1,this.alive=!0,this.color=new zt,this.px=e/4+Math.random()*i/2,this.py=i,this.vx=Pt+Math.random()*Ft,this.vy=-1*(Rt+Math.random()*Wt),this.duration=40}return Object(d.a)(t,[{key:"update",value:function(t){if(this.hasExploded){var e=200-this.radius;this.previousRadius=this.radius,this.radius+=e/10,this.explodingDuration--,0===this.explodingDuration&&(this.alive=!1)}else this.vx+=0,this.vy+=At,this.vy>=0&&this.explode(t),this.px+=this.vx,this.py+=this.vy}},{key:"draw",value:function(t){t.beginPath(),t.arc(this.px,this.py,this.previousRadius,0,2*Math.PI,!1),this.hasExploded||(t.fillStyle=this.color.style,t.lineWidth=1,t.fill())}},{key:"explode",value:function(t){this.hasExploded=!0;for(var e=3+Math.floor(3*Math.random()),i=0;i<e;i++)for(var a=10+Math.floor(21*Math.random()),n=5+5*Math.random(),r=2*Math.PI/a,o=Math.random()*r,s=0;s<a;s++)t.push(new Xt(this,s*r+o,n));Et.playSound("burst")}}]),t}(),Xt=function(){function t(e,i,a){Object(f.a)(this,t),this.px=e.px,this.py=e.py,this.vx=Math.cos(i)*a,this.vy=Math.sin(i)*a,this.color=e.color,this.duration=40+Math.floor(20*Math.random()),this.alive=!0}return Object(d.a)(t,[{key:"update",value:function(){this.vx+=0,this.vy+=At/10,this.px+=this.vx,this.py+=this.vy,this.radius=3,this.duration--,this.duration<=0&&(this.alive=!1)}},{key:"draw",value:function(t){t.beginPath(),t.arc(this.px,this.py,this.radius,0,2*Math.PI,!1),t.fillStyle=this.color.style,t.lineWidth=1,t.fill()}}]),t}(),Bt=function(){function t(e){Object(f.a)(this,t),this.id="b93d0d69",this.effect=e,this.readyBombs=[],this.explodedBombs=[],this.particles=[];for(var i=0;i<1;i++)this.readyBombs.push(new Yt(this.width,this.height))}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"b93d0d69",name:"Bang"}}},{key:"postInit",value:function(){At=this.getConfigValue("gravity",1)}},{key:"update",value:function(){for(var t=[];this.explodedBombs.length>0;){var e=this.explodedBombs.shift();e.update(),e.alive&&t.push(e)}this.explodedBombs=t;for(var i=[];this.readyBombs.length>0;){var a=this.readyBombs.shift();a.update(this.particles),a.hasExploded?this.explodedBombs.push(a):i.push(a)}this.readyBombs=i;for(var n=[];this.particles.length>0;){var r=this.particles.shift();r.update(),r.alive&&n.push(r)}this.particles=n}},{key:"draw",value:function(t){var e=this.effect,i=e.ctx,a=e.width,n=e.height;this.update(),i.beginPath();for(var r=this.readyBombs,o=this.explodedBombs,s=this.particles,h=0;h<r.length;h++)r[h].draw(i);for(var c=0;c<o.length;c++)o[c].draw(i);for(var l=0;l<s.length;l++)s[l].draw(i);100*Math.random()<5&&r.push(new Yt(a,n))}},{key:"setSpeedParams",value:function(){for(var t=0,e=0;t<this.height&&e>=0;)t+=e+=At;Wt=e-(Rt=e/2);var i=1/4*this.width/(e/2);Pt=-i,Ft=2*i}},{key:"getConfigName",value:function(t){return this.effect.getConfigName(this.id,t)}},{key:"getConfigValue",value:function(t,e){return this.effect.getConfigValue(this.id,t,e)}},{key:"changeConfig",value:function(t,e){return this.effect.changeConfig(this.getConfigName(t),e)}},{key:"option",value:function(){var t=this;return[this.effect.renderSliderOption({name:this.getConfigName("gravity"),title:"Gravity",minLabel:"weak",maxLabel:"strong",min:1,max:3,step:.1,defaultValue:1}),n.a.createElement(It.a,{type:"primary",onClick:function(e){t.changeConfig("gravity",1)}},"Restore Default")]}},{key:"configChanged",value:function(){this.postInit()}}]),t}();function qt(t,e,i,a){var n=t-i,r=e-a;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))}var Gt=function(){function t(e,i,a,n){for(Object(f.a)(this,t),this.x=e,this.y=i,this.startX=e,this.startY=i,this.endX=a,this.endY=n,this.distanceToEnd=qt(e,i,a,n),this.distanceTraveled=0,this.trail=[],this.trailLength=3;this.trailLength--;)this.trail.push([this.x,this.y]);this.angle=Math.atan2(n-i,a-e),this.speed=5,this.acceleration=1.05,this.brightness=_.randomInt(50,70),this.targetRadius=2.5}return Object(d.a)(t,[{key:"update",value:function(){this.trail.pop(),this.trail.unshift([this.x,this.y]),this.targetRadius<8?this.targetRadius+=.3:this.targetRadius=1,this.speed*=this.acceleration;var t=Math.cos(this.angle)*this.speed,e=Math.sin(this.angle)*this.speed;return this.distanceTraveled=qt(this.startX,this.startY,this.x+t,this.y+e),this.distanceTraveled>=this.distanceToEnd||(this.x+=t,this.y+=e,!1)}},{key:"draw",value:function(t,e){t.beginPath();var i=this.trail[this.trail.length-1][0],a=this.trail[this.trail.length-1][1];t.moveTo(i,a),t.lineTo(this.x,this.y),t.strokeStyle="hsl(".concat(e,", 100%, ").concat(this.brightness,"%)"),t.stroke(),t.beginPath(),t.arc(this.endX,this.endY,this.targetRadius,0,2*Math.PI),t.stroke()}}]),t}(),_t=function(){function t(e,i,a){for(Object(f.a)(this,t),this.x=e,this.y=i,this.angle=_.random(0,2*Math.PI),this.friction=.95,this.gravity=.7,this.hue=_.randomInt(a-20,a+20),this.brightness=_.randomInt(50,80),this.decay=_.random(.015,.03),this.speed=_.random(1,10),this.trail=[],this.trailLength=5;this.trailLength--;)this.trail.push([this.x,this.y]);this.transparency=1}return Object(d.a)(t,[{key:"update",value:function(){return this.trail.pop(),this.trail.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.transparency-=this.decay,this.transparency<=this.decay}},{key:"draw",value:function(t){t.beginPath();var e=this.trail[this.trail.length-1][0],i=this.trail[this.trail.length-1][1];t.moveTo(e,i),t.lineTo(this.x,this.y),t.strokeStyle="hsla(".concat(this.hue,", 100%, ").concat(this.brightness,"%, ").concat(this.transparency,")"),t.stroke()}}]),t}(),Ut=function(){function t(e){Object(f.a)(this,t),this.effect=e,this.fireworks=[],this.particles=[],this.isMouseDown=!1,this.hue=120,this.ticksSinceFireworkAutomated=0,this.ticksSinceFirework=0}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"6acdb162",name:"Shooting"}}},{key:"draw",value:function(){this.hue+=.5,this.updateFireworks(),this.updateParticles(),this.launchAutomatedFirework(),this.launchManualFirework()}},{key:"createParticles",value:function(t,e){for(var i=this.particles,a=this.hue,n=100;n--;)i.push(new _t(t,e,a))}},{key:"launchAutomatedFirework",value:function(){var t=this.effect,e=t.width,i=t.height,a=this.fireworks,n=this.isMouseDown;if(this.ticksSinceFireworkAutomated>=_.random(20,80)){if(!n){var r=e/2,o=i,s=_.randomInt(0,e),h=_.randomInt(0,i/2);a.push(new Gt(r,o,s,h)),this.ticksSinceFireworkAutomated=0}}else this.ticksSinceFireworkAutomated++}},{key:"launchManualFirework",value:function(){var t=this.effect,e=t.width,i=t.height,a=this.fireworks,n=this.isMouseDown,r=this.center;if(this.ticksSinceFirework>=5){if(n){var o=e/2,s=i,h=r.x,c=r.y;a.push(new Gt(o,s,h,c)),this.ticksSinceFirework=0}}else this.ticksSinceFirework++}},{key:"updateFireworks",value:function(){for(var t=this.effect.ctx,e=this.fireworks,i=this.hue,a=e.length-1;a>=0;--a){var n=e[a];n.draw(t,i),n.update()&&(e.splice(a,1),this.createParticles(n.endX,n.endY),Et.playSound("burst"))}}},{key:"updateParticles",value:function(){for(var t=this.effect.ctx,e=this.particles,i=e.length-1;i>=0;--i){var a=e[i];a.draw(t),a.update()&&e.splice(i,1)}}}]),t}(),Ht=function(){function t(e,i,a,n,r){Object(f.a)(this,t),this.x=e,this.y=i,this.dir=a,this.power=n,this.vx=Math.cos(this.dir*Math.PI/180)*this.power,this.vy=Math.sin(this.dir*Math.PI/180)*this.power,this.health=100,this.hsl=r.replace(/[^\d,]/g,"").split(",")}return Object(d.a)(t,[{key:"update",value:function(){if(this.x+=this.vx,this.y+=this.vy,this.vx*=.98,this.vy*=.98,this.vy+=.15,this.health--,this.health<=0)return!0}},{key:"draw",value:function(t){t.fillStyle="hsla("+this.hsl[0]+","+this.hsl[1]+"%,"+this.hsl[2]+"%,"+this.health/100+")",t.fillRect(this.x-2,this.y-2,4,4)}}]),t}(),Jt=function(){function t(e,i){Object(f.a)(this,t),this.x=Math.random()*e,this.y=i,this.vy=-(5*Math.random()+10),this.color="hsl("+360*Math.random()+", 100%, 50%)"}return Object(d.a)(t,[{key:"update",value:function(){if(this.y+=this.vy,this.vy+=.15,Math.abs(this.vy)<=.1)return!0}},{key:"draw",value:function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,3,3)}}]),t}(),Kt=360,$t=function(){function t(e){Object(f.a)(this,t),this.id="b8d18c5b",this.effect=e,this.postInit()}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"b8d18c5b",name:"Blossom"}}},{key:"postInit",value:function(){var t=this.effect,e=t.width,i=t.height;this.fireworks=[new Jt(e,i)],this.particles=[],this.lastTick=Date.now(),Kt=this.getConfigValue("count",300)}},{key:"draw",value:function(t){var e=this.fireworks,i=this.particles,a=this.effect,n=a.ctx,r=a.width,o=a.height,s=Kt;t||(s/=2);for(var h=e.length-1;h>=0;h--){var c=e[h];if(c.update()){for(var l=0;l<s;l++)i.push(new Ht(c.x,c.y,l,5*Math.random(),c.color));e.splice(h,1),Et.playSound("burst")}c.draw(n)}for(var u=i.length-1;u>=0;u--){var f=i[u];f.update()&&i.splice(u,1),f.draw(n)}var d=Date.now();d-this.lastTick>1e3&&(this.lastTick=d,e.push(new Jt(r,o)))}},{key:"getConfigName",value:function(t){return this.effect.getConfigName(this.id,t)}},{key:"getConfigValue",value:function(t,e){return this.effect.getConfigValue(this.id,t,e)}},{key:"changeConfig",value:function(t,e){return this.effect.changeConfig(this.getConfigName(t),e)}},{key:"option",value:function(){var t=this;return[this.effect.renderSliderOption({name:this.getConfigName("count"),title:"Number of Particles",minLabel:"sparse",maxLabel:"dense",min:1,max:1e3,step:1,defaultValue:350}),n.a.createElement(It.a,{type:"primary",onClick:function(e){t.changeConfig("count",300)}},"Restore Default")]}},{key:"optionChanged",value:function(){this.postInit()}}]),t}(),Qt=3,Zt=.02,te=20,ee=100,ie=3,ae=.01,ne=10,re=50,oe=2,se=2.5,he=.1,ce=[0,0,0],le="round",ue=4,fe=20,de=30,pe=10,ge=20,ve=6,me=.05,ye=8,ke=.5,we=[[255,30,40],[255,150,20],[255,220,0],[0,255,100],[100,255,20],[50,200,200],[120,220,255],[80,180,255],[220,120,255],[255,100,150],[240,20,200],[140,140,140],[170,170,170],[200,200,200],[255,0,0]],be=function(t,e,i,a,n,r){t.strokeStyle=r,t.beginPath(),function(t,e,i,a,n){t.moveTo(e,i),t.lineTo(a,n)}(t,e,i,a,n),t.stroke()},xe=function(){function t(e){Object(f.a)(this,t),this.effect=e,this.fireworks=[],this.rockets=[]}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"70510490",name:"Still Explod"}}},{key:"draw",value:function(){var t=this.effect,e=t.ctx,i=t.width,a=t.height;e.lineCap=le,e.lineWidth=Qt;var n,r=Object(s.a)(this.fireworks);try{for(r.s();!(n=r.n()).done;){var o,h=n.value,c="rgba(".concat(h.color[0],", ").concat(h.color[1],", ").concat(h.color[2],", "),l=Object(s.a)(h.moving);try{for(l.s();!(o=l.n()).done;){var u=o.value;be(e,u.x,u.y,u.x+u.speedX/se*u.length,u.y+u.speedY/se*u.length,"".concat(c).concat(u.alpha,")"))}}catch(y){l.e(y)}finally{l.f()}var f,d=Object(s.a)(h.fading);try{for(d.s();!(f=d.n()).done;){var p=f.value;be(e,p.x,p.y,p.x+p.speedX/se*p.length,p.y+p.speedY/se*p.length,"".concat(c).concat(p.alpha,")"))}}catch(y){d.e(y)}finally{d.f()}}}catch(y){r.e(y)}finally{r.f()}e.lineWidth=ue,e.save(),e.shadowBlur=fe;var g,v=Object(s.a)(this.rockets);try{for(v.s();!(g=v.n()).done;){var m=g.value;e.shadowColor=m.color,be(e,m.x,m.y,m.x+m.speedX/ye*m.length,m.y+m.speedY/ye*m.length,m.color)}}catch(y){v.e(y)}finally{v.f()}e.restore(),Math.random()<me&&this.createRocket(Math.random()*i,Math.random()*a);this.removeFireworks(1),this.removeRockets(1)}},{key:"removeFireworks",value:function(t){for(var e=this.fireworks,i=e.length-1;i>=0;i--){for(var a=e[i].moving.length-1;a>=0;a--){var n=e[i].moving[a];Math.abs(n.speedX)<he&&Math.abs(n.speedY)<he?(e[i].moving.splice(a,1),e[i].fading.push(n)):(n.x+=n.speedX*t,n.y+=n.speedY*t,Math.sign(n.speedX)===Math.sign(n.speedX-n.speedDecreaseX*t)?n.speedX-=n.speedDecreaseX*t:n.speedX=0,Math.sign(n.speedY)===Math.sign(n.speedY-n.speedDecreaseY*t)?n.speedY-=n.speedDecreaseY*t:n.speedY=0)}if(0===e[i].moving.length){for(var r=e[i].fading.length-1;r>=0;r--){var o=e[i].fading[r];o.alpha>o.alphaDecrease*t?o.alpha-=o.alphaDecrease*t:e[i].fading.splice(r,1)}0===e[i].fading.length&&e.splice(i,1)}}}},{key:"removeRockets",value:function(t){for(var e=this.rockets,i=e.length-1;i>=0;i--){var a=e[i];Math.abs(a.speedX)<ke&&Math.abs(a.speedY)<ke?(e.splice(i,1),this.createFirework(a.x,a.y,a.colorFirework)):(a.x+=a.speedX*t,a.y+=a.speedY*t,a.speedX-=a.speedDecreaseX*t,a.speedY-=a.speedDecreaseY*t)}}},{key:"createFirework",value:function(t,e,i){for(var a=this.fireworks,n=[],r=_.random(re,ee),o=0;o<2*r;o++){var s=r*Math.sqrt(Math.random()),h=2*Math.PI*Math.random(),c=s*Math.cos(h),l=s*Math.sin(h),u=Math.sqrt(Math.pow(c,2)+Math.pow(l,2)),f=_.random(oe,ie),d=c/u*f,p=l/u*f;n.push({x:t,y:e,distX:c,distY:l,speedX:d,speedY:p,speedDecreaseX:Math.pow(d,2)/(2*c),speedDecreaseY:Math.pow(p,2)/(2*l),alpha:1,alphaDecrease:_.random(ae,Zt),length:_.randomInt(ne,te)})}a.push({color:i,moving:n,fading:[]}),Et.playSound("burst")}},{key:"createRocket",value:function(t,e){var i,a=this.effect,n=a.width,r=a.height,o=this.rockets,s=t-n/2,h=e-r,c=Math.sqrt(Math.pow(s,2)+Math.pow(h,2)),l=_.random(ve,pe),u=s/c*l,f=h/c*l;i=16===we.length+1?we[_.randomInt(0,we.length)]:16===we.length?ce:we[16],o.push({x:n/2,y:r,color:"rgb(".concat(i[0],", ").concat(i[1],", ").concat(i[2],")"),colorFirework:i,length:_.randomInt(ge,de),speedX:u,speedY:f,speedDecreaseX:Math.pow(u,2)/(2*s),speedDecreaseY:Math.pow(f,2)/(2*h)})}}]),t}(),Me=i(305),Ce=function(){function t(e){Object(f.a)(this,t);this.effect=e,this.id="28775d10",this.duration=3e3}return Object(d.a)(t,[{key:"postInit",value:function(){var t=this.effect,e=this.id;this.duration=t.getConfigValue(e,"duration",3e3),this.words=t.getConfigValue(e,"text","awesome").split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length})),this.makeWord(0)}},{key:"getDescriptor",value:function(){return{id:"28775d10",name:"Spew Text"}}},{key:"draw",value:function(){var t=this,e=this.effect,i=e.ctx,a=e.width,n=e.height,r=this.words;this.tick=Date.now();var o=parseInt(this.tick/this.duration)%r.length;this.currentWord===o&&this.chars||this.makeWord(o),i.fillStyle="#00000010",i.fillRect(0,0,a,n),this.chars.forEach((function(e){t.firework(i,a,n,e)}))}},{key:"makeWord",value:function(t){var e=this,i=this.effect.width,a=this.words,n=i<400?300:400,r=i<400?55:99;t%=a.length,this.currentWord=t,this.chars=Object(A.a)(a[t]).map((function(t){return e.makeChar(n,r,t)})).map((function(t,e){return{index:e,points:t,soundState:0}}))}},{key:"makeChar",value:function(t,e,i){if(/\s/.test(i))return[];var a=document.createElement("canvas");a.width=t,a.height=t;var n=a.getContext("2d");n.font="bold ".concat(t,"px Arial"),n.fillStyle="white",n.textBaseline="middle",n.textAlign="center",n.fillText(i,t/2,t/2);for(var r=n.getImageData(0,0,t,t),o=[],s=0,h=0;o.length<e;h++){var c=t*Math.random(),l=t*Math.random(),u=parseInt(l)*t*4+4*parseInt(c);if(r.data[u]&&o.push([c-t/2,l-t/2]),++s>5*e)break}return o}},{key:"firework",value:function(t,e,i,a){var n=a.index,r=a.points,o=this.duration,s=this.tick;s-=200*n;var h=n+this.chars.length*parseInt(s-s%o);s=s%o/o;var c=(n+1)*e/(1+this.chars.length);c+=100*Math.min(.2,s)*Math.sin(h);var l=.5*i;l+=Math.sin(4547.411*h)*i*.1,s<.2?(this.rocket(t,c,l,h,3*s,i),a.soundState&&(a.soundState=0)):(this.explosion(t,r,c,l,h,Math.min(1,2*Math.max(0,s-.2)),i),a.soundState||Math.random()>.8&&(a.soundState=1,Et.playSound(Math.random()>.5?"burstSmall":"burst")))}},{key:"rocket",value:function(t,e,i,a,n,r){t.fillStyle="white";var o=2-2*n+16*Math.pow(n,15*n);i=r-i*n,this.circle(t,e,i,o)}},{key:"explosion",value:function(t,e,i,a,n,r,o){var s=this,h=r*r*r*20,c=1*Math.sin(n)+8;c=r<.5?(r+.5)*r*c:c-r*c,t.fillStyle="hsl(".concat(55*n,", 55%, 55%)"),e.forEach((function(e,l){l%20===0&&(t.fillStyle="hsl(".concat(55*n,", 55%, ").concat(55+r*Math.sin(55*r+l)*45,"%)")),s.circle(t,r*e[0]+i,o-a+r*e[1]+h,c)}))}},{key:"circle",value:function(t,e,i,a){t.beginPath(),t.ellipse(e,i,a,a,0,0,6.283),t.fill()}},{key:"getConfigName",value:function(t){return this.effect.getConfigName(this.id,t)}},{key:"getConfigValue",value:function(t,e){return this.effect.getConfigValue(this.id,t,e)}},{key:"changeConfig",value:function(t,e){return this.effect.changeConfig(this.getConfigName(t),e)}},{key:"renderTextOption",value:function(){var t=this;return[this.effect.renderSliderOption({name:this.getConfigName("duration"),title:"Duration",minLabel:"short",maxLabel:"long",min:2e3,max:15e3,step:500,defaultValue:5e3}),n.a.createElement(n.a.Fragment,null,n.a.createElement("span",null,"Text"),n.a.createElement(Me.a.TextArea,{placeholder:"Text to firework",ref:function(e){return t.input=e},defaultValue:this.getConfigValue("text")||"awesome",onChange:function(e){return t.changeConfig("text",e.target.value)}}))]}},{key:"option",value:function(){return[this.renderTextOption()]}}]),t}(),Se=function(){function t(e,i,a){Object(f.a)(this,t),this.x=this.oldX=e,this.y=this.oldY=i,this.color="hsl("+_.randomInt(0,360)+", 100%, 50%)",this.lineWidth=_.randomInt(1,8)}return Object(d.a)(t,[{key:"getVelocity",value:function(){return{x:this.x-this.oldX,y:this.y-this.oldY}}},{key:"integrate",value:function(){var t=this.getVelocity();this.oldX=this.x,this.oldY=this.y,this.x+=.999*t.x,this.y+=.999*t.y}},{key:"move",value:function(t,e){this.x+=t,this.y+=e}},{key:"bounce",value:function(t){if(this.y>t){var e=this.getVelocity();this.oldY=t,this.y=this.oldY-.3*e.y,Et.playSound("burstSmall")}}},{key:"draw",value:function(t){t.strokeStyle=this.color,t.lineWidth=this.lineWidth,t.beginPath(),t.moveTo(this.oldX,this.oldY),t.lineTo(this.x,this.y),t.stroke()}}]),t}(),Ie=function(){function t(e){Object(f.a)(this,t),this.id="ba7eef98",this.effect=e,this.drops=[]}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"ba7eef98",name:"Spray"}}},{key:"postInit",value:function(){this.count=this.getConfigValue("count",300),this.spread=this.getConfigValue("spread",4),this.gravity=this.getConfigValue("gravity",.2)}},{key:"draw",value:function(t){var e=this.spread,i=this.gravity,a=this.effect,n=a.ctx,r=a.width,o=a.height,s=this.drops,h=this.count;t||(h/=2),s.length<h?this.tick=0:(this.tick++,this.tick>120&&(s.length=0));for(var c=0;c<5;c++)if(s.length<h){var l=new Se(r*_.random(0,1),o);l.move(e/2-Math.random()*e,-2*Math.random()-15),s.push(l)}for(var u=0;u<s.length;u++)s[u].move(0,i),s[u].integrate(),s[u].bounce(o),s[u].draw(n)}},{key:"getConfigName",value:function(t){return this.effect.getConfigName(this.id,t)}},{key:"getConfigValue",value:function(t,e){return this.effect.getConfigValue(this.id,t,e)}},{key:"changeConfig",value:function(t,e){return this.effect.changeConfig(this.getConfigName(t),e)}},{key:"option",value:function(){var t=this,e=this.effect;return[e.renderSliderOption({name:this.getConfigName("count"),title:"Number of Particles",minLabel:"sparse",maxLabel:"dense",min:100,max:1e3,step:1,defaultValue:300}),e.renderSliderOption({name:this.getConfigName("spread"),title:"Spay width",minLabel:"small",maxLabel:"wide",min:1,max:10,step:1,defaultValue:4}),e.renderSliderOption({name:this.getConfigName("gravity"),title:"Gravity",minLabel:"weak",maxLabel:"strong",min:.1,max:1,step:.1,defaultValue:.2}),n.a.createElement(It.a,{type:"primary",onClick:function(e){t.changeConfig("count",300),t.changeConfig("spread",4),t.changeConfig("gravity",.2)}},"Restore Default")]}},{key:"configChanged",value:function(){this.postInit()}}]),t}();var Oe,Ee,Le=[],De=function(){function t(e){Object(f.a)(this,t),this.effect=e;for(var i=0;i<5;i++){for(var a={sparks:[]},n=Math.floor(2*Math.random()),r=Math.floor(2*Math.random()),o=Math.floor(2*Math.random()),s=0;s<50;s++){var h={vx:5*Math.random()+.5,vy:5*Math.random()+.5,weight:.3*Math.random()+.03,red:n,green:r,blue:o};Math.random()>.5&&(h.vx=-h.vx),Math.random()>.5&&(h.vy=-h.vy),a.sparks.push(h)}Le.push(a),this.resetFirework(a)}}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{id:"b19b6683",name:"Launcher"}}},{key:"resetFirework",value:function(t){var e=this.effect,i=e.width,a=e.height;t.x=Math.floor(Math.random()*i),t.y=a,t.age=0,t.phase="fly"}},{key:"draw",value:function(){var t=this,e=this.effect.ctx;Le.forEach((function(i,a){if("explode"===i.phase)i.sparks.forEach((function(t){for(var a=0;a<10;a++){var n=i.age+a,r=i.x+t.vx*n,o=i.y+t.vy*n+t.weight*n*t.weight*n,s=20*a-2*i.age,h=Math.floor(t.red*s),c=Math.floor(t.green*s),l=Math.floor(t.blue*s);e.beginPath(),e.fillStyle="rgba("+h+","+c+","+l+",1)",e.rect(r,o,4,4),e.fill()}})),i.age++,i.age>100&&Math.random()<.05&&t.resetFirework(i);else{i.y=i.y-10;for(var n=0;n<15;n++)e.beginPath(),e.fillStyle="rgba("+50*a+","+17*n+",0,1)",e.rect(i.x+Math.random()*n-n/2,i.y+4*n,4,4),e.fill();(Math.random()<.001||i.y<200)&&(i.phase="explode",Et.playSound("burst"))}}))}}]),t}(),Ve=function t(e,i,a,n,r){Object(f.a)(this,t),this.x=e,this.y=i,this.vx=a,this.vy=n,this.age=r},je=function(){function t(e){Object(f.a)(this,t),this.effect=e,this.t0=Date.now(),this.positions=[],this.particles=[],this.particles_i=0,this.tick=0}return Object(d.a)(t,[{key:"getDescriptor",value:function(){return{name:"Emit"}}},{key:"postInit",value:function(){var t=this.effect,e=t.width,i=t.height;this.positions=[],this.positions.push({x:_.randomInt(2*e/5,4*e/5),y:_.randomInt(2*i/5,4*i/5)})}},{key:"draw",value:function(){var t=this,e=this.positions,i=this.particles,a=this.effect,n=a.ctx,r=a.canvas;this.tick++,this.tick%200&&Et.playSound("crackleSmall");var o=Date.now(),s=(o-this.t0)/1e3;this.t0=o;var h=r.width,c=r.height;e.forEach((function(e){return t.emitParticles(e.x,e.y)})),n.fillStyle="rgba(0, 0, 0, 0.4)",n.fillRect(0,0,h,c);for(var l=n.getImageData(0,0,h,c),u=l.data,f=i.length-1;f>=0;f--){var d=i[f];if(d.age+=s,d.age>5)i.splice(f,1);else{d.vx*=.999,d.x+=d.vx*s,d.vy=.999*(d.vy+10*s),d.y+=d.vy*s;var p=~~d.x,g=~~d.y;if(p<0||p>=h||g<0||g>=c)i.splice(f,1);else{var v=4*(p+g*h);u[v]+=120,u[v+1]+=55,u[v+2]+=10,u[v+3]=255}}}n.putImageData(l,0,0)}},{key:"fuzzy",value:function(t,e){return(e||0)+(Math.random()-.5)*t*2}},{key:"emitParticles",value:function(t,e){var i=this.particles;if(!(i.length>=1e5))for(var a=0;a<250;a++){var n=this.fuzzy(Math.PI),r=_.randomInt(0,100),o=new Ve(t,e,Math.cos(n)*r,Math.sin(n)*r,Math.random());this.particles_i=(this.particles_i+1)%1e5,i.length<1e5?i.push(o):i[this.particles_i]=o}}},{key:"createParticle",value:function(t,e){var i=this.fuzzy(Math.PI),a=_.randomInt(0,100);return new Ve(t,e,Math.cos(i)*a,Math.sin(i)*a,Math.random())}}]),t}(),Te=function(){function t(e,i,a,n){Object(f.a)(this,t),this.x=i,this.y=a,this.coordLast=[{x:i,y:a},{x:i,y:a},{x:i,y:a}],this.angle=_.randomInt(0,360),this.speed=_.random(e.partSpeed-e.partSpeedVariance<=0?1:e.partSpeed-e.partSpeedVariance,e.partSpeed+e.partSpeedVariance),this.friction=1-e.partFriction/100,this.gravity=e.partGravity/2,this.hue=_.randomInt(n-e.hueVariance,n+e.hueVariance),this.brightness=_.randomInt(50,80),this.alpha=_.randomInt(40,100)/100,this.decay=_.random(10,50)/1e3,this.wind=(_.random(0,e.partWind)-e.partWind/2)/25,this.lineWidth=e.lineWidth}return Object(d.a)(t,[{key:"update",value:function(t){var e=this.angle*Math.PI/180,i=Math.cos(e)*this.speed,a=Math.sin(e)*this.speed+this.gravity;return this.speed*=this.friction,this.coordLast[2].x=this.coordLast[1].x,this.coordLast[2].y=this.coordLast[1].y,this.coordLast[1].x=this.coordLast[0].x,this.coordLast[1].y=this.coordLast[0].y,this.coordLast[0].x=this.x,this.coordLast[0].y=this.y,this.x+=i*t,this.y+=a*t,this.angle+=this.wind,this.alpha-=this.decay,!(this.alpha<.05)}},{key:"draw",value:function(t){var e=_.randomInt(1,3)-1;if(t.beginPath(),t.moveTo(Math.round(this.coordLast[e].x),Math.round(this.coordLast[e].y)),t.lineTo(Math.round(this.x),Math.round(this.y)),t.closePath(),t.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.alpha+")",t.stroke(),this.flickerDensity>0){var i=50-this.flickerDensity;if(_.random(0,i)===i){t.beginPath(),t.arc(Math.round(this.x),Math.round(this.y),_.random(this.lineWidth,this.lineWidth+3)/2,0,2*Math.PI,!1),t.closePath();var a=_.randomInt(50,100)/100;t.fillStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+a+")",t.fill()}}}}]),t}(),Pe=function(){function t(e,i,a,n,r){Object(f.a)(this,t),this.x=i,this.y=a,this.startX=i,this.startY=a,this.hitX=!1,this.hitY=!1,this.coordLast=[{x:i,y:a},{x:i,y:a},{x:i,y:a}],this.targetX=n,this.targetY=r,this.speed=e.fworkSpeed,this.angle=Math.atan2(r-a,n-i),this.shockwaveAngle=Math.atan2(r-a,n-i)+Math.PI/180*90,this.acceleration=e.fworkAccel/100,this.hue=_.randomInt(e.hueMin,e.hueMax),this.brightness=_.randomInt(50,80),this.alpha=_.randomInt(50,100)/100,this.lineWidth=e.lineWidth,this.targetRadius=1}return Object(d.a)(t,[{key:"update",value:function(t){var e=Math.cos(this.angle)*this.speed,i=Math.sin(this.angle)*this.speed;return this.speed*=1+this.acceleration,this.coordLast[2].x=this.coordLast[1].x,this.coordLast[2].y=this.coordLast[1].y,this.coordLast[1].x=this.coordLast[0].x,this.coordLast[1].y=this.coordLast[0].y,this.coordLast[0].x=this.x,this.coordLast[0].y=this.y,this.showTarget&&(this.targetRadius<8?this.targetRadius+=.25*t:this.targetRadius=1*t),this.startX>=this.targetX?this.x+e<=this.targetX?(this.x=this.targetX,this.hitX=!0):this.x+=e*t:this.x+e>=this.targetX?(this.x=this.targetX,this.hitX=!0):this.x+=e*t,this.startY>=this.targetY?this.y+i<=this.targetY?(this.y=this.targetY,this.hitY=!0):this.y+=i*t:this.y+i>=this.targetY?(this.y=this.targetY,this.hitY=!0):this.y+=i*t,!this.hitX||!this.hitY}},{key:"draw",value:function(t){t.lineWidth=this.lineWidth;var e=_.randomInt(1,3)-1;t.beginPath(),t.moveTo(Math.round(this.coordLast[e].x),Math.round(this.coordLast[e].y)),t.lineTo(Math.round(this.x),Math.round(this.y)),t.closePath(),t.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.alpha+")",t.stroke(),this.showTarget&&(t.save(),t.beginPath(),t.arc(Math.round(this.targetX),Math.round(this.targetY),this.targetRadius,0,2*Math.PI,!1),t.closePath(),t.lineWidth=1,t.stroke(),t.restore()),this.showShockwave&&(t.save(),t.translate(Math.round(this.x),Math.round(this.y)),t.rotate(this.shockwaveAngle),t.beginPath(),t.arc(0,0,this.speed/5*1,0,Math.PI,!0),t.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+_.randomInt(25,60)/100+")",t.lineWidth=this.lineWidth,t.stroke(),t.restore())}}]),t}(),Fe=[{name:"Default",preset:{fworkSpeed:2,fworkAccel:4,showShockwave:!1,showTarget:!0,partCount:30,partSpeed:5,partSpeedVariance:10,partWind:50,partFriction:5,partGravity:1,flickerDensity:20,hueMin:150,hueMax:200,hueVariance:30,lineWidth:1,clearAlpha:25}},{name:"Anti Gravity",preset:{fworkSpeed:4,fworkAccel:10,showShockwave:!0,showTarget:!1,partCount:150,partSpeed:5,partSpeedVariance:10,partWind:10,partFriction:10,partGravity:-10,flickerDensity:30,hueMin:0,hueMax:360,hueVariance:30,lineWidth:1,clearAlpha:50}},{name:"Battle Field",preset:{fworkSpeed:10,fworkAccel:20,showShockwave:!0,showTarget:!0,partCount:200,partSpeed:30,partSpeedVariance:5,partWind:0,partFriction:5,partGravity:0,flickerDensity:0,hueMin:20,hueMax:30,hueVariance:10,lineWidth:1,clearAlpha:40}},{name:"Mega Blast",preset:{fworkSpeed:3,fworkAccel:3,showShockwave:!0,showTarget:!0,partCount:100,partSpeed:50,partSpeedVariance:5,partWind:0,partFriction:0,partGravity:0,flickerDensity:0,hueMin:0,hueMax:360,hueVariance:30,lineWidth:20,clearAlpha:20}},{name:"Nimble",preset:{fworkSpeed:10,fworkAccel:50,showShockwave:!1,showTarget:!1,partCount:120,partSpeed:10,partSpeedVariance:10,partWind:100,partFriction:50,partGravity:0,flickerDensity:20,hueMin:0,hueMax:360,hueVariance:30,lineWidth:1,clearAlpha:80}},{name:"Slow Launch",preset:{fworkSpeed:2,fworkAccel:2,showShockwave:!1,showTarget:!1,partCount:200,partSpeed:10,partSpeedVariance:0,partWind:100,partFriction:0,partGravity:2,flickerDensity:50,hueMin:0,hueMax:360,hueVariance:20,lineWidth:4,clearAlpha:10}},{name:"Perma Trail",preset:{fworkSpeed:4,fworkAccel:10,showShockwave:!1,showTarget:!1,partCount:150,partSpeed:10,partSpeedVariance:10,partWind:100,partFriction:3,partGravity:0,flickerDensity:0,hueMin:0,hueMax:360,hueVariance:20,lineWidth:1,clearAlpha:0}},{name:"Lighning",preset:{fworkSpeed:1,fworkAccel:50,showShockwave:!1,showTarget:!1,partCount:5,partSpeed:100,partSpeedVariance:0,partWind:0,partFriction:0,partGravity:0,flickerDensity:0,hueMin:0,hueMax:360,hueVariance:30,lineWidth:1,clearAlpha:100}}],Re=function(){function t(e,i){Object(f.a)(this,t),this.id="289ba10e",this.effect=e,this.dt=0,this.oldTime=Date.now(),this.particles=[],this.fireworks=[],this.presetIndex=i.preset,this.createFireworks()}return Object(d.a)(t,[{key:"getDescriptor",value:function(){var t=this.presetIndex;return{id:"289ba10e",name:t?Fe[t%Fe.length].name:"Brilliant",fireworks:Fe.map((function(t){return t.name}))}}},{key:"postInit",value:function(){var t=Fe[0],e=this.id,i=this.effect;t.fworkSpeed=i.getConfigValue(e,"fworkSpeed",2),t.fworkAccel=i.getConfigValue(e,"fworkAccel",4),t.partCount=i.getConfigValue(e,"partCount",30),t.partSpeed=i.getConfigValue(e,"partSpeed",5),t.partSpeedVariance=i.getConfigValue(e,"partSpeedVariance",10),t.partWind=i.getConfigValue(e,"partWind",50),t.partFriction=i.getConfigValue(e,"partFriction",5),t.partGravity=i.getConfigValue(e,"partGravity",1),t.flickerDensity=i.getConfigValue(e,"flickerDensity",20),t.hueMin=i.getConfigValue(e,"hueMin",150),t.hueMax=i.getConfigValue(e,"hueMax",200),t.hueVariance=i.getConfigValue(e,"hueVariance",30),t.lineWidth=i.getConfigValue(e,"lineWidth",1),t.clearAlpha=i.getConfigValue(e,"clearAlpha",25)}},{key:"draw",value:function(){var t=this.fireworks,e=this.effect.ctx;e.lineCap="round",e.lineJoin="round",this.updateDelta(),this.updateFireworks(),this.updateParticles(),this.drawFireworks(e),this.drawParticles(e),t.length||this.createFireworks()}},{key:"event",value:function(t,e){var i=this.effect,a=i.width,n=i.height;switch(t){case"event@mouse-down":this.trackMouse=!0;break;case"event@mouse-up":this.trackMouse=!1;break;case"event@mouse-moved":this.center=e,this.trackMouse&&this.fireworks.push(new Pe(this.getPreset(),a/2,n,this.center.x,this.center.y))}}},{key:"updateDelta",value:function(){var t=Date.now();this.dt=(t-this.oldTime)/16,this.dt=this.dt>5?5:this.dt,this.oldTime=t}},{key:"getPreset",value:function(){return Fe[this.presetIndex%Fe.length].preset}},{key:"createParticles",value:function(t,e,i,a){for(var n=t.partCount;n--;)this.particles.push(new Te(t,e,i,a))}},{key:"updateParticles",value:function(){for(var t=this.particles.length;t--;){this.particles[t].update(this.dt)||this.particles.splice(t,1)}}},{key:"drawParticles",value:function(t){for(var e=this.particles.length;e--;){this.particles[e].draw(t)}}},{key:"createFireworks",value:function(){for(var t=this.effect,e=t.width,i=t.height,a=this.getPreset(),n=0;n<3;n++)this.fireworks.push(new Pe(a,e/2,i,_.randomInt(50,e-50),_.randomInt(50,i)-50));Et.playSound("burst")}},{key:"updateFireworks",value:function(){for(var t=this.fireworks.length;t--;){var e=this.fireworks[t];e.update(this.dt)||(this.fireworks.splice(t,1),this.createParticles(this.getPreset(),e.targetX,e.targetY,e.hue))}}},{key:"drawFireworks",value:function(t){for(var e=this.fireworks.length;e--;){this.fireworks[e].draw(t)}}},{key:"option",value:function(){if(0!==this.presetIndex)return[];var t=this.id,e=this.effect;return[e.renderSliderOption({name:e.getConfigName(t,"fworkSpeed"),title:"Firework Speed",min:1,max:10,step:1,defaultValue:2}),e.renderSliderOption({name:e.getConfigName(t,"fworkAccel"),title:"Firework Accellerator",min:0,max:50,step:1,defaultValue:4}),e.renderSliderOption({name:e.getConfigName(t,"partCount"),title:"Particle Count",min:0,max:500,step:1,defaultValue:30}),e.renderSliderOption({name:e.getConfigName(t,"partSpeed"),title:"Particle Speed",min:1,max:100,step:1,defaultValue:5}),e.renderSliderOption({name:e.getConfigName(t,"partSpeedVariance"),title:"Particle Speed Variance",min:0,max:50,step:1,defaultValue:10}),e.renderSliderOption({name:e.getConfigName(t,"partWind"),title:"Particle Wind",min:0,max:100,step:1,defaultValue:50}),e.renderSliderOption({name:e.getConfigName(t,"partFriction"),title:"Particle Friction",min:0,max:50,step:1,defaultValue:5}),e.renderSliderOption({name:e.getConfigName(t,"partGravity"),title:"Particle Gravity",min:-20,max:20,step:1,defaultValue:1}),e.renderSliderOption({name:e.getConfigName(t,"flickerDensity"),title:"Particle Flicker Density",min:0,max:50,step:1,defaultValue:20}),e.renderSliderOption({name:e.getConfigName(t,"hueMin"),title:"Hue Minimum",min:0,max:360,step:1,defaultValue:150}),e.renderSliderOption({name:e.getConfigName(t,"hueMax"),title:"Hue Maximum",min:0,max:360,step:1,defaultValue:200}),e.renderSliderOption({name:e.getConfigName(t,"hueVariance"),title:"Hue Variance",min:0,max:180,step:1,defaultValue:30}),e.renderSliderOption({name:e.getConfigName(t,"lineWidth"),title:"Line Width",min:1,max:20,step:1,defaultValue:1}),e.renderSliderOption({name:e.getConfigName(t,"clearAlpha"),title:"Clear Alpha",min:0,max:100,step:1,defaultValue:25})]}}]),t}(),We=window.innerWidth<=640,Ae=window.innerWidth>800,ze=function(){var t=navigator.hardwareConcurrency;return!!t&&t>=(window.innerWidth<=1024?4:8)}(),Ne=1;var Ye={Red:"#ff0043",Green:"#14fc56",Blue:"#1e7fff",Purple:"#e60aff",Gold:"#ffbf36",White:"#ffffff"},Xe="_INVISIBLE_",Be=2*Math.PI,qe=.5*Math.PI,Ge={_listeners:new Set,_dispatch:function(t){var e=this;this._listeners.forEach((function(i){return i(e.state,t)}))},state:{paused:!0,soundEnabled:!1,menuOpen:!1,openHelpTopic:null,config:{quality:String(ze?3:2),shell:"Random",size:Ae?"3":"2",autoLaunch:!0,finale:!1,skyLighting:"2",hideControls:!1,longExposure:!1,scaleFactor:We?.9:1}},setState:function(t){var e=this.state;this.state=Object.assign({},this.state,t),this._dispatch(e),this.persist()},subscribe:function(t){var e=this;return this._listeners.add(t),function(){return e._listeners.remove(t)}},load:function(){var t=localStorage.getItem("cm_fireworks_data");if(t){var e=JSON.parse(t),i=e.schemaVersion,a=e.data,n=this.state.config;switch(i){case"1.1":n.quality=a.quality,n.size=a.size,n.skyLighting=a.skyLighting;break;case"1.2":n.quality=a.quality,n.size=a.size,n.skyLighting=a.skyLighting,n.scaleFactor=a.scaleFactor;break;default:throw new Error("version switch should be exhaustive")}console.log("Loaded config (schema version ".concat(i,")"))}else if("1"===localStorage.getItem("schemaVersion")){var r;try{var o=localStorage.getItem("configSize");r="string"===typeof o&&JSON.parse(o)}catch(h){return console.log("Recovered from error parsing saved config:"),void console.error(h)}var s=parseInt(r,10);s>=0&&s<=4&&(this.state.config.size=String(s))}},persist:function(){var t=this.state.config;localStorage.setItem("cm_fireworks_data",JSON.stringify({schemaVersion:"1.2",data:{quality:t.quality,size:t.size,skyLighting:t.skyLighting,scaleFactor:t.scaleFactor}}))}};Ge.load();var _e,Ue=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge.state;return!t.paused&&!t.menuOpen},He=function(){return Ge.state.config.shell},Je=function(){return+Ge.state.config.size},Ke=function(){return+Ge.state.config.skyLighting},$e=Object.keys(Ye).map((function(t){return Ye[t]})),Qe=[].concat(Object(A.a)($e),[Xe]),Ze=(Qe.reduce((function(t,e,i){return t[e]=i,t}),{}),{});function ti(){return $e[Math.random()*$e.length|0]}function ei(t){var e=t&&t.notSame,i=t&&t.notColor,a=t&&t.limitWhite,n=ti();if(a&&n===Ye.White&&Math.random()<.6&&(n=ti()),e)for(;n===_e;)n=ti();else if(i)for(;n===i;)n=ti();return _e=n,n}function ii(){return Math.random()<.5?Ye.Gold:Ye.White}function ai(t){return t===Ye.White||t===Ye.Gold?ei({notColor:t}):ii()}$e.forEach((function(t){Ze[t]={r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}}));var ni=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=Math.random()<.25,i=Math.random()<.72,a=i?ei({limitWhite:!0}):[ei(),ei({notSame:!0})],n=i&&Math.random()<.42,r=n&&ai(a),o=i&&(Math.random()<.2||a===Ye.White)?r||ei({notColor:a,limitWhite:!0}):null,s=!n&&a!==Ye.White&&Math.random()<.42,h=e?1.1:1.25;return{shellSize:t,spreadSize:300+100*t,starLife:900+200*t,starDensity:h,color:a,secondColor:o,glitter:e?"light":"",glitterColor:ii(),pistil:n,pistilColor:r,streamers:s}},ri=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=ei(),i=Math.random()<.75;return{shellSize:t,ring:!0,color:e,spreadSize:300+100*t,starLife:900+200*t,starCount:2.2*Be*(t+1),pistil:i,pistilColor:ai(e),glitter:i?"":"light",glitterColor:e===Ye.Gold?Ye.Gold:Ye.White,streamers:Math.random()<.3}};function oi(){return Math.random()<.5?"Crysanthemum":fi[Math.random()*(fi.length-1)+1|0]}function si(t){return ui[oi()](t)}function hi(t){return ui[He()](t)}var ci=["Falling Leaves","Floral","Willow"];function li(){var t="Random"===He(),e=t?oi():He();if(t)for(;ci.includes(e);)e=oi();return ui[e]}var ui={Random:si,Crackle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=Math.random()<.75?Ye.Gold:ei();return{shellSize:t,spreadSize:380+75*t,starDensity:1,starLife:600+100*t,starLifeVariation:.32,glitter:"light",glitterColor:Ye.Gold,color:e,crackle:!0,pistil:Math.random()<.65,pistilColor:ai(e)}},Crossette:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=ei({limitWhite:!0});return{shellSize:t,spreadSize:300+100*t,starLife:750+160*t,starLifeVariation:.4,starDensity:.85,color:e,crossette:!0,pistil:Math.random()<.5,pistilColor:ai(e)}},Crysanthemum:ni,"Falling Leaves":function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{shellSize:t,color:Xe,spreadSize:300+120*t,starDensity:.12,starLife:500+50*t,starLifeVariation:.5,glitter:"medium",glitterColor:Ye.Gold,fallingLeaves:!0}},Floral:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{shellSize:t,spreadSize:300+120*t,starDensity:.12,starLife:500+50*t,starLifeVariation:.5,color:Math.random()<.65?"random":Math.random()<.15?ei():[ei(),ei({notSame:!0})],floral:!0}},Ghost:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=ni(t);e.starLife*=1.5;var i=ei({notColor:Ye.White});e.streamers=!0;var a=Math.random()<.42;a&&ai(i);return e.color=Xe,e.secondColor=i,e.glitter="",e},"Horse Tail":function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=ei();return{shellSize:t,horsetail:!0,color:e,spreadSize:250+38*t,starDensity:.9,starLife:2500+300*t,glitter:"medium",glitterColor:Math.random()<.5?ii():e,strobe:e===Ye.White}},Palm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=ei(),i=Math.random()<.5;return{shellSize:t,color:e,spreadSize:250+75*t,starDensity:i?.15:.4,starLife:1800+200*t,glitter:i?"thick":"heavy"}},Ring:ri,Strobe:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=ei({limitWhite:!0});return{shellSize:t,spreadSize:280+92*t,starLife:1100+200*t,starLifeVariation:.4,starDensity:1.1,color:e,glitter:"light",glitterColor:Ye.White,strobe:!0,strobeColor:Math.random()<.5?Ye.White:null,pistil:Math.random()<.5,pistilColor:ai(e)}},Willow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{shellSize:t,spreadSize:300+100*t,starDensity:.6,starLife:3e3+300*t,glitter:"willow",glitterColor:Ye.Gold,color:Xe}}},fi=Object.keys(ui);function di(){!function(t){var e,i=Ge.state.paused;i!==(e="boolean"===typeof t?t:!i)&&Ge.setState({paused:e})}(!1)}function pi(t){return.64*t+.18}function gi(t){return.75*t}function vi(){var t=Je(),e=Math.min(2.5,t),i=Math.random()*e,a=t-i,n=0===e?Math.random():1-i/e,r=Math.random()*(1-.65*n)*.5;return{size:a,x:pi(Math.random()<.5?.5-r:.5+r),height:gi(n)}}function mi(){var t=vi(),e=new Fi(hi(t.size));e.launch(t.x,t.height);var i=e.starLife;return e.fallingLeaves&&(i=4600),900+600*Math.random()+i}function yi(){var t=vi(),e=vi(),i=new Fi(hi(t.size)),a=new Fi(hi(e.size)),n=.2*Math.random()-.1,r=.2*Math.random()-.1;i.launch(.3+n,t.height),setTimeout((function(){a.launch(.7+r,e.height)}),100);var o=Math.max(i.starLife,a.starLife);return(i.fallingLeaves||a.fallingLeaves)&&(o=4600),900+600*Math.random()+o}function ki(){var t=li(),e=Je(),i=Math.max(0,e-1.25),a=.08*Math.random()-.04;new Fi(t(e)).launch(.5+a,.7);var n=1e3+400*Math.random(),r=1e3+400*Math.random();return setTimeout((function(){var e=.08*Math.random()-.04;new Fi(t(i)).launch(.2+e,.1)}),n),setTimeout((function(){var e=.08*Math.random()-.04;new Fi(t(i)).launch(.8+e,.1)}),r),4e3}function wi(){var t=Ae?7:4,e=Je(),i=Math.max(0,e-3),a=Math.random()<.78?ni:ri,n=si;function r(t,r){var o="Random"===He()?r?n:a:ui[He()],s=t<=.5?t/.5:(1-t)/.5;new Fi(o(r?e:i)).launch(t,r?.75:.42*s)}for(var o=0,s=0;o<=t;)o===t?setTimeout((function(){r(.5,!0)}),s):function(){var e=o/t*.5,i=30*Math.random()+30;setTimeout((function(){r(e,!1)}),s),setTimeout((function(){r(1-e,!1)}),s+i)}(),o++,s+=200;return 3400+250*t}function bi(){bi.lastCalled=Date.now();var t=Ae?11:5,e=Ae?3:1,i=Math.max(0,Je()-2),a=Math.random()<.78?ni:ri,n=li();function r(t,e){var r="Random"===He()?e?n:a:ui[He()],o=new Fi(r(i)),s=(Math.cos(5*t*Math.PI+qe)+1)/2;o.launch(t,.75*s)}for(var o=0,s=0;o<t;)0===o?(r(.5,!1),o+=1):function(){var i=(o+1)/t/2,a=30*Math.random()+30,n=o===e;setTimeout((function(){r(.5+i,n)}),s),setTimeout((function(){r(.5-i,n)}),s+a),o+=2}(),s+=200;return 3400+120*t}bi.cooldown=15e3,bi.lastCalled=Date.now();var xi=!0,Mi=0;function Ci(t){if(xi)return xi=!1,new Fi(t.shellType(Je())||ni(Je())).launch(.5,.5),2400;if(Ge.state.config.finale)return function(t){var e=li(),i=vi(),a=new Fi(t.shellType(i.size)||e(i.size));a.launch(i.x,i.height);var n=a.starLife;Math.random()}(t),Mi<32?(Mi++,170):(Mi=0,6e3);var e=Math.random();return e<.08&&Date.now()-bi.lastCalled>bi.cooldown?bi():e<.1?wi():e<.6?mi():e<.8?yi():e<1?ki():void 0}var Si=0,Ii=0,Oi=0;function Ei(t,e,i){if(Ue()){var a=e*Ne,n=Ne*i;!function(t,e,i){Si++,(Ii-=i/30)<0&&(Ii=0),Ge.state.config.autoLaunch&&(Oi-=e)<=0&&(Oi=1.25*Ci(t))}(t,a,i);var r=1-(1-Ai.airDrag)*n,o=1-(1-Ai.airDragHeavy)*n,s=1-(1-zi.airDrag)*n,h=a/1e3*.9;Qe.forEach((function(t){for(var e=Ai.active[t],i=e.length-1;i>=0;i-=1){var c=e[i];if(c.updateFrame!==Si)if(c.updateFrame=Si,c.life-=a,c.life<=0)e.splice(i,1),Ai.returnInstance(c);else{var l=Math.pow(c.life/c.fullLife,.5),u=1-l;if(c.prevX=c.x,c.prevY=c.y,c.x+=c.speedX*n,c.y+=c.speedY*n,c.heavy?(c.speedX*=o,c.speedY*=o):(c.speedX*=r,c.speedY*=r),c.speedY+=h,c.spinRadius&&(c.spinAngle+=c.spinSpeed*n,c.x+=Math.sin(c.spinAngle)*c.spinRadius*n,c.y+=Math.cos(c.spinAngle)*c.spinRadius*n),c.sparkFreq)for(c.sparkTimer-=a;c.sparkTimer<0;)c.sparkTimer+=.75*c.sparkFreq+c.sparkFreq*u*4,zi.add(c.x,c.y,c.sparkColor,Math.random()*Be,Math.random()*c.sparkSpeed*l,.8*c.sparkLife+Math.random()*c.sparkLifeVariation*c.sparkLife);c.life<c.transitionTime&&(c.secondColor&&!c.colorChanged&&(c.colorChanged=!0,c.color=c.secondColor,e.splice(i,1),Ai.active[c.secondColor].push(c),c.secondColor===Xe&&(c.sparkFreq=0)),c.strobe&&(c.visible=Math.floor(c.life/c.strobeFreq)%3===0))}}for(var f=zi.active[t],d=f.length-1;d>=0;d-=1){var p=f[d];p.life-=a,p.life<=0?(f.splice(d,1),zi.returnInstance(p)):(p.prevX=p.x,p.prevY=p.y,p.x+=p.speedX*n,p.y+=p.speedY*n,p.speedX*=s,p.speedY*=s,p.speedY+=h)}})),function(t,e){var i=t.width,a=t.height,n=t.mainCtx,r=t.trailsCtx;0!==Ke()&&function(t){var e=15*Ke(),i=0;Di.r=0,Di.g=0,Di.b=0,$e.forEach((function(t){var e=Ze[t],a=Ai.active[t].length;i+=a,Di.r+=e.r*a,Di.g+=e.g*a,Di.b+=e.b*a}));var a=Math.pow(Math.min(1,i/500),.3),n=Math.max(1,Di.r,Di.g,Di.b);Di.r=Di.r/n*e*a,Di.g=Di.g/n*e*a,Di.b=Di.b/n*e*a;Li.r+=(Di.r-Li.r)/10*t,Li.g+=(Di.g-Li.g)/10*t,Li.b+=(Di.b-Li.b)/10*t}(e);for(;Ri.active.length;){var o=Ri.active.pop(),s=r.createRadialGradient(o.x,o.y,0,o.x,o.y,o.radius);s.addColorStop(.024,"rgba(255, 255, 255, 1)"),s.addColorStop(.125,"rgba(255, 160, 20, 0.2)"),s.addColorStop(.32,"rgba(255, 140, 20, 0.11)"),s.addColorStop(1,"rgba(255, 120, 20, 0)"),r.fillStyle=s,r.fillRect(o.x-o.radius,o.y-o.radius,2*o.radius,2*o.radius),Ri.returnInstance(o)}if(n.strokeStyle="#fff",r.lineCap="round",n.beginPath(),$e.forEach((function(t){var e=Ai.active[t];r.strokeStyle=t,r.beginPath(),e.forEach((function(t){t.visible&&(r.lineWidth=Ai.drawWidth,r.moveTo(t.x,t.y),r.lineTo(t.prevX,t.prevY),n.lineWidth=1,n.moveTo(t.x,t.y),n.lineTo(t.x-1.6*t.speedX,t.y-1.6*t.speedY))})),r.stroke()})),n.stroke(),r.lineWidth=zi.drawWidth,r.lineCap="butt",$e.forEach((function(t){var e=zi.active[t];r.strokeStyle=t,r.beginPath(),e.forEach((function(t){r.moveTo(t.x,t.y),r.lineTo(t.prevX,t.prevY)})),r.stroke()})),Ii){n.globalAlpha=Ii,n.fillStyle=Ye.Blue,n.fillRect(0,a-6,i*Ne,6),n.globalAlpha=1}}(t,n)}}var Li={r:0,g:0,b:0},Di={r:0,g:0,b:0};function Vi(t,e,i,a,n){var r=e/i,o=t+e-.5*r;if(o>t)for(var s=t;s<o;s+=r)n(s+Math.random()*r*a);else for(var h=t;h>o;h+=r)n(h+Math.random()*r*a)}function ji(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Be,n=.5*Math.sqrt(t/Math.PI),r=2*n*Math.PI,o=r/2,s=0;s<=o;s++)for(var h=s/o*qe,c=Math.cos(h),l=r*c,u=l*(a/Be),f=Be/l,d=Math.random()*f+i,p=.33*f,g=0;g<u;g++){var v=Math.random()*p,m=f*g+d+v;e(m,c)}}function Ti(t){ji(18,(function(e,i){Ai.add(t.x,t.y,t.color,e,2.4*i,1e3+300*Math.random(),t.speedX,t.speedY)})),Ri.add(t.x,t.y,46),Et.playSound("burstSmall")}function Pi(t){ji(7,(function(e,i){var a=Ai.add(t.x,t.y,Xe,e,2.4*i,2400+600*Math.random(),t.speedX,t.speedY);a.sparkColor=Ye.Gold,a.sparkFreq=144,a.sparkSpeed=.28,a.sparkLife=750,a.sparkLifeVariation=3.2})),Ri.add(t.x,t.y,46),Et.playSound("burstSmall")}var Fi=function(){function t(e){if(Object(f.a)(this,t),Object.assign(this,e),this.starLifeVariation=e.starLifeVariation||.125,this.color=e.color||ei(),this.glitterColor=e.glitterColor||this.color,!this.starCount){var i=e.starDensity||1,a=this.spreadSize/54;this.starCount=Math.max(6,a*a*i)}}return Object(d.a)(t,[{key:"launch",value:function(t,e){var i=this,a=Ee-.45*Ee,n=t*(Oe-120)+60,r=Ee,o=r-(a-e*(a-50)),s=Math.pow(.04*o,.64),h=this.comet=Ai.add(n,r,"string"===typeof this.color&&"random"!==this.color?this.color:Ye.White,Math.PI,s*(this.horsetail?1.2:1),s*(this.horsetail?100:400));h.heavy=!0,h.spinRadius=_.random(.32,.85),h.sparkFreq=32,h.sparkLife=320,h.sparkLifeVariation=3,("willow"===this.glitter||this.fallingLeaves)&&(h.sparkFreq=20,h.sparkSpeed=.5,h.sparkLife=500),this.color===Xe&&(h.sparkColor=Ye.Gold),Math.random()>.4&&!this.horsetail&&(h.secondColor=Xe,h.transitionTime=700*Math.pow(Math.random(),1.5)+500),h.onDeath=function(t){return i.burst(t.x,t.y)},Et.playSound("lift")}},{key:"burst",value:function(e,i){var a,n,r,o,s,h=this,c=this.spreadSize/96,l=.25,u=!1;this.crossette&&(n=function(t){u||(Et.playSound("crackleSmall"),u=!0),function(t){Vi(Math.random()*qe,Be,4,.5,(function(e){Ai.add(t.x,t.y,t.color,e,.6*Math.random()+.75,600)}))}(t)}),this.crackle&&(n=function(t){u||(Et.playSound("crackle"),u=!0),function(t){Vi(0,Be,16,1.8,(function(e){zi.add(t.x,t.y,Ye.Gold,e,2.4*Math.pow(Math.random(),.45),300+200*Math.random())}))}(t)}),this.floral&&(n=Ti),this.fallingLeaves&&(n=Pi),"light"===this.glitter?(r=400,o=.3,s=300,l=2):"medium"===this.glitter?(r=200,o=.44,s=700,l=2):"heavy"===this.glitter?(r=80,o=.8,s=1400,l=2):"thick"===this.glitter?(r=16,o=1.5,s=1400,l=3):"streamer"===this.glitter?(r=32,o=1.05,s=620,l=2):"willow"===this.glitter&&(r=120,o=.34,s=1400,l=3.8),r/=1;var f=function(t,u){var f=h.spreadSize/1800,d=Ai.add(e,i,a||ei(),t,u*c,h.starLife+Math.random()*h.starLife*h.starLifeVariation,h.horsetail?h.comet&&h.comet.speedX:0,h.horsetail?h.comet&&h.comet.speedY:-f);h.secondColor&&(d.transitionTime=h.starLife*(.05*Math.random()+.32),d.secondColor=h.secondColor),h.strobe&&(d.transitionTime=h.starLife*(.08*Math.random()+.46),d.strobe=!0,d.strobeFreq=20*Math.random()+40,h.strobeColor&&(d.secondColor=h.strobeColor)),d.onDeath=n,h.glitter&&(d.sparkFreq=r,d.sparkSpeed=o,d.sparkLife=s,d.sparkLifeVariation=l,d.sparkColor=h.glitterColor,d.sparkTimer=Math.random()*d.sparkFreq)};if("string"===typeof this.color)if(a="random"===this.color?null:this.color,this.ring){var d=Math.random()*Math.PI,p=.85*Math.pow(Math.random(),2)+.15;Vi(0,Be,this.starCount,0,(function(t){var n=Math.sin(t)*c*p,u=Math.cos(t)*c,f=_.pointDist(0,0,n,u),g=_.pointAngle(0,0,n,u)+d,v=Ai.add(e,i,a,g,f,h.starLife+Math.random()*h.starLife*h.starLifeVariation);h.glitter&&(v.sparkFreq=r,v.sparkSpeed=o,v.sparkLife=s,v.sparkLifeVariation=l,v.sparkColor=h.glitterColor,v.sparkTimer=Math.random()*v.sparkFreq)}))}else ji(this.starCount,f);else{if(!Array.isArray(this.color))throw new Error("Invalid shell color. Expected string or array of strings, but got: "+this.color);if(Math.random()<.5){var g=Math.random()*Math.PI,v=g+Math.PI,m=Math.PI;a=this.color[0],ji(this.starCount,f,g,m),a=this.color[1],ji(this.starCount,f,v,m)}else a=this.color[0],ji(this.starCount/2,f),a=this.color[1],ji(this.starCount/2,f)}this.pistil&&new t({spreadSize:.5*this.spreadSize,starLife:.6*this.starLife,starLifeVariation:this.starLifeVariation,starDensity:1.4,color:this.pistilColor,glitter:"light",glitterColor:this.pistilColor===Ye.Gold?Ye.Gold:Ye.White}).burst(e,i);this.streamers&&new t({spreadSize:.9*this.spreadSize,starLife:.8*this.starLife,starLifeVariation:this.starLifeVariation,starCount:Math.floor(Math.max(6,this.spreadSize/45)),color:Ye.White,glitter:"streamer"}).burst(e,i);if(Ri.add(e,i,this.spreadSize/4),this.comet){var y=.3*(1-Math.min(2,Je()-this.shellSize)/2)+.7;Et.playSound("burst",y)}}}]),t}(),Ri={active:[],_pool:[],_new:function(){return{}},add:function(t,e,i){var a=this._pool.pop()||this._new();return a.x=t,a.y=e,a.radius=i,this.active.push(a),a},returnInstance:function(t){this._pool.push(t)}};function Wi(){var t={};return Qe.forEach((function(e){t[e]=[]})),t}var Ai={drawWidth:3,airDrag:.98,airDragHeavy:.992,active:Wi(),_pool:[],_new:function(){return{}},add:function(t,e,i,a,n,r,o,s){var h=this._pool.pop()||this._new();return h.visible=!0,h.heavy=!1,h.x=t,h.y=e,h.prevX=t,h.prevY=e,h.color=i,h.speedX=Math.sin(a)*n+(o||0),h.speedY=Math.cos(a)*n+(s||0),h.life=r,h.fullLife=r,h.spinAngle=Math.random()*Be,h.spinSpeed=.8,h.spinRadius=0,h.sparkFreq=0,h.sparkSpeed=1,h.sparkTimer=0,h.sparkColor=i,h.sparkLife=750,h.sparkLifeVariation=.25,h.strobe=!1,this.active[i].push(h),h},returnInstance:function(t){t.onDeath&&t.onDeath(t),t.onDeath=null,t.secondColor=null,t.transitionTime=0,t.colorChanged=!1,this._pool.push(t)}},zi={drawWidth:0,airDrag:.9,active:Wi(),_pool:[],_new:function(){return{}},add:function(t,e,i,a,n,r){var o=this._pool.pop()||this._new();return o.x=t,o.y=e,o.prevX=t,o.prevY=e,o.color=i,o.speedX=Math.sin(a)*n,o.speedY=Math.cos(a)*n,o.life=r,this.active[i].push(o),o},returnInstance:function(t){this._pool.push(t)}},Ni=function(){function t(e,i){Object(f.a)(this,t);this.id="547846ad",this.effect=e,this.fireworks=Object.keys(ui),this.postInit(),di()}return Object(d.a)(t,[{key:"postInit",value:function(){var t=this.effect,e=t.width,i=t.height,a=t.ctx;Oe=e,Ee=i,this.context={dpr:window.devicePixelRatio||1,width:e,height:i,mainCtx:a,trailsCtx:a};var n=this.getConfigValue("shellType",1)||0;Ge.state.config.shell=this.fireworks[n],Ge.state.config.hideControls=!0,Ge.state.config.size=this.getConfigValue("shellSize",3),this.lag=this.getConfigValue("lag",5),Ne=this.getConfigValue("speed",.2),this.timeStep=1,this.context.shellType=ui[this.fireworks[n]]}},{key:"getDescriptor",value:function(){return{name:"Sparkling",id:"547846ad",config:{lag:10,speed:.2,shellSize:3,shellType:0},fireworks:this.fireworks}}},{key:"draw",value:function(){this.timeStep=(this.timeStep+1)%900,Ei(this.context,this.timeStep,this.lag)}},{key:"getConfigName",value:function(t){return this.effect.getConfigName(this.id,t)}},{key:"getConfigValue",value:function(t){return this.effect.getConfigValue(this.id,t)}},{key:"changeConfig",value:function(t,e){return this.effect.changeConfig(this.getConfigName(t),e)}},{key:"option",value:function(){var t=this,e=this.effect;return[e.renderSelectOption(this.getConfigName("shellType"),"Shell Type",fi,this.getConfigValue("shellType")||0),e.renderSliderOption({name:this.getConfigName("shellSize"),title:"Shell Size",minLabel:"small",maxLabel:"large",min:1,max:10,step:1,defaultValue:3}),e.renderSliderOption({name:this.getConfigName("lag"),title:"View Distance",minLabel:"far",maxLabel:"near",min:1,max:20,step:1,defaultValue:10}),e.renderSliderOption({name:this.getConfigName("speed"),title:"Speed",minLabel:"slow",maxLabel:"fast",min:.1,max:1,step:.1,defaultValue:.2}),n.a.createElement(It.a,{type:"primary",onClick:function(e){t.changeConfig("lag",10),t.changeConfig("speed",.2),t.changeConfig("shellSize",3),t.changeConfig("shellType",0)}},"Restore Default")]}},{key:"configChanged",value:function(){this.postInit()}}]),t}(),Yi=function(){function t(e){Object(f.a)(this,t),this.store=e,this.event=this.event.bind(this),this.done=!1,this.selectedFireworkIndexes=[];var i=this.getConfig({});void 0===i.fireworkIndex&&(i.fireworkIndex=0),void 0===i.backgroundImageIndex&&(i.backgroundImageIndex=2),void 0===i.backgroundEffectNames&&(i.backgroundEffectNames=[]),this.fileList=[],this.presets=[]}return Object(d.a)(t,[{key:"getName",value:function(){return"Firework"}},{key:"init",value:function(t,e,i,a){if(this.width=~~e,this.height=~~i,(this.canvas!==t||a)&&(!function(t,e,i){var a=t.getContext("2d"),n=U(a);t.width=e*n,t.height=i*n,t.style.width=e+"px",t.style.height=i+"px",a.setTransform(n,0,0,n,0,0)}(t,e,i),this.canvas=t,this.ctx=t.getContext("2d"),this.dpr=U(this.ctx),this.center&&!a||(this.center={x:e/2,y:i/2}),this.ctx.font="15px Consolas",this.ctx.fillStyle="rgba(0, 255, 0, 0.7)"),!this.background||a){var n=this.getConfig();this.backgroundImageData=void 0,this.background=new St(this,{imageIndex:n.backgroundImageIndex,effectNames:n.backgroundEffectNames})}this.fireworks?a&&this.postInit():(this.fireworks=[new Ni(this,{preset:1}),new Dt(this),new Ie(this),new Bt(this),new $t(this),new Ut(this),new xe(this),new Ce(this),new De(this),new je(this),new Tt(this),new Re(this,{preset:1}),new Re(this,{preset:3}),new Re(this,{preset:5})],this.postInit())}},{key:"postInit",value:function(){this.fireworks.forEach((function(t){t.postInit&&t.postInit()})),this.generatePresets(),this.tick=Date.now()}},{key:"generatePresets",value:function(){var t=this.fireworks,e=t.length;this.presets=[];for(var i=0;i<t.length;i++)this.presets.push([_.randomInt(0,e)]);if(e>2)for(var a=0;a<2;a++)this.presets.push([_.randomInt(0,e),_.randomInt(0,e)])}},{key:"clearInvisibleArea",value:function(t){var e=this.background.getInvisibleArea();if(e){var i=e.left,a=e.top,n=e.width,r=e.height;t.globalCompositeOperation="lighter",t.fillStyle="rgba(255, 255, 255, 0.15)",t.fillRect(i,a,n,r)}}},{key:"draw",value:function(){var t=this,e=this.ctx,i=this.fireworks,a=this.presets;if(e){var n=Date.now()-this.tick;this.background.draw();var r=this.getConfig();if(0===r.fireworkIndex){this.currentFirework=void 0;var o=~~(n/15100);if(n<15100*o+100)return;a[o%a.length].forEach((function(e){var a=i[e];a.draw(),t.clearInvisibleArea(a.effect.ctx)}))}else{var s=i[(r.fireworkIndex-1)%i.length];this.currentFirework=s,s&&(s.draw(),this.clearInvisibleArea(s.effect.ctx))}}}},{key:"getCurrentFirework",value:function(){return this.currentFirework}},{key:"getConfigName",value:function(t,e){return"".concat(t,"#").concat(e)}},{key:"getConfigValue",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this.getConfig()[this.getConfigName(t,e)]||i}},{key:"event",value:function(t,e){var i=this.getCurrentFirework();if(i&&i.event)i.event.call(i,t,e);else switch(t){case"event@mouse-moved":case"event@mouse-clicked":this.center=e}}},{key:"renderFireworkTypeOption",value:function(){var t=this;if(!this.fireworks)return"";var e=this.getConfig(),i=this.fireworks.map((function(t){return t.getDescriptor().name}));return i.unshift("Random"),n.a.createElement("div",{key:"firework#fireworkIndex",className:"underline",style:{padding:"8px 0"}},n.a.createElement("span",null,"Firework Type"),n.a.createElement(z.a,{ref:function(e){return t.selectElement=e},style:{minWidth:"150px",margin:"0 0 0 8px"},defaultValue:e.fireworkIndex,placeholder:"Select a firework type",onChange:function(e){return t.changeConfig("fireworkIndex",e)}},i.map((function(t,e){return n.a.createElement(z.a.Option,{key:"firework#".concat(e),value:e},"".concat(t))}))))}},{key:"renderBackgroundImageOption",value:function(){var t=this,e=this.getConfig().backgroundImageIndex,i=xt().backgroundImages,a={onRemove:function(e){var i=t.fileList.indexOf(e),a=t.fileList.slice();a.splice(i,1),t.fileList=a},beforeUpload:function(e){[].concat(Object(A.a)(t.fileList),[e]).forEach((function(t){return Mt(t)})),t.fileList=[];var i=xt().backgroundImages.length-1;return t.changeConfig("backgroundImageIndex",i),!1},fileList:this.fileList};return n.a.createElement("div",{key:"firework#imgIndex",style:{padding:"8px 0"}},n.a.createElement("span",null,"Background Image"),n.a.createElement(z.a,{style:{minWidth:"150px",padding:"0 0 0 8px",margin:"16px 0"},defaultValue:e,placeholder:"Select a background image",onChange:function(e){t.changeConfig("backgroundImageIndex",e)}},i.map((function(t,e){return n.a.createElement(z.a.Option,{key:"img#".concat(e),value:e},"".concat(t.name))}))),n.a.createElement(N.a.Dragger,a,n.a.createElement("p",{className:"ant-upload-drag-icon"},n.a.createElement(B.a,null)),n.a.createElement("p",{className:"ant-upload-text"},"Click or drag image file(s) to this area to add background image(s)")))}},{key:"renderBackgroundEffectOption",value:function(){var t=this,e=this.getConfig().backgroundEffectNames,i=xt().backgroundEffects;return n.a.createElement("div",{key:"firework#effectIndex",style:{padding:"8px 0"}},n.a.createElement("span",null,"Background Effect"),i.map((function(i,a){return n.a.createElement("div",null,n.a.createElement(Y.a,{style:{margin:"4px 0"},checked:e.includes(i.name),onChange:function(){var a=e;if(a.includes(i.name)){var n=a.findIndex((function(t){return t===i.name}));a.splice(n,1)}else a.push(i.name);t.changeConfig("backgroundEffectNames",a)}},i.name))})))}},{key:"getPercentValue",value:function(t){var e=t.minLabel,i=t.maxLabel,a=t.min,n=t.max,r=t.value;return r===a?e||a:r===n?i||n:"".concat(O((r-a)/(n-a)*100|0),"%")}},{key:"renderSliderOption",value:function(t){var e=this,i=t.name,a=t.title,r=t.minLabel,o=t.maxLabel,s=t.min,h=t.max,c=t.step,l=t.defaultValue,u=this.getConfig()[i]||l;return n.a.createElement("div",{key:"".concat(i),style:{margin:"8px 0"}},n.a.createElement("span",null,"".concat(a,": ").concat(this.getPercentValue({minLabel:r,maxLabel:o,min:s,max:h,value:u}))),n.a.createElement("div",{style:{display:"flex",width:"100%"}},r&&n.a.createElement("span",{style:{margin:"0 12px 0 0",fontWeight:"500"}},r),n.a.createElement(X.a,{style:{flex:"auto"},min:s,max:h,step:c,value:u,tipFormatter:function(t){return e.getPercentValue({minLabel:r,maxLabel:o,min:s,max:h,value:t})},onChange:function(t){return e.changeConfig(i,t)}}),o&&n.a.createElement("span",{style:{margin:"0 0 0 12px",fontWeight:"500"}},o)))}},{key:"renderSelectOption",value:function(t,e,i,a){var r=this,o=this.getConfig()[t]||a;return n.a.createElement("div",{key:"".concat(t),style:{margin:"8px 0"}},n.a.createElement("span",null,"".concat(e," ")),n.a.createElement(z.a,{style:{minWidth:"150px",padding:"0 0 0 8px"},value:o,onChange:function(e){return r.changeConfig(t,e)}},i.map((function(t,e){return n.a.createElement(z.a.Option,{key:"option#".concat(e),value:e},"".concat(t))}))))}},{key:"getConfig",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.options||(this.store.options=t),this.store.options}},{key:"changeConfig",value:function(t,e){var i=this.getConfig();if(i[t]=e,"backgroundImageIndex"===t)this.background=new St(this,{imageIndex:e,effectNames:i.backgroundEffectNames});else if("backgroundEffectNames"===t)this.background=new St(this,{imageIndex:i.backkgroundImageIndex,effectNames:e});else if("fireworkIndex"===t){var a=this.fireworks;this.currentFirework=a[(e-1)%a.length]}u("event@effect-config-changed",{name:t,value:e})}},{key:"option",value:function(){var t=[{name:"Image",options:[this.renderBackgroundImageOption()]}];q.isMobileOnly||t.push({name:"Effect",options:[this.renderBackgroundEffectOption()]});var e=[this.renderFireworkTypeOption()],i=this.getCurrentFirework();if(null===i||void 0===i?void 0:i.option){var a=i.option();a.length&&e.push(n.a.createElement("div",{style:{padding:"8px",background:"#efefef"}},a))}return t.push({name:"Firework",options:e}),t}}]),t}(),Xi=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,[{key:"fileExtension",value:function(){return".webm"}},{key:"start",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=["video/webm;codecs=vp8","video/webm","video/webm,codecs=vp9","video/vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mpeg"];for(var n in a)if(MediaRecorder.isTypeSupported(a[n])){this.supportedType=a[n];break}if(this.supportedType){var r=t.captureStream();if(r){this.recordedChunks=[];try{this.mediaRecorder=new MediaRecorder(r,{mimeType:this.supportedType,videoBitsPerSecond:i.videoBitsPerSecond||25e5})}catch(o){return alert("MediaRecorder is not supported by this browser."),void console.error("Exception while creating MediaRecorder:",o)}console.log("Created MediaRecorder"),this.mediaRecorder.ondataavailable=function(t){t.data&&t.data.size&&e.recordedChunks.push(t.data),"recording"===e.mediaRecorder.state&&e.mediaRecorder.stop()},this.mediaRecorder.start(),console.log("MediaRecorder started")}}else console.log("No supported type found for MediaRecorder")}},{key:"frame",value:function(t){}},{key:"stop",value:function(){var t=this;return new Promise((function(e,i){t.mediaRecorder.stop(),t.mediaRecorder.onstop=function(i){var a=new Blob(t.recordedChunks,{type:t.supportedType}),n=URL.createObjectURL(a);e(n)}}))}}]),t}(),Bi=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,[{key:"fileExtension",value:function(){return".gif"}},{key:"start",value:function(t){this.gif=new window.GIF({workers:2,quality:10})}},{key:"frame",value:function(t){this.gif.addFrame(t,{copy:!0,delay:50})}},{key:"stop",value:function(){var t=this;return new Promise((function(e,i){t.gif.on("finished",(function(t){var i=URL.createObjectURL(t);e(i)})),t.gif.render()}))}}]),t}(),qi=function(t){Object(g.a)(a,t);var e=Object(v.a)(a);function a(t){var i;return Object(f.a)(this,a),(i=e.call(this,t)).effects=[],window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}},window.cancelAnimFrame=function(t){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){window.clearTimeout(t)}},i.state={sound:!1,capturer:void 0,captureTime:0},i.fps=-1,i.fpsCounter=0,i.prevMs=0,i.initEffect=i.initEffect.bind(Object(p.a)(i)),i.drawEffect=i.drawEffect.bind(Object(p.a)(i)),i.onChangeEffectOption=i.onChangeEffectOption.bind(Object(p.a)(i)),i.onToggleOptionBar=i.onToggleOptionBar.bind(Object(p.a)(i)),i.onToggleSound=i.onToggleSound.bind(Object(p.a)(i)),i.onEvent=i.onEvent.bind(Object(p.a)(i)),i.onResize=i.onResize.bind(Object(p.a)(i)),i.onRun=i.onRun.bind(Object(p.a)(i)),i.onStop=i.onStop.bind(Object(p.a)(i)),R(),i.effects.push(new Yi(W)),i}return Object(d.a)(a,[{key:"componentDidMount",value:function(t){var e=this;(function(){return P.apply(this,arguments)})().then((function(){e.onRun()})),c("effects",this.onEvent),window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.onStop(),F(),l("effects",this.onEvent)}},{key:"onResize",value:function(){this.initEffect(!0),this.forceUpdate()}},{key:"onEvent",value:function(t,e){switch(console.log("effects: ".concat(t)),t){case"event@mouse-down":case"event@mouse-clicked":case"event@mouse-moved":case"event@mouse-up":if(this.canvas){var i=this.getEffect();i&&i.event(t,{x:e.x-this.canvas.offsetLeft,y:e.y-this.canvas.offsetTop})}break;case"event@effect-config-changed":this.onChangeEffectOption();break;case"event@refresh":this.forceUpdate()}}},{key:"onRun",value:function(){this.raf&&cancelAnimationFrame(this.raf),this.running=!0,this.raf=requestAnimationFrame(this.drawEffect)}},{key:"onStop",value:function(){this.running=!1,this.raf&&cancelAnimationFrame(this.raf),this.raf=void 0}},{key:"onChangeEffectOption",value:function(){this.initEffect(!0),F(),this.forceUpdate()}},{key:"onToggleOptionBar",value:function(t){if(W.optionOpended=!W.optionOpended,W.optionOpended);else{var e=this.getEffect();e&&e.configChanged&&e.configChanged()}this.forceUpdate()}},{key:"onToggleSound",value:function(){this.state.sound?(this.setState({sound:!1}),Et.pauseAll()):(this.setState({sound:!0}),Et.resumeAll())}},{key:"onCapture",value:function(t){this.setState({capturer:t,captureTime:Date.now()}),t.start(this.canvas)}},{key:"getEffect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.effects[t%this.effects.length]}},{key:"initEffect",value:function(t){var e=this.canvas,i=this.container;if(e&&i){this.canvas=e;var a=this.getEffect();a&&a.init(e,i.width||i.clientWidth,i.height||i.clientHeight,t)}}},{key:"findFps",value:function(){var t=Date.now(),e=t-this.prevMs;this.fps=Math.round(1e3*this.fpsCounter/e*10)/10,this.prevMs=t,this.fpsCounter=0}},{key:"drawStats",value:function(t){var e=t.getContext("2d");e.textBaseline="top",e.font="normal 200 10px arial",e.fillStyle="white",this.state.capturer?e.fillText(function(t){var e=t/1e3|0,i=e%60,a=e/3600|0,n=(e-3600*a)/60|0;return a?"".concat(O(a),":").concat(O(n),":").concat(O(i),".").concat(E(t%1e3)):"".concat(O(n),":").concat(O(i),".").concat(E(t%1e3))}(Date.now()-this.state.captureTime),10,10):(this.fpsCounter++,this.fps>0&&e.fillText("fps: ".concat(~~this.fps),10,10),this.findFps())}},{key:"drawEffect",value:function(){if(this.canvas){if(this.running){var t=this.getEffect();t&&t.draw();var e=this.state.capturer;e&&e.frame(this.canvas),this.drawStats(this.canvas)}requestAnimationFrame(this.drawEffect)}}},{key:"renderOptions",value:function(){var t,e=null===(t=this.getEffect())||void 0===t?void 0:t.option();return n.a.createElement(m.a,{defaultActiveKey:"option#1"},e.map((function(t,e){return n.a.createElement(m.a.TabPane,{tab:t.name,key:"option#".concat(e+1)},t.options)})))}},{key:"renderEffect",value:function(){var t=this;return n.a.createElement("canvas",{ref:function(e){e&&(t.canvas=e,t.initEffect(!1))},style:{width:"100vw",height:"100vh",background:"black"},onMouseDown:function(e){return t.onEvent("event@mouse-down",{x:e.clientX,y:e.clientY})},onMouseMove:function(e){return t.onEvent("event@mouse-moved",{x:e.clientX,y:e.clientY})},onMouseUp:function(e){return t.onEvent("event@mouse-up",{x:e.clientX,y:e.clientY})},onClick:function(e){return t.onEvent("event@mouse-clicked",{x:e.clientX,y:e.clientY})},onTouchStart:function(e){return t.onEvent("event@mouse-down",{x:e.clientX,y:e.clientY})},onTouchMove:function(e){return t.onEvent("event@mouse-moved",{x:e.clientX,y:e.clientY})},onMouseEnd:function(e){return t.onEvent("event@mouse-up",{x:e.clientX,y:e.clientY})}})}},{key:"getActionMenu",value:function(){var t=this;return n.a.createElement(y.a,null,n.a.createElement(y.a.Item,{key:"gif",onClick:function(){return t.onCapture(new Bi(t.canvas))}},"gif"),n.a.createElement(y.a.Item,{key:"webm",onClick:function(){return t.onCapture(new Xi(t.canvas))}},"webm"))}},{key:"renderActions",value:function(){var t,e=this,a=W.optionOpended,r=this.state.capturer;return r?n.a.createElement("div",{className:"app-setting"},n.a.createElement("span",{onClick:function(){e.setState({capturer:void 0}),r.stop().then((function(t){i(298).saveAs(t,"fireworks".concat(r.fileExtension()))}))}},n.a.createElement(b.a,{spin:!0,style:{color:"red"}}))):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"app-setting"},n.a.createElement("span",{style:{margin:"0 24px 0 0"},onClick:function(){return e.onToggleSound()}},this.state.sound?n.a.createElement(x.a,{style:{color:"red"}}):n.a.createElement(M.a,null)),n.a.createElement(k.a,{overlay:this.getActionMenu(),placement:"bottomCenter",trigger:["click"]},n.a.createElement(C.a,null)),n.a.createElement("span",{style:{margin:"0 0 0 24px"},onClick:function(){return e.onToggleOptionBar()}},n.a.createElement(S.a,null))),n.a.createElement(w.a,{title:"",placement:"right",closable:!0,width:Math.min(400,(null===(t=this.container)||void 0===t?void 0:t.width)||400),onClose:function(){return e.onToggleOptionBar()},visible:a},this.renderOptions()))}},{key:"render",value:function(){var t=this;return n.a.createElement(I.FileDrop,{style:{width:"100vw",height:"100vh"},onFrameDragEnter:function(t){},onFrameDragLeave:function(t){},onFrameDrop:function(t){},onDragOver:function(t){},onDragLeave:function(t){},onDrop:function(t,e){for(var i=0;i<t.length;i++)Mt(t[i])}},n.a.createElement("div",{ref:function(e){e&&(t.container=e,t.initEffect(!0))},style:{width:"100vw",height:"100vh"}},this.renderEffect(),this.renderActions()))}}]),a}(n.a.Component),Gi=function(t){Object(g.a)(i,t);var e=Object(v.a)(i);function i(t){var a;return Object(f.a)(this,i),(a=e.call(this,t)).onEvent=a.onEvent.bind(Object(p.a)(a)),a}return Object(d.a)(i,[{key:"componentDidMount",value:function(t){this.restoreState(),c("home",this.onEvent)}},{key:"componentWillUnmount",value:function(){this.saveState(),l("home",this.onEvent)}},{key:"saveState",value:function(){}},{key:"restoreState",value:function(){}},{key:"onEvent",value:function(t,e){}},{key:"render",value:function(){return n.a.createElement("div",{className:"app-container"},n.a.createElement(a.Suspense,{fallback:n.a.createElement("div",{style:{margin:"16px"}},"Loading...")},n.a.createElement(qi,null)))}}]),i}(n.a.Component);window.onpopstate=function(t){u("event@popstate",t.state)};var _i=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},n.a.createElement(Gi,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(_i,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},98:function(t,e,i){}},[[173,1,2]]]);
//# sourceMappingURL=main.e507a0dc.chunk.js.map